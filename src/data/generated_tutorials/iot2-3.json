{
  "title": "3",
  "slug": "iot2-3",
  "description": "Module from iot2.pdf: 3",
  "tags": [
    "iot2",
    "Elite"
  ],
  "content": "# 3\n\nDesign Principles for \n\nWeb Connectivity \n\nLearning Objectives \n\nLO 3.1 Extend the understanding of web communication protocols used by connected IoT/ M2M devices LO 3.2 Illustrate the usage of messaging protocols between connected devices and the web LO 3.3 Outline the usages of communication gateway protocols, such as SOAP, REST, RESTful HTTP and WebSocket by connected devices and the web \n\nRecall from Previous Chapters \n\nSection 1.1 described the suggested conceptual frameworks, reference models and architectures. Equation 1.1 of Adrian McEwen and Hakim Cassimally conceptualises the IoT framework and is given as \u201cPhysical Object + Controller, Sensor and Actuators + Internet = Internet of Things\u201d. Equation 1.2 conceptualises the Oracle IoT architecture and is given as \u201cGather + Enrich + Stream + Manage + Acquire + Organise and Analyse = Internet of Things with connectivity to data centre, enterprise or cloud server.\u201d Equation 1.1 tells that the Internet is an important element for IoT/M2M. Equation 2.2 tells that streaming of data is a must-required element. The Internet connects to the web. Streaming of data is to or from the web. IoT/M2M physical objects/devices therefore need web connectivity. \n\nSection 2.1 described the network layer as one of the six layers in the IoT reference model. The ITU-T reference model has one layer for network capabilities. ETSI suggested one of the two domains in high-level architecture as a network domain. The domain includes CoRE and access \n\nDesign Principles for Web Connectivity 75 \n\n3.1 INTRODUCTION \n\nAn IoT/M2M device network gateway needs connectivity to web servers. A communication gateway enables web connectivity, while IoT/M2M specific protocols and methods enable web connectivity for a connected devices network.  A server enables IoT device data accumulation (storage). Application (reporting, analysis and control), collaboration, service and processes (involving peoples and business processes) use this data. \n\nFollowing are some key terms, which need to be understood for learning web connectivity and communication between the connected devices network and the web for IoT: \n\nApplication or App refers to a software for applications such as creating and sending an SMS, measuring and sending the measured data, receiving a message from a specific sender etc. \n\nApplication Programming Interface (API) refers to a software component, which receives messages from one end; for example, from an application or client or input. An API may consist of GUIs (button, check box, text box, dialog box). An API may get input to or from a server or a user. It then initiates actions and may send the messages, for example, to application software,  server or a client at the other end etc. \n\nFor example, consider an API for a parcel tracking application. The API displays the fields for the user inputs required for tracking, accepts the user inputs, displays a \u2018wait message\u2019 to the user and sends the input parameters to an application at a server. The application in turn displays the response from the application or server. \n\nAn API also refers to software components, which enable easier development of an application. An API defines the functionalities for a programmer, which puts the building blocks together to develop an application. A building block consists of the operations, inputs, outputs and underlying types. \n\nWeb service refers to a servicing software which uses web protocols, web objects or WebSockets; for example, weather reports service, traffic density reports, streetlights monitoring and controlling service. \n\nObject refers to a collection of resources; for example, collection of data and methods (or functions or procedures) to operate on that data. Take for instance, Time_Date object with second, minutes, hour, day, month and year fields and update methods. An object instance can be just one or more than one for an object. An example of an object instance is birth_date. Multiple object instances, abc_birth_date, pqr_birth_date, xyz_birth_date and many instances can be created from birth_date object  in JavaScript. An example of object instance is weather report object for reporting the rains. \n\nnetworks, management and service capabilities. Gateway connects to the network using which data streams to or from the web. An IoT/M2M gateway needs connectivity to the web that uses the Internet. \n\n76 Internet of Things: Architecture and Design Principles \n\nObject model is defined as the usage of objects for values, messages, data or resource transfer, and creation of one or more object-instances. Class:  Java uses concept of class, which creates one or more object instances. \n\nCommunication gateway is one that functions as communication protocol translator (convertor) for provisioning communication capabilities. For example, the gateway for communication between ZigBee and IP networks. \n\nClient refers to a software object which makes request (or an API associated with it makes request) for data, messages, resources or objects. A client can have one or more object instances. A client may also have an API or many APIs for enabling the communication to the server. A client can be at a device or application on a network or Internet connected web, enterprise server or cloud. \n\nServer is defined as a software which sends a response on a request. The server also sends messages, alerts or notifications. The server  has access to resources, databases and objects. A server can be on a device or can be on a separate computer system, not necessarily on Internet connected web. \n\nWeb object is the one that retrieves a resource from the web object at other end using a web protocol. \n\nBroker denotes an object, which arranges the communication between two ends; for example, between the message publisher and subscriber or for example taking the request from a source and sending the response received back for that source after arranging the response from another object, such as a server. \n\nProxy refers to an application which receives a response from the server for usage of a client or application and which also receives requests from the client for the responses retrieved or saved at proxy. \n\nCommunication protocol defines the rules and conventions for communication between networked devices and between systems. The protocol includes mechanisms for devices or systems to identify and make connections with each other. The protocol also includes formatting rules that specify how data is packaged into sent and received messages,1 and header, its field and their meanings. \n\nWeb protocol is a protocol that defines the rules and conventions for communication between the web server and web clients. It is a protocol for web connectivity of web objects, clients, servers and intermediate servers or firewalls. It includes mechanisms for a web object to identify and make connections with other objects. The protocol also includes web object formatting rules that specify how that object packs into it the sent and received messages. \n\nFirewall is one that protects the server from unauthentic resources. \n\nA header consists of a set of words. The words contain the information and parameters about the processing at a communicating layer. The words are placed over a data stack \n\n1 http://compnetworking.about.com/ \n\nDesign Principles for Web Connectivity 77 \n\nreceived from a previous layer and create a new data stack for transmission to next lower layer. Header words are placed at the sending layer lower in the hierarchy during transmission and removed at the receiving layer higher in hierarchy after using the information contained in the header. \n\nA state refers to an aspect related to someone or something, or a form at a particular time (Collins English Language Dictionary). State, in reference to data interchange between web objects, refers to an aspect related to data or resource or object received at a particular instance at the server or client end. \n\nResource denotes something that can be read (used), written (created or changed) or executed (processed). A path specification is also a resource. The resource is atomic (not- further divisible) information, which is usable during computations. A resource may have multiple instances or just a single instance. Single instance example is a contact list. Examples of multiple instances of a contact are name, surname, city, address and email ID. \n\nEach resource instance has a resource ID. A resource is accessible using a resource identifier. A resource identifier can be a path specification, such as a Universal Resource Locator (URL) or Universal Resource Identifier (URI). \n\nA resource may have resource registry, which means it is usable after a resource instance is registered at the registry, and unusable when not-registered or when de-registered. \n\nA resource can be updated. A resource can be used when an application uses resource discovery. \n\nA resource may have a resource repository. Repository refers to subfolder, folder or directory, which contains the resources and their instances. A resource can have a resource directory, which directs to resource repository. \n\nResource structure or resource directory refers to a structure or collection of resources, applications, containers and groups, which may each have an attribute, access right, subscription and discovery. \n\nPath denotes a navigation path between two ends when accessing a resource. Path specification can be of URI or URL type. The structure of URI is hierarchical. Entity after the sign \u2018/\u2019 is a child of the parent before the sign \u2018/\u2019. \n\nUniversal Resource Identifier is generally used for saved resources, such as contacts or address book. Example of a URI is /Contacts/First_Character_R/ for a set of resource directory contacts having resource repository First_Character_R for contacts with first character R and resources giving information about a contact. Another example is URI sensorNetwork_J/sensorID_N/temperature for a temperature value. The value is at a resource directory sensorNetwork_J for a sensor network, which stores sensor data for a sensor of id sensorID_N. \n\nUniversal Resource Locator is generally used for retrieving a resource(s) by a client. The saved resources may be at a document or at a remote server accessed using Internet protocols. An example of a URL is http://www.mhhe.com/ for a set of resource directories, resource repositories and resources on the McGraw Hill Higher Education server. \n\n78 Internet of Things: Architecture and Design Principles \n\nDatagram refers to a limited size data (216 byte). It is used for stateless connectionless transfer from a web object. Stateless means each single datagram transfer is independent of previous data interchanges and connectionless means there is no need of pre-establishing the connection for resource exchanges between the web objects and no connection closing after finishing the resource exchanges. \n\nRepresentational State Transfer (REST) is a software architecture referring to ways of defining the identifiers for the resources, methods, access methods and data transfer during interactions. REST is a software architecture which also specifies the practices, constraints, characteristics and guidelines for creating scalable web services. Scalable means can be used as per the size. The architecture is used during the design of web software components, clients and web APIs . \n\nREST also refers to usage of defined resource types when transferring the objects between two ends\u2014URIs or URLs for representations of the resources. REST also refers to the usage of use verbs (commands), POST, GET, PUT and DELETE (Section 3.4.4) and files of MIME types. \n\nMultipurpose Internet Mail Extensions or MIME refers to the type of files that are widely used on the Internet by web objects, applications and services. \n\nRESTful refers to one which follows REST constraints and characteristics. \n\nUser Datagram Protocol (UDP) is a protocol at the transport layer for the web using Internet and Constrained RESTful Environment (CoRE). UDP specifies the way of enveloping the datagram by header words, which just specifies the ports and addresses of two ends between which the datagram transfers. UDP is described in detail in Chapter 4, Section 4.3.3. \n\nHypertext means text embedded with hyperlinks. HyperText Transfer Protocol (HTTP) means an application layer protocol for use of hypertext as app data transfer protocol. Clients and servers use the URLs http://\u2026 . \n\nHyperlink refers to a specification of the URL for a resource path, so that a link can be established between two objects. For example, hyperlink URL specifications for the author\u2019s earlier book\u2019s supplementary web-resources at McGraw-Hill Higher Education server are http://www.mhhe.com/kamal/emb3. Retrieval of a resource at a web object by the other object uses the click at a link shown on a displayed text on browser. \n\nHyperText Markup Language (HTML) is a language for creating a hypertext which refers to text that embeds text, images, audio and video, image frames, forms, lists, tables, navigation links (reference to resources), APIs, Java Script and other codes for dynamic actions. \n\nExtensible Markup Language (XML) is a language, which enables creation, sending and receiving documents, messages, commands, query responses, queries, and creation of forms. The form data, response or message uses a new tag (not defined earlier in HTML) with new data type definitions than the ones at HTML. HTML5 is the latest version of HTML which includes features of XML and many new features as well. A form, for \n\n\n![Image](/src/assets/generated_images/iot2_p105_i0.png)\n\nDesign Principles for Web Connectivity 79 \n\nexample, has a number of fields such as, Name, Phone, Address, e-Mail ID. Form data means filled contents in the fields of a form. For example, one creates a new tag, \u2018name\u2019, and use in the XML line as follows: <name>Raj Kamal </name>, then name field of form has data \u2018Raj Kamal\u2019. Sign \u2018/\u2019is for ending. \n\nBrowser is a client software which displays hypertext that enables navigation to the hypertext links shown on the user screen, and which displays GUIs of the apps, display form, display server responses, and so on. \n\nA WebSocket denotes an API for bidirectional communication that has much less header size than HTTP communication and lower latency compared to HTTP approach of unidirectional communication at an instant  (Section 3.4.5). \n\nFramework refers to provisions for a number of software libraries, and a number of APIs including those that can be selectively changed by user codes in applications. An example of a framework is .NET framework. Advantages of frameworks are: easier to work with a set of discrete objects, software components, protocols, complex and different technologies; binds these together into something highly useful; forces the programmers to implement code in a way that promotes consistent coding, thus with fewer bugs, and provisioning more flexibility in the  applications; and easy in testing and debugging of the code. \n\nThe following sections describe the design principles for web connectivity of connected devices. Later in the chapters how connected devices use the CoAP, LWM2M, XML, message queues, MQTT, XMPP, SOAP, RESTful HTTP, WebSockets and other protocols for the web connectivity to services, applications and processes has been discussed. \n\n3.2  WEB COMMUNICATION PROTOCOLS \n\nFOR CONNECTED DEVICES \n\nData of connected devices routes over the web in two types of communication environments. The environments are: \n\n\u25cfConstrained RESTful Environment (CoRE): IoT devices or M2M devices communicate between themselves in a Local Area Network. A device typically sends or receives 10s of bytes. The data gathered after enriching and consolidating from a number of devices consists of 100s of bytes. A gateway in the communication framework enables the data of networked devices that communicate over the Internet using the REST software architecture. \n\n\u274dDevices have the constraint in the sense that their data is limited in size compared \n\nto when data interchange between web clients and web servers takes place using HTTP, Transmission Control Protocol (TCP) and Internet Protocol (IP). \n\n\u274dAnother constraint is data-routing when Routing Over a network of Low power \n\nand (data) Loss (ROLL). ROLL network is a wireless network with low power transceiver. Another constraint is that the devices may sleep most of the time in \n\nExtend the understanding of web communication protocols used by connected IoT/M2M \n\ndevices \n\nLO 3.1 \n\n80 Internet of Things: Architecture and Design Principles \n\nlow power environment and awaken on an event or when required (on client initiative). Devices\u2019 connectivity may also break for long periods, have limited up intervals in loss environment, and have limited data size. \n\n\u25cfUnconstrained Environment: Web applications use HTTP and RESTful HTTP for web client and web server communication. A web object consists of 1000s of bytes. Data routes over IP networks for the Internet. Web applications and services use the IP and TCP protocols for Internet network and transport layers (Section 4.3). Figure 3.1 shows device\u2019s local area network connectivity, web connectivity in constrained and unconstrained RESTful environments and the protocols for communication. \n\n10s of Bytes \n\n10s of Bytes \n\n10s of Bytes \n\n10s of Bytes \n\n10s of Bytes \n\nDevice 1 \n\nDevice 2 \n\n10s of Bytes \n\nApplication Support and Application Layers \n\nTransport \n\nLayer Network \n\nLayer Application \n\nLayer Physical/Data-link \n\nLayer \n\nDevice i \n\nIoT or M2M \n\nArea Local Network and \n\nGateway \n\nCoAP \n\n6LowPAN \n\nLWM2M \n\nZigBee IP \n\nBluetooth Smart IP \n\nZigBee NAN \n\nBluetooth (Low energy), ZigBee Wireless or Wired Technologies \n\n\u2026\u2026\u2026 \n\n\u2026\u2026\u2026 \n\nDevice (i\u20131) \n\nWeb Connectivity \n\ncoap://\u2026\u2026 \n\nWeb Object Web Object Roll \n\nCoAP Client \n\nCoAP Server \n\n100s of Bytes \n\n100s of Bytes \n\nDTLS \n\nDTLS \n\nUDP \n\nUDP \n\nCoAP Server \n\nCoAP Client \n\nHTTP Server \n\nHTTP Client TCP \n\nTLS IP http://\u2026\u2026 \n\nhttp://\u2026\u2026 \n\n[10s and 100s of Bytes Communication Framework Constrained RESTful Environment (CoRE)] \n\n[1000s of Bytes (Un- \n\nconstrained HTTP \n\nEnvironment)] \n\nFigure 3.1  IoT or M2M devices local network connectivity and web connectivity in constrained \n\n(above thick dotted line) and unconstrained RESTful HTTP (below thick dotted line) environments using communication protocols \n\nAssume that a web object refers to a web client or web server. The web object communicates a request of the client or a response of the server. Communication is over the ROLL network or Internet. \n\nFigure 3.1 shows the following: \n\n\u25cfAssume i-devices (1, 2, \u2026 ith) connected devices network, and local network having \n\nWeb objects refer to \n\nclient and server \n\nDesign Principles for Web Connectivity 81 \n\nconnectivity between the devices at physical/data-link and adaptation layer (left-hand side) \n\n\u25cfCommunication between web objects (right-hand side) \n\n\u25cfIETF CoRE specifications, which include CoAP and UDP \n\n\u25cfWeb objects\u2019 protocols for sending a request or response; for example, RESTful CoAP, CoAP client and CoAP server communication over the network and transport layers to other end CoAP client and server. Client/server use the URIs coap://\u2026 in place of http://\u2026 . \n\n\u25cfTransport layer protocols used are Datagram Transport Layer Security (DTLS) and UDP.  Data between web objects route using ROLL network specifications of IETF. \n\n\u25cf100s of bytes communicate between the IoT web objects \n\n\u25cfWeb objects HTTP client and HTTP server communication over the Internet using the IP and client/server use the URLs http://\u2026 . \n\n\u25cf1000s of bytes communicate between HTTP web objects using certain protocols for sending a request or response; for example, RESTful HTTP. IPv6 or IP is the network layer protocol used. The transport layer protocols used are TLS and TCP. IoT device or machine applications need constrained environment protocols such as CoAP and LWM2M. \n\n3.2.1 Constrained Application Protocol \n\nIETF recommends Constrained Application Protocol (CoAP) which is for CoRE using ROLL data network. Features of CoAP are: \n\n\u25cfAn IETF defined application-support layer protocol \n\n\u25cfCoAP web-objects communicate using request/response interaction model. \n\n\u25cfA specialised web-transfer protocol which is used for CoRE using ROLL network. \n\n\u25cfIt uses object-model for the resources and each object can have single or multiple instances. \n\n\u25cfEach resource can have single or multiple instances. \n\n\u25cfAn object or resource use CoAP, DTLS (security binding with PSK, RPK and Certificate) and UDP protocols for sending a request or response. \n\n\u25cfSupports the resource directory and resource-discovery functions \n\n\u25cfThe resource identifiers use the URIs as follow coap://\u2026 . \n\n\u25cfHas small message header, 4 bytes are for ver (version), T (message type) [Types are confirmable, non-confirmable, acknowledgement and reset], TKL (token length), code (request method or response code), message ID 16-bit identifier, token (optional response matching token). Confirmable means server must send an acknowledgement, while non-confirmable means no acknowledgement is required. \n\n\u25cfCoRE communication is asynchronous communication over the ROLL. \n\n\u25cfIntegrates easily with the web using CoAP application cross-protocol proxies. This is facilitated because HTTP and CoAP, both share the REST model. A web client may not even be aware that it just accessed an IoT device sensor resource or sent data to an IoT device actuator resource. \n\n\u25cfUse of REST: The access by a CoAP object or its resource is thus using: \n\n82 Internet of Things: Architecture and Design Principles \n\n\u274dthe URI \n\n\u274da subset of MIME types \n\n\u274da subset of response codes which are used for an HTTP object or resource. Figure 3.2 (a) shows direct and indirect accesses of CoAP client objects to a CoAP server. Figure 3.2 (b) shows a CoAP client access for lookup of object or resource using a resource directory. \n\nIoT Devices \n\nCoAP Client \n\nIoT Area Local Network \n\nObject 1 \n\nObject i \n\n. . . . \n\nCoAP Server \n\nCoAP Server IoT App \n\nCoAP Client \n\n/ms Mirror Server \n\nDirect Access \n\nUpdate \n\nIndirect Access \n\nLookup for object/Resources Access \n\n(a) \n\nCoAP Client \n\n/rd Resources \n\nDirectory \n\nCoAP Client \n\nCoAP Server \n\nIoT App \n\nIoT App \n\nHTTP Server \n\nHTTP Client \n\nIoT App \n\n(b) \n\n(c) \n\nCoAP Client CoAP-HTTP Proxy \n\nHTTP-CoAP Proxy \n\nFigure 3.2  (a) Direct and indirect accesses of CoAP client objects to a CoAP server, (b) CoAP client access \n\nfor lookup of object or resource using a resource directory, and (c) CoAP client and server access using proxies \n\nCoAP Client Web Connectivity \n\nA proxy is an intermediate server, which accepts a request from a client and sends the response to the client using a protocol. It also passes the request to the server and accepts a response from the server using the same or an other protocol. HTTP-CoAP proxy accepts requests from HTTP client using HTTP protocol and sends the request to the server using CoAP protocol. CoAP-HTTP proxy accepts requests from CoAP client using CoAP protocol and sends the request to the server using HTTP protocol. \n\nFigure 3.2 (c) shows CoAP client and server access using proxies. Transport Layer Security (TLS), earlier known as Secure Socket Layer (SSL) is the \n\nDesign Principles for Web Connectivity 83 \n\nprotocol used for securing the TCP-based Internet data interchanges. DTLS is the TLS for datagram. The features of DTLS are: \n\n\u25cfDTLS provisions for three types of security services\u2014integrity, authentication and confidentiality. \n\n\u25cfDTLS protocol derives from TLS protocol and binds UDP for secured datagram transport. \n\n\u25cfDTLS is well suited for securing applications; for example, tunnelling applications (VPN), applications that tend to run out of file descriptors or socket buffers or applications which are delay sensitive (and thus use UDP). \n\n\u25cfA part of DTLS is OpenSSL repository openssl-0.9.8 security based on PSK, RPK and certificate. \n\nSecured Use of a Key for Client Authentication \n\nPSK stands for Pre-Shared Key and is a method of securing using a key to authenticate a client. The key contains up to 133 characters in English. PSK method generates a unique encryption key for each client. A PSK is a symmetric key without forward secrecy (sender key not secret from receiver). Symmetric key means both ends 1 and 2 use the same key, K12 for encryption and decryption. Encryption uses an algorithm. \n\nPrivate key refers to a key agreed for usage of data encryption (ciphering) between a pair of sender and receiver. The key is kept private between the two. Sender and receiver can be objects, applications, web services or processes. \n\nRPK stands for Random Pair-wise Keys, which also stands for Raw Public Key meaning only the private/public key [means end 1 using RPK uses (K1 and Kp) and the other end using RPK uses (K2 and Kp)] are asymmetric. \n\nPublic key refers to a key (for example, a set of 128 or 256 bits), Kp which an intermediate server or trusted entity, such as a bank server (or object) provides to both the sender and receiver. The sender communicates using its key; for example, K1 and the receiver uses its key K2 when it communicates to the server; the server uses Kp.  Messages exchange between sender and server using K1 and Kp. Messages exchange between receiver  and server using K2 and Kp. The keys K1 and K2 are therefore kept secret between one another, sender and receiver. When message or data communication takes place each uses its own secret key and Kp of an intermediate server or entity. The advantage is that one communicating end cannot use the other end\u2019s key or even misuse that key later. \n\nX.509 certificate is a certificate with a chain of trust based on an authorised Certification- Authority (CA) and Public Key Infrastructure (PKI). The sender submits a document once to the CA for digital signature, and the CA issues a certificate of verification of that document. Later, that document can be authenticated by the CA as same and from the same source. Public key infrastructure means provisioning a trusted service for assigning public keys. \n\n84 Internet of Things: Architecture and Design Principles \n\n3.2.2 Lightweight Machine-to-Machine Communication Protocol \n\nLightweight Machine-to-Machine Communication (LWM2M) protocol is an application layer protocol specified by Open Mobile Alliance (OMA) for transfer of service data/messages. It finds applications in M2M. It enables functionalities for device management in cellular or sensor networks. Communication protocol \u2018light weight\u2019 means that it does not depend on call to the system resources during execution. Example of call to a system resource is calling an API for display menu or network function in the system software (OS). Lightweight presently means data transfer formats between client and server are binary and has Tag Length Value (TLV) or Java Script Object Notation (JSON) batches of object arrays or resource arrays and transfers up to 100s of bytes unlike the webpages of 1000s of bytes. \n\nThe protocol enables communication between LWM2M client at IoT device and an LWM2M server at the M2M application and service capability layer. The protocol is a compact one, meaning small header. It has an efficient data model. It is generally used in conjunction with CoAP. \n\nFigure 3.3 shows M2M devices LAN connectivity. It shows constrained devices network connectivity with M2M applications and services using LWM2M OMA standard specifications of LWM2M. \n\nAssume i number of M2M devices. Figure 3.3 shows the following: \n\n\u25cfLocal M2M constrained devices use, for example, the Bluetooth low energy, 6LowPAN (IPv6 over low power WPAN), CoRE, ROLL, NFC, ZigBee PAN, cellular, Wi-Fi or ZigBee IP (left-hand side) network technologies. M2M area network functions as PAN for connectivity between devices and the M2M gateway. \n\n\u25cf10s of bytes communicate between a device and the PAN. \n\n\u25cfCommunication between LWM2M objects (right-hand side). LWM2M client refers to object instances as per the OMA standard LWM2M protocol. A client object sends a request or receives a response of the LWM2M server over the access and CoRE networks. \n\n\u25cfCoRE network, for example, 3GPP or other networks for the IP connectivity \n\n\u25cfCommunication from an object instance using interface functions. The functions are bootstrapping; registration, deregister or update a client and its objects; reporting the notifications with new resource values; and service and management access through the server. \n\n\u25cfUse of the CoAP, DTLS, and UDP protocols by the object or resource. \n\n\u25cf100s of bytes communicate between objects at the client or server for plain text or JSON or binary TLV format data transfer. LWM2M specifications and features are as follows: \n\n\u25cfAn object or resource use CoAP, DTLS, and UDP or SMS protocols for sending a request or response. \n\nConstrained environments communication with M2M apps and services \n\nusing connectivity of LWM2M objects and \n\nresources \n\nDesign Principles for Web Connectivity 85 \n\n\u25cfUse of plain text for a resource or use of JSON during a single data transfer or binary TLV format data transfer for a package for a batch of resource representations in a single data transfer. \n\n\u25cfAn object or its resource access using an URI. \n\n\u25cfInterface functions are for\u2014bootstrapping; registration, deregister or updating a client and its objects; reporting the notifications with new resource values; and service and management access through the server. \n\n\u25cfUse of object model for resources and each object can have single or multiple instances. Each resource can have single or multiple instances. \n\n\u25cfOMA or other standard specifying organisation defines the LWM2M objects for usages in M2M communication. An LWM2M client has object instances as per OMA standards. LWM2M client-server interactions are over the access and CoRE networks which generally use CoAP over ROLL. LWM2M device client and server, generally use CoAP client server interactions for data interchanges. Wi-Fi and WiMax are examples of access networks. Examples of CoRE network are GSM, GPRS, 3GPP and 4G LTE or other networks for IP connectivity as well as roaming. \n\n[Bluetooth (Low energy), ZigBee IP, 6LowPAN, Cellular, Wi-Fi or other IP Constrained Devices and Network] M2M management \n\nfunctions \n\nM2M app \n\nM2M app \n\nM2M app \n\nM2M service \n\nM2M Service \n\nLWM2M \n\nclient \n\nLWM2M \n\nserver \n\nM2M Service Capabilities \n\nM2M Applications and \n\nManagement \n\nFunctions \n\nResources \n\nStack \n\nBootstrap \n\nRegistration \n\nReport \n\nObject/resource access \n\nStack \n\nResources \n\nCoAP server \n\nCoAP client \n\nUDP SMS \n\nDTLS \n\nUDP SMS \n\nDTLS \n\n100s of Bytes \n\nInterfaces \n\nObject i \n\nCoRE and \n\nAccess Networks M2M Gateway M2M Devices \n\n10s of Bytes \n\n10s of Bytes \n\n10s of Bytes \n\n10s of Bytes \n\n10s of Bytes \n\nM2M Device PAN \n\nDevice 1 \n\nDevice 2 \n\n\u2026\u2026 \n\n\u2026\u2026 \n\nDevice \n\nDevice i \n\n100s of Bytes \n\nM2M Area \n\nLocal Network \n\nObject 1 \n\nLWM2M \n\nClient \n\nJSON batches of Objects or \n\nResource \n\nTLV \n\nPlain \n\nText \n\n(i - 1) \n\nFigure 3.3  M2M devices local area network connectivity, and constrained devices network connectivity \n\nwith M2M applications and services using LWM2M OMA standard specifications of LWM2M \n\n86 Internet of Things: Architecture and Design Principles \n\n\u25cfOrganisations can register the other LWM2M objects and resources with OMA or other standards organisations. \n\n\u25cfM2M management functions can be M2M Service Bootstrap Function (MSBF) for credentials of the devices and gateway, and M2M authentication server (MAS) for security, root key data store and device and data authentication. Example 3.1 gives the OMA specifications2 for management objects, query resources, location resources and resource attributes, and response codes for M2M. \n\nExample 3.1 \n\nProblem Give examples of LWM2M objects and resources. \n\nSolution \n\nFollowing are OMP-specifications-based objects and resources: \n\nOMA Management Objects \n\nObjects assignments are: \n\n\u25cfMultiple instances case ID = 1 for LWM2M server, and 2 for access control (means rights granted yes or no). \n\n\u25cfSingle instance case ID = 3 for device object, 4 for connectivity monitoring, 5 for firmware (installation, update or actions after update) and 6 for location object. \n\nQuery Parameter Codes The assignment of parameters in the queries is: \n\n\u25cfh for end-point name, when registering in a domain \n\n\u25cfrt for end-point type \n\n\u25cflt for life-time in second. Locations Object Resources \n\nLocations Object Resources have single instances. Each instance is specified by an ID as follows: \n\n\u25cf0 for latitude, 1 for longitude, 2 for altitude (in decimal numbers), \n\n\u25cf4 for velocity of non-static devices, \n\n\u25cf5 for time stamp \n\n\u25cf3 for uncertainty. Resource Attributes Attributes assignment is using an id, which is an integer for resource id. Attributes used in auto-observation are specified as: \n\n\u25cfif (interface description at initiation at bootstrapping) \n\n\u25cfurl (for path) \n\n\u25cfrl (for type) \n\n\u25cfct (for CoAP content type convert ASCII MIME type) \n\n\u25cfobs (observable Boolean) \n\n\u25cfaobs (auto-observable Boolean) \n\n2 https://github.com/OpenMobileAlliance/OMA-LWM2M-DevKit/blob/master/objects/lwm2m-object-definitions.json \n\nDesign Principles for Web Connectivity 87 \n\nResponse Codes Specified for creating successful registration and maximum lifetime or 4.00 for a bad CoAP request (Example 3.1). \n\n3.2.3 JSON Format \n\nFeatures of a JSON are: \n\n\u25cfJSON is an open-standard format used primarily to transmit data between a server and web application, as an alternative to XML. The text is human readable. It transmits data objects as text to transmit. It consists of attribute\u2013value pairs. \n\n\u25cfOriginally derived from the JavaScript scripting language, JSON, is now a language- independent data format, the coding of which can be in Java or C or another programming language used for parsing and generating JSON data. Example 3.2 describes codes used for data transfer in JSON. \n\nExample 3.2 \n\nProblem Give a JSON object example in JavaScript using OMA object definitions. \n\nSolution \n\nFollowing are the codes as per OMA specifications for LWM2M objects2. The code is at: \n\n{ \n\n\u201c0\u201d: { \n\n\u201cid\u201d: 0, \n\n\u201cname\u201d: \u201cLWM2M Security\u201d, \n\n\u201cinstancetype\u201d: \u201cmultiple\u201d, \n\n\u201cmandatory\u201d: true, \n\n\u201cdescription\u201d: \u201cThis LWM2M Object provides the objects and resources of Client appropriate to access a specified LWM2M Server. The LWM2M Object Resources MUST only be changed by a LWM2M Bootstrap Server or Bootstrap from Smart Sensor and MUST NOT be accessible by any other LWM2M Server. One Object Instance SHOULD address a LWM2M Bootstrap Server.\\n \u201c, \n\n\u201c0\u201d: \n\n\u201cresourcedefs\u201d: { \n\n{ \n\n\u201cid\u201d: 0, \n\n\u201cname\u201d: \u201cLWM2M  Server URI\u201d, \n\n\u201coperations\u201d: \u201c-\u201d, \n\n\u201cinstancetype\u201d: \u201csingle\u201d, \n\n\u201cmandatory\u201d: true, \n\n\u201ctype\u201d: \u201cstring\u201d, \n\n88 Internet of Things: Architecture and Design Principles \n\n\u201crange\u201d: \u201c0-255 bytes\u201d, \n\n\u201cunits\u201d: \u201c\u201d, \n\n\u201cdescription\u201d: \u201cUniquely identifies an LWM2M Server or LWM2M Bootstrap Server. Its form is: \\n\\\u201dcoaps://host:port\\\u201d, where port is the UDP port of the Server.host is an IP address or FQDN, and \u201c \n\n\u201c1\u201d: }, \n\n{ \n\n\u201cid\u201d: 1, \n\n\u201cname\u201d: \u201cBootstrap Server\u201d, \n\n\u201coperations\u201d: \u201c-\u201d, \n\n. \n\n. \n\n. \n\n} \n\n\u201c9\u201d: { \n\n\u201cid\u201d: 9, \n\n\u201cname\u201d: \u201cLWM2M Server SMS Number\u201d, \n\n\u201coperations\u201d: \u201c-\u201d, \n\n\u201cinstancetype\u201d: \u201csingle\u201d, \n\n\u201cmandatory\u201d: true, \n\n\u201ctype\u201d: \u201cinteger\u201d, \n\n\u201crange\u201d: \u201c\u201d, \n\n\u201cunits\u201d: \u201c\u201d, \n\n}, \n\n\u201cdescription\u201d: \u201cMSISDN used by the LWM2M Client  to send messages to the LWM2M Server via the SMS binding. \\nThe LWM2M Client SHALL silently ignore any SMS not originated from unknown MSISDN\u201d \n\nExample 3.3 describes the codes used for data transfer in Java using JSON. \n\nExample 3.3 \n\nGive a JSON object example in Java. \n\nSolution \n\nJSON object is subclass of java.util.HashMap. Assume sensor name is SensTemp1, temperature is integer, and number of sensors is a double. is_newSensorAdded ( ) is a method which returns Boolean data type. \n\nFollowing is the code in Java: \n\nDesign Principles for Web Connectivity 89 \n\n//import org.json.simple.JSONObject; JSONObject obj=new JSONObject(); \n\nobj.put (\u201cname\u201d,\u201dSensTemp1\u201d); obj.put (\u201ctemperature\u201d,new Integer(100)); obj.put (\u201cnumberOfSensors\u201d,new Double(1000.21)); obj.put (\u201cis_newSensorAdded\u201d,new Boolean(true)); StringWriter out = new StringWriter(); \n\nobj.writeJSONString(out); String jsonText = out.toString(); System.out.print (jsonText); Result: {\u201cName\u201d: \u201cSensTemp1\u201d: \u201cTemperature\u201d: 26\u201d \u201cnumberOfSensors\u201d:1000000, \u201cnewSensorAdded\u201d: null, } \n\n3.2.4 Tag Length Value Format \n\nIn a TLV format the first two bytes are used to identify the parameter. The first and fourth bytes indicate the length of the actual data which follows directly after these bytes.3 \n\nFollowing is an example of codes used for data transfer in TLV format. \n\nExample 3.4 \n\nProblem Give examples of  TLV format messages. \n\nSolution \n\nAssume that an application service uses CoAP for which code is \u201c200\u201d (standard number allotted by OMA.) Let engine parameter rpm is assigned ID = 125 and velocity assigned ID = 126.  Format in TLV can be as follows: \n\n</engine>;EngObj;id=\u201d20\u201d;ct=\u201d200\u201d, </engine/rpm>; EngObj;id=\u201d125\u201d, \n\n</engine/velocity>;EngObj;id=\u201d126\u201d \n\n3.2.5 MIME Type \n\nGeneric-type files are application/octet-stream; however, MIME-type files are used in web applications and services.4 Features of MIME are: \n\n\u25cfAn Internet standard which is for description of the contents of various files. \n\n\u25cfAn Internet standard which extends the Simple Mail Transfer Protocol (SMTP) format of email to support the text in character set besides ASCII, and the non-text attachments such as  audio, video, images and application programs. \n\n\u25cfSupports messages with multiple parts and header information in non-ASCII character sets. \n\n3 https://en.wikipedia.org/wiki/Type-length-value 4 https://en.wikipedia.org/wiki/Media_type \n\n90 Internet of Things: Architecture and Design Principles \n\n\u25cfInitially designed for mail, now it is used as Internet media type. Web client header specifies the content types using a MIME type. \n\n\u25cfList of MIME type files is exhaustive. Few examples of MIME type files are\u2014doc (application/msword), html (text/html), htm (text/htm), gif (image/gif), js (application/ x-javascript), css (Application is text/css), mpeg (video/mpeg), pdf (application/pdf) and exe (application/octet-stream). HTML links, objects, and script and style tags, each has a type attribute the value of which can be set equal to a MIME type. The MIME type for HTML is text/html. An associated file is also used which is called mime.types file. It associates filename extensions with MIME type. Such kinds of files allow one to use the extension in these cases. A mime.types file enables a web server to determine MIME type of a resource. This is because a file system may not store the MIME type information, but instead rely on the filename extension. \n\nReconfirm Your Understanding \n\n\u25cfMeanings of important key terms\u2014API, service, state, object, resource, directory, repository, identifier, discovery, representation, URI, URL, header, hypertext, hyper link, HTTP, HTML and XML have been discussed. \n\n\u25cfREST is a software architecture. It refers to the practices and constraints to be followed. REST uses URIs/URLs for representations of the resources, uses access methods: POST, GET, PUT and DELETE. The architecture is used during design of software components. \n\n\u25cfIETF recommended CoRE specifications for ROLL network. CoRE specifications include the CoAP and UDP. \n\n\u25cfCoRE objects use standard protocols for constrained environment when sending a request or response. CoAP client and CoAP server objects communicate over the network, transport layers to other end CoAP client and server. The objects connect to web using HTTP-CoAP and CoAP-HTTP proxy. A client/ server object use the URIs coap://\u2026 in place of http://\u2026 . \n\n\u25cfCoAP client-server interactions use UDP and DTLS protocols. The HTTP client-server interactions use TCP/UDP and TLS protocols. \n\n\u25cfLWM2M client has specifications of the object instances as per OMA specifications.  LWM2M client- server interactions are over the access and CoRE networks. LWM2M client and server generally use the CoAP client server interactions over ROLL. Access network examples are Wi-Fi and WiMax. CoRE network examples are GSM, GPRS, 3GPP, 4G LTE and other networks which enable IP connectivity and roaming. \n\n\u25cfAn object instance communicates using the LWM2M  Interface functions that are bootstrapping; registration, deregister or update a client and its objects; or reporting the notifications with new resource values; and service and management access through server. \n\n\u25cfAn application exchanges the objects using Internet protocols. 100s of bytes communicate between the objects at the client or server. The objects communicate plain text, XML, JSON, TLV or MIME type formats for communication on the Internet. \n\n\n![Image](/src/assets/generated_images/iot2_p117_i0.png)\n\nDesign Principles for Web Connectivity 91 \n\nSelf-Assessment Exercise \n\n1. List the properties of constrained environments. Use examples of connected \n\ndevices, such as streetlights, RFIDs and ATMs with the Internet. 2. Give the order of bytes which transmit or are received at the connected device, \n\ndevices local area network cum gateway and at the HTTP web object during interchange of data between devices and network, and application and service domains. 3. List features of REST architectural style of designing software components. 4. Create a table of comparison between constrained devices and unconstrained \n\nsystem environment, protocols, client and server characteristics. 5. Consider Figure 3.1 and draw a data communication diagram for ZigBee IP \n\nconnected streetlights local network gateway connectivity and secured web connectivity to streetlight monitoring and controlling server applications in the CoRE and unconstrained  environments using the CoAP and HTTP protocols. 6. List the features of CoAP. 7. What are the functions of DTLS? 8. Consider Figure 3.3 and draw a data communication diagram for RF links \n\nconnected RFID local network gateway connectivity and inventory application and tracking service using LWM2M and IP network. 9. List OMA specifications for management objects, query resources, location \n\nresources and resource attributes and response codes for M2M. 10. Write code for JSON object in Java. Assume sensor names are StreetLightN_I \n\nand StreetLightN_J for Nth streetlight. Ambient-light sensor N_I output is Boolean and  Street Traffic density  sensor N_J output is a Byte. The is_ SensorN_IAdded ( ) and is_SensorN_JAdded ( ) are methods which returns Boolean data type. 11. Write the format in TLV for data interchange in LWM2M. Assume that an \n\napplication service uses CoAP for which code is \u201c200\u201d (Standard number allotted by OMA. Let traffic density parameter numPer100Meter is assigned ID = 4038 and street length, m is assigned ID = 126). 12. List 10 extensions in the list of MIME-type files. \n\n\u2605 \n\n\u2605 \n\n\u2605 \u2605 \n\n\u2605\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605 \u2605\u2605 \n\n\u2605\u2605 \n\n\u2605\u2605\u2605 \n\n\u2605 \n\n3.3 MESSAGE COMMUNICATION PROTOCOLS FOR CONNECTED DEVICES \n\nA device/node/end-point/client/server sends and receives message(s). A communication module includes a protocol handler, message queue and message cache. The protocol- \n\nIllustrate the usage of messaging \n\nprotocols between connected devices and \n\nthe web \n\nLO 3.2 \n\nNote: \u2605 Level 1 & Level 2 category \u2605\u2605 Level 3 & Level 4 category \u2605\u2605\u2605 Level 5 & Level 6 category \n\n92 Internet of Things: Architecture and Design Principles \n\nhandler functions during transmission and reception of messages according to the communication protocols for these actions. Message queue forms to keep a message until it is transmitted towards its destination. Message cache keeps an incoming message until it is saved into the module. A device message-queue inserts (writes) the message into the queue and deletes (reads) the message from the queue. Device message-cache stores the received messages. The following section explains the terms used by message- communication protocols. \n\n3.3.1 Terminology \n\nRequest/Response (Client/Server) \n\nA request/response message exchange refers to an object (client) requesting for resource(s) and an object (server) sending the response(s). The objects, for example, HTTP objects may use the REST functions. When sending a request, a protocol adds the header words. Each header has fields. Each field interprets the request at the receiver object. \n\nPublish/Subscribe (pubsub) \n\nPublish/subscribe or PubSub message exchanges differ from request/response. A service publishes the messages; for example, a weather information service publishes the messages of weather reports for the potential  receivers. A group controller publishes the messages; for example, measured values of ambient light conditions, traffic density or traffic presence (Example 1.2). \n\nA service can be availed by one or more clients or brokers. When a client subscribes to the service, it receives messages from that service. A publish/subscribe messaging protocol provisions for publication of messages and reception on subscription (PUT and GET methods) by the registered or authenticated devices. \n\nPublication may be for measured values, for state information or resources of one or more types. Subscription is for a resource-type (or for a topic). A separate subscription is required for each resource-type or topic. \n\nAn example of resource type is measured values of ambient light condition in the smart streetlights example. Another resource type is traffic presence or absence on the street. Another resource type is lighting function report; functioning is proper or fault exists in the light. \n\nResource Directory \n\nResource directory (RD)5 maintains information and values for each resource type. A resource of a resource type accesses from the RD using URI for the resource. \n\nResource Discovery \n\nResource discovery service may advertise (publish) at regular intervals, the availability of the resources or types of the resources available and their states. A client discovers the resource type and registers for the RD service. \n\n5 https://tools.ietf.org/html/draft-koster-core-coapmq-00 \n\nDesign Principles for Web Connectivity 93 \n\nRegistration/Registration Update \n\nRegistration means a receiver registers with a service, such as an a RD service. When one or more endpoints or devices or nodes registers, then that device gets the access to the resources and receives published messages. Security considerations may require authentication of both ends (service provider and receiver) before registration. A separate registration is required for each endpoint (client or server). \n\nRegistration updates means updating for one or more endpoints or devices or nodes. It also includes unregistering for one or more endpoints. \n\nPull (Subscribe/Notify) Data \n\nPull means pulling a resource, value, message or data of a resource-type by registering and subscribing. Pull may be using GET or on initiating OBSERVE. The server maintains state information for a resource and notifies on change of state. Client pulls again the resource on the change. \n\nPolling or Observing \n\nPolling means finding from where new messages would be available or whether new messages are available or updates are available or whether the information needs to be refreshed or finding the status if the state information has changed or not. When messages store at a database-server, then polling can be done by a client who uses the REST architecture GET method and server uses the POST. \n\nA state may refer to a connection or disconnection, sleep, awake, created, alive (not deleted), old values persisting or updated with new values (GET + OBSERVE). Observing means looking for change, if any, of a state at periodic intervals (OBSERVE). \n\nPush (Publish/Subscribe) Data \n\nPush means a service that pushes the messages or information regularly. Interested device or endpoint or potential receiver receives these pushes. For example, a mobile service provider pushes the temperature and location information regularly for the potential receivers (registered mobile services subscribers) (PUT). \n\nPush is efficient compared to polling, particularly when notifying or sending alerts. This is because there can be many instances when polling returns no data. Pull  is efficient compared to polling or PUSH when certainty exists that within a reasonable time interval the server returns no data. \n\nMessage Cache \n\nCache means storing when available and can be used later on when required. Messages cache is useful in an environment of short or prolonged disconnections of a service. A message can be accessed once or more times from a cache. \n\n94 Internet of Things: Architecture and Design Principles \n\nMessage Queue \n\nMessage queuing means storing the messages (data) in sequence from devices or endpoints so that when connection state changes then messages can be forwarded. Forwarding is done using the first-in first-out method for a resource type. A message forwards only once from a queue. \n\nSeparate queues are formed for each resource type. The messages are forwarded to the registered devices or endpoints and to the subscribed devices or endpoints. A separate registered device or endpoint list and a separate subscription list is maintained and used for each resource type. Forwarding takes place only after matching the subscription from a list. \n\nInformation/Query \n\nThe method is that an object (client) requests information using a query while another end-object (server) responds by replying to the query. The responding application processes the query using the query optimiser and retrieval plan. The query processing uses a database or resource directory resources. \n\n3.3.2 Communication Protocols \n\nFollowing are the protocols used in message communication. \n\nCoAP-SMS and CoAP-MQ \n\nM2M or IoT device uses SMS quite frequently. SMS is identified as the transport protocol for transmission of small data (up to 160 characters). It is used for communicating with a GSM/GPRS mobile device. \n\nM2M or IoT device uses message queuing quite frequently due to ROLL environment and constrained devices (awake only when initiated) or connection-breaks for long periods. CoAP-SMS and CoAP-MQ are two protocols drafted and recommended by IETF. \n\nCoAP-SMS \n\nCoAP-SMS is a protocol when CoAP object uses IP as well as cellular networks and uses SMS. It is an alternative to UDP-DTLS over ROLL for CoAP object messages and when using cellular communication. \n\nSMS is used instead of UDP + DTLS by a CoAP client or server. A CoAP client communicates to a mobile terminal (MT) endpoint over the General Packet Radio Service (GPRS), High Speed Packet Access (HSPA) or Long Term Evolution (LTE) networks using CoAP-SMS protocol. \n\nFollowing is the IETF recommended terminology for use: \n\n\u25cfSMS-C: SMS service centre \n\n\u25cfSMS-SP SMS service provider \n\nDesign Principles for Web Connectivity 95 \n\n\u25cfCIMD: Computer interface to message distribution \n\n\u25cfMS:  Mobile station at a cellular network functioning as CoAP client  or CoAP sever \n\n\u25cfMO: Machine or IoT device or mobile origin functioning as CoAP client \n\n\u25cfMT: Machine or IoT device or mobile terminal functioning as CoAP sever \n\n\u25cfSMPP: Short message peer-to peer for CoAP-Data. Peer-to-peer means sending requests as well as receiving requests \n\n\u25cfSS7: Signalling Service Protocol \n\n\u25cfUCP/UMI: Universal computer interface protocol/machine interface for short message delivery contained in a CoAP request or CoAP response The CoAP-SMS features are as follows: \n\n\u25cfAn URI used as coap+sms:// in place of coap://. For example, URI may be coap+sms:// telNum/carLocatiobObject/latitude for latitude of location of  a car after  LocationObject measures location parameters using the GPS. URI is used when sending the SMS to the specified telephone number\u2014telNum. \n\n\u25cfA CoAP message encodes with alphabets for SMS communication. An SMS message consists of 160 characters in 7-bit encoding of a character. Maximum length for a CoAP message is thus 140 B (= 160 \u00d7 7 bits/8 bits) when an SMS-C supports 8-bit encoding. A CoAP message is thus 70 (= 160 \u00d7 7 bits/16 bits) when an SMS-C supports 16-bit encoding and multilingual alphabets. Concatenated short messages can be up to 255B, provided the SMS-C supports this. \n\n\u25cfCoAP endpoints have to work with a Subscriber Identity Module (SIM) card for SMS in cellular networks. The points are addressed by using Mobile Station ISDN (MSISDN) number.  A TP-DATA-Coding-Scheme inclusion enables the CoAP client to find that the short message contains a CoAP message. \n\n\u25cfDoes not support multi-casting \n\n\u25cfTwo additional options are Response-to-URI-Host (RUH) and Response-to-URI-Port (RUP) which make initiating CoAP client aware of the presence of the alternative interface CIMD and SMPP and UCP/UMI. RUH is string of size 0 to 255B. RUP is of 2B with default port number 5683. IANA (Internet Assigned Number Authority) registered TBD as CoAP Option Numbers for registry. \n\n\u25cfData interchange sequences are as follows: An MS/CoAP client sends a SMS request (SMS-SUBMIT) to SMS-C; SMS-C reports using SMS-SUBMIT-REPORT; SMS-C sends SMS (SMS-DELIVER) to MS/CoAP server; the server reports using SMS-DELIVER- REPORT; and SMS-C sends SMS-STATUS-REPORT to the client. \n\n\u25cfAuthentication of a client by the server provides the security. MSISDN of the MS and SIM based security is used during SMS data exchanges. Figure 3.4(a) shows a CoAP request or response communication to a machine, IoT device or MT. A CoAP client sends request to SMS-C which transmits the request to an MT. A CoAP server sends response to SMS-C which transmits the response to the client. \n\nFigure 3.4(b) shows a computer or machine interface using IP for sending request or receiving the CoAP data or HTTP request (REQ) to a mobile service provider using SMPP or CIMD for data interchange. The service provider communicates using SS7 or CIMD or \n\n96 Internet of Things: Architecture and Design Principles \n\nSMPP with machine or IoT device or MT with an in-between node SMS-C. The terminal sends response to the origin using SMS-C and CoAP-MQ Broker. \n\nFigure 3.4(c) shows a CoAP request or response communication from a machine, IoT device or MO. A CoAP client sends request to SMS-C which transmits the request. A CoAP server sends the response to SMS-C which transmits it to the client. \n\nFigure 3.4(d) shows a computer or machine interface using IP for receiving request or sending response (RES) as CoAP data or HTTP REQ mobile service provider using SMPP or CIMD for data interchange. The SMS-C communicates that to CoAP-MQ BROKER using SS7 or CIMP or SMPP. SMS-SP receives request or sends response to machine or IoT device or mobile origin. \n\nCoAP-MQ \n\nCoAP-MQ is a message queue protocol using a broker and RD. Roles of CoAP endpoints have roles as a client and server. \n\nCoAP Request \n\nCoAP Request \n\nMT MT 140 B SMS-C/ \n\nHLR SPS-SP SPS-C IP CIMD or SMPP \n\nHTTP-REQ/ CoAP Data \n\nSS7/ CIMD/ \n\nSMPP \n\nCoAP Request \n\nCoAP Response \n\nCoAP Response HTTP-REQ/ \n\nCoAP Data CoAP Response (b) (a) \n\nCoAP Request CoAP Request HTTP-REQ/ \n\nCoAP Data \n\nIP CIMD or \n\nSMPP \n\nHTTP-RES/ \n\nCoAP Data \n\nSMS-SP SMS-C/ \n\nHLR MO \n\nCoAP Response SS7/CIMD/SPMM \n\n(d) (c) \n\nSMS-C \n\nSMS-C \n\nMO: Mobile Originator \n\nCoAP Response \n\nMO \n\nSMS-C: SMS Service Centre \n\nMT: Mobile \n\nTerminator \n\nSMS-SP: SMS Service Provider \n\nHLR: Home Location Register \n\nFigure 3.4  (a) A CoAP request or response communication to a machine, IoT device or mobile terminal \n\n(MT), (b) A computer or machine interface using IP communication to a mobile service provider for data interchange with terminal, (c) A machine or IoT device or mobile origin (MO) communication of CoAP request or response communication, and (d) An origin communication using SS7/CIMD/SMPP with  a computer or machine interface using IP communication \n\nDesign Principles for Web Connectivity 97 \n\nFigure 3.5 shows data interchanges between CoAP-MQ endpoints, CoAP-MQ clients, CoAP-MQ servers through CoAP-MQ broker and its services. \n\nInterfaces \n\nWeb Objects \n\nUDP DTLS \n\nWeb Client \n\nCoAP-MQ Client \n\nCoAP-MQ Server \n\nCoAP-MQ Function Set \n\nCoAP-MQ End \n\nPoint \n\nCoAP-MQ Function Set \n\nNetwork and Device Network Domain Device Network Domain \n\nProxy Service \n\nStore and \n\nForward \n\nService \n\nResources Discovery \n\nService \n\nSubscription \n\nMatch Service \n\nResources \n\nDirectory \n\nService \n\nRD and CoAP-MQ \n\nBroker \n\nObject/Resources \n\nResources Directory \n\nRegistration Updates \n\nRegistration \n\nRegistration \n\nPubSub \n\nPubSub \n\nState Information \n\nState Information \n\nDiscover \n\nPublications \n\nSubscription \n\nInterfaces \n\nCoAP-MQ Function Set \n\nCoAP-MQ \n\nEnd Point \n\nCoAP-MQ \n\nClient \n\nCoAP-MQ \n\nServer \n\nFigure 3.5  Data interchanges between CoAP-MQ endpoints, CoAP-MQ clients, CoAP-MQ servers \n\nthrough CoAP-MQ broker and its services [PubSub means publication to RD and subscription to MQ] \n\nFigure 3.5 shows CoAP-MQ server provisioning for the resource-subscription, store from the publisher. The server also provisions for forwarding to the subscriber and proxy services. The figure also shows that RD services are resource discovery, directory and object registration services. The device objects communicate using the CoAP client and server protocols and CoAP web objects using DTLS as security protocol and UDP for CoAP APIs. \n\nMQTT Protocol \n\nMessage Queuing Telemetry Transport (MQTT) is an open-source protocol for machine-to- machine (M2M)/IoT connectivity. Word \u2018telemetry\u2019, in English dictionary, means measuring and sending values or messages to far off places by radio or other mechanism. \n\n98 Internet of Things: Architecture and Design Principles \n\nIBM first created it and then donated it to M2M \u2018Paho\u2019 project of Eclipse. A version is MQTT v3.1.1. MQTT has been accepted (2014) as OASIS (Organization for the Advancement of Structured Information Standards) standard6 MQTT protocol is used for connectivity in M2M/IoT communication. \n\nA version is MQTT-SN v1.2. Sensor networks and non-TCP/IP networks, such as ZigBee can use the MQTT-SN. MQTT-SN is also a publish/subscribe messaging protocol. It enables extension of the MQTT protocol for WSNs, the sensor and actuator devices and their networks. \n\nRecall from Figure 1.3, IBM conceptual framework for the IoT, which showed MQTT applications for one of the communication management functions. Figure 3.6 shows messages interchange between M2M/IoT device objects (publisher and subscriber) and web objects (publisher and subscriber) using an MQTT broker. \n\nSSL/TLS Publisher \n\nSubscriber \n\nMQTT Broker \n\n\u2026\u2026. \n\nSubscription \n\nMatch Service \n\nTopic \n\nTopic \n\nMessage Retention \n\nService \n\nKeep Msg. \n\nAlive Service \n\nPublisher \n\nSubscriber \n\nPublisher \n\nSubscriber \n\nTCP \n\nSSL/TLS \n\nTCP \n\nIoT/M2M MQTT Java, C \n\nor JavaScript \n\nLibrary functions \n\nMQTT Java, \n\nC or JavaScript \n\nLibrary Functions \n\nWeb Objects M2M/IoT \n\nObjects \n\nM2M/IoT Network \n\nStore \n\nand Forward \n\nService \n\nFigure 3.6  Messages interchange between M2M/IoT device objects (publisher and subscriber) and web \n\nobjects (publisher and subscriber) using an MQTT Broker \n\n6 http://docs.oasis-open.org/mqtt/mqtt/v3.1.1/os/mqtt-v3.1.1-os.doc. \n\nDesign Principles for Web Connectivity 99 \n\nFigure 3.6 shows MQTT-broker subscription, subscription match, store and forward, last good message retention and keep message alive services. The figure also shows that device objects use MQTT Java, C or JavaScript library functions. The objects communicate using the connected devices network protocols such as ZigBee. Web objects also use MQTT library functions and communicate using IP network and SSL and TLS security protocols for subscribing and publishing web APIs. \n\nMQTT Broker (also referred simply as MQ) does the following: \n\n\u25cfFunctions as a server node capable of storing messages from publishers and forwarding them to the subscribing clients. \n\n\u25cfReceives topics from the publishers. Examples of topics are measured information of ambient light conditions, traffic density, nearby parking space availability and waste container status. \n\n\u25cfPerforms a store-and-forward function, stores topics from publishers and forwards to subscribers. \n\n\u25cfReceives subscriptions from clients on the topics, matches subscriptions and publications in order to route messages to right endpoints. \n\n\u25cfRecovers subscriptions on reconnect after a disconnection, unless the client explicitly disconnected. \n\n\u25cfActs as a broker between the publisher of the topics and their subscribers. \n\n\u25cfFinds client disconnection until DISCONNET message receives, keeps message alive till explicit disconnection. \n\n\u25cfRetains the last-received message from a publisher for a new connected subscriber on the same topic, when retain field in the header is set. \n\n\u25cfAuthentication by Username/Password in connect message and client security is through SSL/TLS. Security considerations are same as of CoAP, web-linking and CoRE resource directory. \n\n\u25cfSupport from Intelligent and business analyst server and other servers through a MQTT server with a gateway. \n\n3.3.3 XMPP (Extensible Messaging and Presence Protocol) \n\nXML \n\nXML is an open-source IETF recommended language. XML is widely used for encoding messages and texts.  A text element in an XML document can correspond to the data, message, alert, notification object, command, method or  value of an entity. There is a way to tag in which text is featured between the tag and its associated end tag. \n\nAn XML tag specifies the type of encoded entity in an element. A tag may also associate an attribute(s) which is specified there itself. The interpretation and use of the text within a tag pair (a tag and its associated end tag) depends on the parser and associate application. The Parser uses XML file as input. The application uses the output from the parser. The parser and application can be in Java, C# or any other programming language. Following is an example of usage of XML tags and attributes in XML elements in a document. \n\n100 Internet of Things: Architecture and Design Principles \n\nExample 3.5 \n\nProblem Give the usages of XML tags and attributes in XML messages using an XML document (text file), assuming that the XML messages are for a temperature sensor. Assume that more than one sensor measures the temperature and put time of measurement stamp also. \n\nSolution \n\nAn XML message sent by a temperature sensor is as follows: <SensTemp> 22 degree C </SensTemp>. <SensTemp> can associate with the attributes as: \n\n<SensorTemp ID = \u2018250715\u2019 TimeDate = \u201819:28:33 Jul 17 2016\u2019>  22 </SensTemp>. \n\nA Java parser can read the file when it streams and in which the above text message is present. That parser creates a database. The database may be a table with the columns: Sensor ID, Time, Date and Temperature. An associated program (application) uses these results. For example, application sends a message for an actuator circuit to switch off Air Conditioner, again in XML. The message format from the Application with ID = 241206 to Air conditioner of ID = 2075 can be: \n\n<ActuatorAirCond ID = \u20182075\u2019 AppId = \u2018241206\u2019  > SwitchOff < /ActuatorAirCond>. \n\nXMPP \n\nXMPP is an XML-based specification for messaging and presence protocols. XMPP is also an open-source protocol recommended specification which is accepted by IETF. RFC is an international organisation and stands for \u2019Recommended for Comments\u2019. RFC 6120 document specifies the XMPP for CoRE. Another recommendation, RFC 6121 XMPP specifies the instant messaging (IM) and presence, and RFC 6122 XMPP specifies the (message) address format. \n\nMessages notify presence for the IMs to one or many at the same time. It enables chatting and Multi-User Chat (MUC) after creation of a chat room, where different users can do the IMs. XMPP enables interoperable communication: for example, Google Talk. XMPP enables IMs between many users as it uses presence-notifications and chat features. \n\nChat room is an application, in which all those who have subscribed (meaning persons and objects initiating chatting and messaging to one another at the same time) are provided a room-like view and use the IMs among themselves. \n\nXMPP is extensible\u2014XSF (XMPP standards foundation) develops and publishes the xeps (XMPP extension protocols). The xeps enable the addition of features and new applications. List of XMPP xeps for web objects is quite long. Examples of xeps are: \n\n\u25cfxep-DataForms Format \n\n\u25cfxep-XHTML-IM \n\n\u25cfxep-Service Discovery \n\n\u25cfxep-MUC \n\n\u25cfxep-Publsih-Subscribe and Personal Eventing Protocol \n\n\u25cfxep- File Transfer \n\n\u25cfxep-Jingle for Voice and video \n\nDesign Principles for Web Connectivity 101 \n\nXMPP-IoT xeps extend the use of XMPP to IoT and machine-to-machine messaging.7,8 \n\nList of extensions (xeps) is quite long. Examples of xeps are: \n\n\u25cfxep-0322 efficient XML interchange (EXI) format \n\n\u25cfxep-0323 Internet of Things-Sensor Data (http://xmpp.org/extensions/xep-0323.html) \n\n\u25cfxep-0324 Internet of Things-Provisioning \n\n\u25cfxep-0325 Internet of Things-Control (http://xmpp.org/extensions/xep-0325.html) \n\n\u25cfxep-0326 Internet of Things-Concentrators. The xeps are the base for IEEE/ISO/IEC recommended \u201cSensei/IoT\u201d related standards, sensei/IoT ISO/IEC/IEEE P21451-1-4 and other standardizations. \n\nXMPP-IoT enables communication machine to web application and M2M interoperable. Many connected-devices-based business applications, processes, smart home, smart city, smart energy saving and smart street lighting and traffic are possible using XMPP, XMPP- IoT and other servers communicating with XMPP servers. \n\nFigure 3.7 shows use of the XMPP and XMPP extension protocols for connected devices and web objects. The protocols are for messaging, presence notification, response-on- demand and service discovery using XML streams. \n\nFigure 3.7 shows that XMPP-IoT server consists of xeps and services. XMPP services are extensible to publisher/subscriber, MUC and other services, devices and connected devices area network which interact with XMPP-IoT services. The XMPP-IoT server, through a gateway between connected devices and IP networks, communicates with XMPP APIs in web objects. \n\nSimple Authentication and Security Layer (SASL) and TLS are security protocols for APIs and web object messages using TCP/IP network. The XML streams in XMPP format communicate between the devices, devices to web objects and between the web objects. \n\nFeatures of XMPP are: \n\n\u25cfXMPP uses XML. \n\n\u25cfXML elements are sent in the open-ended stream within the tag <stream> and corresponding end tag </stream>. \n\n\u25cfThree basic types of XMPP stanzas (elements) are: \n\n\u274dmessage \n\n\u274dpresence \n\n\u274diq (information/query, request/response) \n\n\u25cfExtensibility to constrained environment messaging and presence protocols as well as IP network messaging. \n\n\u25cfExtensibility of request-response (client-server) architecture to iq (information through querying), PubSub messaging, Chat room MUC messaging and other architecture (where group of people exchange information when present in a chat room), decentralised XMPP server. \n\n7 https://postscapes.com/internet-of-things-protocols/ 8 http://www.xmpp.org/extensions.html \n\n102 Internet of Things: Architecture and Design Principles \n\nIoT/M2M Client and Server Objects XML Stream \n\nXMPP-IoT \n\nServer \n\nDevice 1 \n\nDevice 2 \n\nDevice i \n\nDevice (i\u20131) \n\n\u2026\u2026 \n\n\u2026\u2026 \n\nIoT/M2M Publish/ \n\nSubscribe Objects \n\nXML Stream \n\nxeps for IoT/ M2M \n\nSubscrip- tion Service \n\nInstant Message \n\nService \n\nPresence \n\nData Service \n\nDemand Response \n\nService \n\nDiscover Service \n\nIoT or M2M Area Net- work \n\nGateway \n\nIoT \n\nor M2M \n\nto IP Network \n\nWeb Objects \n\nClient Application \n\nXMPP \n\nAPI \n\nXML Stream \n\nXML Stream \n\nSASL/TLS \n\nTCP \n\nSASL/TLS \n\nTCP \n\nSMPP \n\nAPI \n\nServer Application \n\nWeb Objects \n\nFigure 3.7  Use of XMPP and XMPP extension protocols for connected devices and web objects for the \n\nmessaging, presence notifications, responses on demand and service discoveries using XML streams \n\n\u25cfXMPP server set by anyone on the following standards recommended and using XSF xeps; for example, XMPP-IoT server, XMPP M2M server for messaging between the machines. \n\n\u25cfAuthentication by SASL/TLS, and support from intelligent and business analyst applications, and processing through XMPP server and gateway for connecting device network with IP network. XMPP does the following: \n\n\u25cfBinary data is first encoded using base 64 and then transmitted in-band. Therefore, the file first transmits out-of-band between nodes on messages from XMPP server but not directly like IMs. \n\n\u25cfNo end-to-end encryption \n\n\u25cfHigher overhead being text based in place of binary implementations \n\n\u25cfNo support for QoS like MQTT does \n\nDesign Principles for Web Connectivity 103 \n\nReconfirm Your Understanding \n\n\u25cfCoAP-SMS is a protocol when CoAP object uses IP as well as cellular networks and SMSs. \n\n\u25cfSMS transport through a service centre is used instead of UDP + DTLS by a CoAP client or server. A CoAP client communicates to a mobile terminal endpoint. \n\n\u25cfWeb objects use the Request/Response, Publish/Subscribe, Subscribe/Notify, Push or Pull and Polling, Message Queues, Instant Messaging, Presence notification for Multi-User Chat and instant messaging modes for transfer of messages, resources, representations, objects and states.  APIs use messaging protocols, CoAP-SMS, CoAP-MQ, MQTT and XMPP. \n\n\u25cfCoAP-MQ data interchanges between the CoAP-MQ endpoints, CoAP-MQ clients, CoAP-MQ servers through CoAP-MQ broker and its services. \n\n\u25cfMQTT is a protocol for the constrained environment. MQTT architecture is PubSub messaging in place of request-response client-server architecture. Publisher (message sender at the device domain or web object at network and application domain) sends the messages on a topic. Subscriber (message receiver at the device domain or web object at network and application domain) receives the messages on a subscribed topic. \n\n\u25cfXMPP CoRE, instant messaging, presence and address format are IETF recommendations for the XMPP messages server. The server notifies presence for the purpose of IMs (instant messaging) to one or many at the same time. The server enables chatting and multi-user chat (MUC) after creation of a chat room, where different users after subscriptions do IMs. \n\nSelf-Assessment Exercise \n\n1. List IETF recommended terms and their usages in CoAP-SMS protocol. 2. Recapitulate Example 1.1 for an umbrella connected to a web-based weather \n\nservice and to a mobile for messaging. Refer Figure 3.4 and draw data interchange using (a) a CoAP request or response communication to a weather data service and (b) an SMS from umbrella device using CoAP to the mobile device. 3. List the functions of resource directory service by RD when using at the \n\nCoAP-MQ protocol. 4. List comparisons between CoAP-MQ and MQTT features. 5. Refer Figure 3.5 and draw a diagram for data interchanges for connected \n\ntemperature sensing devices using CoAP-MQ broker. Each published temperature data using Bluetooth Smart Energy to the broker and gateway publishes using CoAP-MQ client to CoAP server, which in turn connects through proxies to a web service. The weather service publishes data for subscribing web clients on the Internet and the web clients connect to subscribing actuators controlling room temperatures through the broker. 6. What are the functions of MQTT broker? 7. Consider Figure 3.6 and draw a diagram for data interchanges for connected \n\nRFIDs using MQTT broker. Each device sends the ID publishes at two-hour \n\n\u2605 \u2605\u2605 \n\n\u2605 \n\n\u2605\u2605 \u2605\u2605\u2605 \n\n\u2605 \u2605\u2605 \n\n\n![Image](/src/assets/generated_images/iot2_p130_i0.png)\n\n104 Internet of Things: Architecture and Design Principles \n\ninterval using RF links to the broker and gateway messages using MQTT Java, C or JavaScript library functions to inventory monitoring web application. 8. List five XMPP-IoT xeps which extend the use of XMPP to IoT and M2M \n\nmessaging. 9. Refer Example 2.3 and Figure 3.7 and draw a data flow diagram showing \n\nthe use of XMPP protocol for connected ATMs and bank server web objects for the messaging, presence notifications, responses on demand and service discoveries using XML streams. 10. Write code for XML message from two streetlights connected to a streetlight \n\ngroup. Assume sensor names are StreetLightN_I and StreetLightN_J. Assume sensor N_I output is 1 and Street Traffic density output of sensor N_J output is a 24 per 10 m. \n\n\u2605\u2605\u2605 \n\n\u2605\u2605 \n\n3.4  WEB CONNECTIVITY FOR CONNECTED- \n\nDEVICES NETWORK USING GATEWAY, SOAP, REST, HTTP RESTFUL AND WEBSOCKETS \n\nThe following subsections describe the uses of gateway, SOAP, REST, RESTful HTTP and WebSockets for connecting web objects. \n\n3.4.1 Communication Gateway \n\nFigure 1.5 showed the gateway in the Oracle IoT architecture. The figure also showed gateway provisions for applications and IoT communication frameworks, management and proxy functions. \n\nCommunication gateway connects two application layers, one at sender and the other at receiver. The gateway also enables use of two different protocols, one at sender and the other at receiver ends. The gateway facilitates the communication between web server using the TCP/IP protocol conversion gateway and IoT devices. It also facilitates communication between the devices using CoAP client and server using HTTP. \n\nThe gateway provisions for one or more of the following functions: \n\n\u25cfConnects the sender and receiver ends using two different protocols. For example, IoT devices network maybe ZigBee network for connecting the devices. The network then connects to the web server through a gateway. The server posts and gets the data using \n\nOutline the \n\nusage of communication gateway \n\nprotocols, SOAP, REST, RESTful HTTP \n\nand WebSocket by connected devices and \n\nweb \n\nLO 3.3 \n\nCommunication gateway can connect a device using CoAP client and server using \n\nHTTP facilitates the \n\ncommunication \n\nDesign Principles for Web Connectivity 105 \n\nHTTP. A gateway facilitates the communication between IoT devices and web server. For example, (i) ZigBee to SOAP and IP or (ii) CoAP protocol conversion gateway for RESTful HTTP (Section 3.4.4). \n\n\u25cfFunctions as proxy between the system and server. \n\n3.4.2 HTTP Request and Response Method \n\nAn application uses a protocol. The application layer in TCP/IP suite of protocols for Internet uses HTTP, FTP, SMTP, POP3, TELNET and a number of other protocols. HTTP is most widely used application layer protocol for communication over TCP/IP. An HTTP client connects to an HTTP server using TCP and then the client sends a resource after establishing an HTTP connection. \n\nExample 3.6 \n\nProblem Give the request and response communication codes when (a) HTTP request message communicates to a server and (b) message communicates a response to a client. \n\nSolution \n\n(a) Following code sends the request: POST /item HTTP/1.1 \n\nHost: ii.jj.kk.mm \n\nContent-Type: text/plain \n\nContent-Length: 200 (b) The server first processes the request and then sends an HTTP response back to the client. The \n\nresponse also contains the status code and content information for that.: \n\n200 OK \n\nContent-Type: text/plain \n\nContent-Length: 200 200 is standard success code in an HTTP connection. 400 is standard failure code. The status returns \n\nas follows in that case. \n\n400 Bad Request Content-Length: 02 \n\nData Exchanges Between HTTP Web-Objects \n\nAn HTTP connection enables a one-way communication at an instance from client API to a server or from server to the API. \n\nHTTP polling is a method for receiving new messages or updates from an HTTP server. Polling means finding whether new messages or updates are available and receiving them in case they are. \n\n106 Internet of Things: Architecture and Design Principles \n\nAn HTTP transfer is stateless which means each data transfer is an independent request. Therefore, header overhead information and meta-data of previous state need to be present with each HTTP request. Metadata is data which describes the data for interpretation in future. Therefore, each data interchange needs large headers over 100s of byte, and thus greater latency in request-response exchanges. \n\nWays of transferring both ways at the same instant are: \n\n\u25cfMultiple TCP connection \n\n\u25cfHTTP requests at short, regular intervals so that responses are nearly in real time \n\n\u25cfPolling at successive intervals \n\n\u25cfHTTP long polling means API sends a request to the server, which keeps the request open for a set period \n\n\u25cfStream hidden in iFrame Polling methods have high latencies and header sizes of 100s of bytes. An alternative to this is using Java Applets, Silverlight or Flash plugins. \n\n3.4.3 SOAP \n\nApplications need to exchange objects on the Internet using protocols such as HTTP. Applications may be using different languages and platforms. Simple Object Access (SOAP) is a W3C approved open-source protocol.9 \n\nSOAP is a protocol for exchange of objects between applications using XML. It is also a protocol for access to a web service. SOAP specifies the formats and way of communicating the messages. Its usage is independent of the application language and platform (OS and hardware). It is extensible and is also used for APIs for the web services and Service-Oriented Architecture (SOA). \n\nSOAP enables development of applications and APIs. SOAP functions connect the GUI applications to web servers using the standards of the Internet\u2014HTTP and XML. Microsoft\u2019s .NET architecture supports SOAP for Internet application development. \n\nW3C10 recommended SOAP v1.2 second edition specifications\u2014Part 0 is a primer, part 1 is a messaging framework and Part 2 is adjuncts. SOAP v1.2 specifications provision for assertions and test collection, XML-binary Optimized Packaging, SOAP message transmission optimisation mechanism and resource representation SOAP header block. \n\nSOAP uses a body element after the specifications in an envelope. The body element contains the SOAP message intended for ultimate endpoint of the message. \n\nA SOAP request could be an HTTP POST or an HTTP GET request. The HTTP POST request specifies at least two HTTP headers: content type and content length. A SOAP method uses HTTP request/response after the HTTP binding with the SOAP. \n\n9 http://www.w3schools.com/soap/default.asp 10 https://www.w3.org/TR/soap/ \n\nWays of communication \n\nrequest using SOAP and obtaining SOAP \n\nresponse \n\nDesign Principles for Web Connectivity 107 \n\nThe request and response complies with the SOAP encoding rules. Let\u2019s take an example to explain the structure and usage of SOAP. \n\nExample 3.7 describes the coding for SOAP request and response. \n\nExample 3.7 \n\nProblem Recall Example 1.1 and assume that a gateway sends requests for the weather service response and receives the weather message from a weatherMsgService daily. (a) How does a SOAP request or response communicate between two applications: one at gateway weatherMsgG and the other at weatherMsgService using two web objects www.weatherMsgG.com and www.weatherMsgService.com? (b) How is a SOAP message structured? (c)  Write the SOAP message for request from End1 to End2. (d) What can be the SOAP message formats for the XML stream as response using HTPP 1.1 binding?  (e) How will the error communicate? \n\nSolution \n\n(a) Figure 3.8 (a) shows a SOAP request or response communication between weatherMsgG and \n\nweatherMsgService. SOAP sends request from End1 (URL www.weatherMsgG/ weatherMsgRequest to End2 (URL www. weatherMsgService.com/ weatherMsgID250715) for the weatherMsgID250715. The weatherMsgID250715 value will be received at End1. (b) Figure 3.8 (b) shows the SOAP message structure. \n\n(c) Assume that HTTP POST method is use to post the SOAP request message. Assume that Get Temperature \n\nResponse is a method for retrieving the weather message of the weatherMsgID250715 from resources at End2. SOAP sends request for the weather message. The weatherMsgID250715 value will be received at End1 from End2. Figure 3.8 (c) and (d) show SOAP message content and elements. \n\n(d) The response will be from End2 http://www.weatherService.com/weatherMsgResponse to the End1. \n\nEnd2 response for weatherMsgID250715 will have first line for status of message receipt. Next lines will be HTTP binding and then the response message. Fig. 3.8(e) shows SOAP response from weatherMsgG to weatherMsgService using the Internet and HTTP binding \n\n(e) An error message from a SOAP message is carried inside a Fault element. The element has child \n\nelements as follows: <faultcode>, <faultstring>, <faultactor> and <detail>.  Error can be version mismatch or MustUnderstand or client or server. \n\n3.4.4 REST and RESTful HTTP Web Applications \n\nW3C Technical Architecture Group (TAG) developed the Representational State Transfer (REST) architectural style.11 The group worked in parallel with HTTP 1.1. REST is a coordinated set of constraints which are used during design of software components in a distributed hypermedia, and the design depends on the characteristics of stateless, client-server, cacheable communication using a protocol. World Wide Web uses REST practices and constraints. REST is a simpler alternative for SOAP and Web Services Description Language (WSDL). REST style web resources and Resource-Oriented Architecture (ROA) have increasingly replacing SOAP. \n\n11 https://www.w3.org/2001/sw/wiki/REST \n\nRESTful APIs \n\n108 Internet of Things: Architecture and Design Principles \n\nSOAP Request \n\nSOAP Response \n\nwww.weatherMsoG. \n\ncom/ weatherMsgRequest \n\nwww.weatherService. \n\ncom/ weatherMsgResponse \n\n(a) (d) \n\n<soap:Body> \n\n<msg: GetweatherMsgResponse xmlns: msg=\u201chttp://www. weatherMsgG.com/ weatherMsgRequest\u201d> \n\n<msg:MsgID> weatherMsgID250715 </msg:MsgID> \n\n</soap:Body> \n\n<?xml version=\u201c1.0\u201d?> <soap:Envelope \n\nxmlns:soap=\u201chttp:www.w3.org/ 2001/12/soap-envelope\u201d soap:encodingStyle=\u201chttp://www. w3.org/2001/12/soap-encoding\u201d> \n\n<soap:Header> \u2026 \n\n\u2026 \n\n</soap:Header> \n\n<soap:Body> \n\n<soap:Fault> \u2026 </soap:Fault> </soap:Body> \n\n</soap:Envelope> \n\n(b) \n\nPOST / weatherServiceRequest HTTP/1.1 Host:www. weatherMsgG.com Content-Type: End1/soap+xml; charse t=utf-8 \n\nContent-Length: nnn <?xml version=\u201c1.0\u201d?> <soap:Envelope xmlns:soap=\u201chttp://www.w3. org/2001/12/soap-envelope\u201d soap:encodingStyle=\u201chttp://w ww.w3org/2001/12/soap- encoding\u201d> \n\n(c-1) (e) \n\nHTTP/1.1 200 OK Content-Type: End2/soap+xml;charset=utf-8 Content-Length: nnn <?xml version=\u201c1.0\u201d?> <soap:Envelope xmlns:soap=\u201chttp://www.w3.org/2001/1 2/soap-envelope\u201d soap:encodingStyle=\u201chttp://www.w3.org \n\n/2001/12/soap-encoding\u201d? \n\n<soap:Body xmlns:msg=\u201chttp:/www. weatherService.com/ weatherMsgResponse\u201d? \n\n<msg: GetweatherMsgID250715 ? \n\n<msg: Rains>\u201dExpectedon 250715\u201d</msg:Rains> \n\n</msg:GetweatherMsgResponse> </soap:Body> </soap:Envelope> \n\nFigure 3.8  (a) A SOAP request or response communication between gateway weatherMsgG and \n\nweather service weatherMsgService, (b) SOAP message structure, (c) SOAP POST from weatherMsgG, (d) Request Get weatherMsgG, and (e) SOAP response weatherMsgID250715 at weatherMsgService to weatherMsgG using Internet and HTTP binding \n\nThe architectural properties of REST are realised by applying specific interaction constraints to data elements, components, connectors and objects. An architectural property of REST is separation of concern which means data storage at server is not a concern for the client, and client components can port on other objects. \n\nAlso, user interface and user state are of no concern to the server. REST\u2019s client-server separation of concerns simplifies the component implementation, increases the scalability \n\nREST is a simpler alternative for SOAP \n\nand Web Services Description Language \n\n(WSDL) \n\nDesign Principles for Web Connectivity 109 \n\nof pure server components, reduces the complexity of connector semantics and improves the effectiveness of performance tuning. \n\nThe resources themselves are conceptually separate from the representations that are returned to the client. For example, the server may send data HTML, XML, TLV or JSON from its database which can have other distinct internal representation at a connected database server. \n\nREST software architecture style provisions for the use of specific practices, such as client-server mode of communication and layered system architectural approach. \n\nClient-server interactions have characteristics of performance and creation of scalable web objects and services. Scalability means ability to support greater number of interactions among components and greater number of components. \n\nLayered system refers to  a client which can connect through an intermediate layer (proxy, firewall, gateway, proxy or intermediary server). REST enables intermediate layer processing by constraining the messages such that the interactions at each layer are self- descriptive. A client may not ordinarily be made aware whether it is connected directly to an end-server. Intermediate layers may render assistance in transcoding and enabling usages of different protocols at two ends. Use of the intermediate system improves performance when using bigger scales and shared caches. Shared caches means caches shared between two layers; for example intermediate layer and server or proxy and server. \n\nRepresentation of each application state contains links that may be used for a next-time interaction when the client selects those links and initiates a new state transition. \n\nRESTful \n\nWhen all interactions used in the applications conform fully to the REST constraints then these are called RESTful. RESTful APIs comply with these constraints and thus conform to the REST architectural style. Web services with RESTful APIs adhere to the REST architectural constraints. \n\nREST architectural style can be used for HTTP access by GET, POST, PUT and DELETE methods for resources and building web services. \n\nRESTful HTTP APIs \n\nStandard HTTP methods are GET, PUT, POST and DELETE. HTTP based RESTful APIs use the following: \n\n\u25cfURIs/URLs, such as http://weatherMsgService.com/weatherMsg/ and hypertext links to reference state and reference related resources, and JSON, TLV or an Internet media type (MIME type) hypertext links \n\n\u25cfREST-based web objects communicate typically, but not always, over the HTTP. The World Wide Web itself represents the largest implementation of a system conforming to the REST architectural style. RESTful HTTP system feature is that communication is over the HTTP and use verbs (commands) same as in HTTP, namely GET, POST, PUT and DELETE. \n\n110 Internet of Things: Architecture and Design Principles \n\nRESTful HTTP Verbs \n\nREST interfaces usually involve resource repositories with identifiers. For example, / deviceNetwork/device or /TemperatureApp, which can be operated upon using standard verbs as follows: \n\n\u25cfGET command is to get a list of the URIs for resource repository of the resources and perhaps other details of the members in the repository. GET retrieves a representation of the resource item (means addressed member) of the repository. Representation is expressed in an appropriate Internet media type. \n\n\u25cfPOST command creates a new entry in the resource repository for the resources. The new entry\u2019s URI is assigned automatically and is usually returned by the operation. An option which is not generally used considers the resource item as a repository on its own right and create a new entry in it (not generally used). \n\n\u25cfPUT command which replaces the entire resource repository with another resource repository or replaces the resource item of the repository (or if it does not exist, then create it). \n\n\u25cfDELETE command from client retrieves web objects and sends data to remote servers. \n\n3.4.5 WebSocket \n\nRFC 6455 describes the specifications of the web protocol12. WebSocket is an IETF accepted protocol. WebSocket API (WSAPI) W3C standard is Web Interface Definition Language (Web IDL)13. \n\nInstant messaging and many applications need bidirectional data exchanges over the same connection. WebSocket enables bidirectional communication over a single TCP connection. \n\nFigure 3.9 (a) shows Opcode and other fields at a WebSocket Frame. Figure 3.9 (b) shows WebSocket API provisions for events, attributes and functions. Event means occurrence of new condition, occurrence of which is listened by an event-listener function, and as soon as listening takes place, an event handling function executes. The handling function is also callback action. Figure 3.9 (c) shows data bidirectional communication using WebSocket APIs between the web objects and also the browsers and servers. \n\nThe WebSocket-protocol-based design usage now supersedes the existing bidirectional communication technologies that use HTTP at application layer. WSAPI  attributes are url, protocol, readystate, buffered amount and are extendable. The API functions are send (frame) and close  (socket). A frame contains header plus data. WebSocket frame contains 2 B header extended to 0, 2 or 4 B plus data bytes. Client side adds 4 B mark; for example, for identifying a frame. The WebSockets enable easier usage of existing infrastructure, authentication, filtering and proxies. Number of popular browsers support the protocol. HTTP case polling at periodic intervals are not required due to no-wait feature of WebSocket. \n\n12 www:/tools.ietf.org/html/rfc6455 13 http://www.w3.org/TR/WebIDL/ \n\nBidirectional communication request \n\nusing WebSocket at \n\nclient and obtaining \n\nresponse from WebSocket at server \n\nDesign Principles for Web Connectivity 111 \n\n2-6 Byte (Typical) 2-6 Byte (Typical) \n\n2-6 Byte (Typical) 2-6 Byte (Typical) \n\n(a) (b) (c) \n\nServer Application \n\nWS API \n\nTCP \n\nSASL/TLS \n\nClient Application \n\nWS API \n\nWeb Objects using WebSockets WebSocket \n\nAPI \n\nEvents onopen, onmessage and onerror \n\nAttributes \n\nurl, protocol, readystate, bufferd Amo unt and extensions \n\nFunctions \n\nSend and \n\nClose \n\nopcode and 7-bit length \n\n2Byte \n\nExtended \n\nLength 4/2/0 Byte \n\nMark (at Client) \n\n4 Byte \n\nData n Byte \n\n2-6 Byte (Typical) \n\nWebSocket Frame \n\nFigure 3.9  (a) Opcode and other fields at a WebSocket frame, (b) WebSocket API events, attributes and \n\nfunctions, and (c) Data bidirectional communication using WebSocket between web objects \n\nFeatures of WebSocket are: \n\n\u25cfSmall header size (2B extended to 6 byte and above compared to 100s B and above for an HTTP header which results in high latency \n\n\u25cfNo new connection which will need a new header and thus no new latency period \n\n\u25cfWSAPIs, because of very low connection latencies, facilitate live content and the creation of real-time games. \n\n\u25cfProtocol is an independent TCP-based protocol. Its only relationship to HTTP is that its handshake is interpreted by HTTP servers as an upgrade request. \n\n\u25cfProtocol uses default port 80 for regular WebSocket connections using ws:// and port 443 when using wss:// for WebSocket connections tunnelled over Transport Layer Security (TLS). \n\n\u25cfProtocol is intended to be compatible with HTTP-based server-side software and intermediaries, so that a single port can be used by both HTTP clients talking to that server and WebSocket clients talking to that server. Therefore, WebSocket client\u2019s handshake is an HTTP upgrade request. Response from the server is also as an HTTP upgrade (Example 3.7). \n\n\u25cfProtocol specifies six frame types and leaves ten reserved for future use (version 13). \n\n\u25cfClients and servers exchange the \u2018messages\u2019 after a successful handshake. A WebSocket message does not necessarily correspond to a particular network layer framing. A frame has an associated type.  Each frame belonging to the same message contains the \n\n112 Internet of Things: Architecture and Design Principles \n\nsame type of data.  Six types are (i) textual data (UTF-8) and (ii) binary data (whose interpretation is left up to the application). \n\n\u25cfExtensibility of request-response (client-server) architecture to iq (information through and querying) chat and super chat extensibility to cloud services. \n\n\u25cfSupport from intelligent and business analyst applications and processing through web server or XMPP server and gateway for connecting the device network with the IP network. \n\nReconfirm Your Understanding \n\n\u25cfA communication gateway connects the sender and receiver ends using two different protocols. The gateway can function as a proxy between two ends, such as HTTP-CoAP proxy. \n\n\u25cfWeb objects communicate using HTTP methods, such as POST, GET, PUT, DELETE, SOAP and WebSockets. \n\n\u25cfREST is a software architecture specifying practices and constraints which are used during design of software components in a distributed hypermedia. Designing based on REST depends on the characteristics of stateless, client-server, cacheable communication using a protocol. \n\n\u25cfRESTful means components designed with constraints specified in REST. For example, separation of concerns, use of layered system, defining cache ability or not between client, server and intermediate. \n\n\u25cfWeb objects communicate using WebSockets. Instant messaging and many applications need the bidirectional, very low latency, real time data exchanges over the same (without initiating new) connection. WebSocket enables bidirectional communication over a single TCP connection. \n\nSelf-Assessment Exercise \n\n1. What are the functions of GET, POST, PUT and DELETE? 2. How will a weather service send the weather data probability of rain at a \n\nlocation using HTTP? Using HTTP post message, assume host is iii.jjj.kkk. com/, content type is text and length is 10 B. What can be the possible responses from the other end? 3. How is a SOAP message structured? 4. Assume that an ATM gateway sends requests for the banking service response \n\nand receives the account information from a BankMsgService. How does a SOAP request or response communicate between two applications, viz. one at Gateway ATM_G and other at BankMsgService using two web objects, viz. one at www.ATMG.com and other www.BankService.com? \n\n\u2605 \u2605\u2605 \n\n\u2605 \u2605\u2605\u2605 \n\nDesign Principles for Web Connectivity 113 \n\n5. List the characteristics in interfaces designed using REST. 6. List WebSocket API events, attributes and functions, and the usage of each. 7. Give five examples when you need bidirectional data exchanges over the \n\nsame TCP connection? 8. List the features of a WebSocket. How do these differ from those of HTTP \n\nRequest/Response and HTTP polling? \n\n\u2605 \u2605\u2605 \n\n\u2605 \n\n\u2605\u2605\u2605 \n\nKey Concepts \n\n\u25cfClient \n\n\u25cfCoAP \n\n\u25cfCoAP-MQ \n\n\u25cfCoAP-SMS \n\n\u25cfCommunication gateway \n\n\u25cfContent \n\n\u25cfCoRE \n\n\u25cfDTLS \n\n\u25cfHeader \n\n\u25cfHTTP \n\n\u25cfHypertext \n\n\u25cfInstant messaging \n\n\u25cfLocal area devices network \n\n\u25cfLWM2M protocol \n\n\u25cfMessage broker \n\n\u25cfMessage queue \n\n\u25cfMQTT \n\n\u25cfMulti user chat room \n\n\u25cfObject \n\n\u25cfProxy \n\n\u25cfPublish/subscribe \n\n\u25cfPush/pull \n\n\u25cfRequest/response \n\n\u25cfREST \n\n\u25cfRESTful HTTP \n\n\u25cfResource \n\n\u25cfResource directory \n\n\u25cfResource discovery \n\n\u25cfResource repository \n\n\u25cfRegistration \n\n\u25cfRepresentation \n\n\u25cfROLL \n\n\u25cfServer \n\n\u25cfSMS \n\n\u25cfSOAP \n\n\u25cfState \n\n\u25cfStateless \n\n\u25cfSubscribe/notify \n\n\u25cfSubscription \n\n\u25cfTopic \n\n\u25cfTLS \n\n\u25cfUDP \n\n\u25cfURI/URL \n\n\u25cfWebSocket \n\n\u25cfXML \n\n\u25cfXMPP \n\nLearning Outcomes \n\nLO 3.1 \n\n\u25cfDevices generally have a constraint that they sleep most of the time in low power environment and wake when required (client initiates). Devices may have constraints that their connectivity breaks for long periods, has limited up intervals in lossy environment and limited data in size. \n\n\u25cfIoT/M2M devices connect using the CoAP and LWM2M protocols in the constrained RESTful environment (CoRE) and the data routes over a low power lossy network (ROLL). Client/ server communication uses UDP and DTLS layers. \n\n\u25cfCoRE objects use standard constrained environment protocols for sending a request or response. The CoAP-client and CoAP-server communication takes place over the network and transport layers to the other-end CoAP client and server. An HTTP-CoAP proxy connects an \n\n114 Internet of Things: Architecture and Design Principles \n\nHTTP client with the CoAP object.  A CoAP-HTTP proxy connects a CoAP client with an HTTP object. A CoAP Client/server use the URIs coap://\u2026 HTTP Client/server use the URLs http:// \n\n\u25cfAn LWM2M client has object instances as per the OMA standard. An LWM2M client\u2013server interaction takes place over the access and CoRE networks. \n\nLO 3.2 \n\n\u25cfIoT/M2M objects and applications use the Request/Response, Publish/Subscribe, Subscribe/ Notify, Push or Pull, Polling, Message Queues, Instant Messaging, Presence notification for Multi-User Chat and instant messaging methods for transfer of messages, resources, representations, objects and states. \n\n\u25cfThe APIs for messaging use CoAP-SMS, CoAP-MQ, MQTT and XMPP as the messaging protocols in constrained environment and ROLL network. \n\n\u25cfCoAP-SMS is a protocol when CoAP object uses IP as well as cellular networks and an SMS (Short Message Service). \n\n\u25cfA CoAP client communicates to a mobile-terminal end-point (MT). \n\n\u25cfMQTT is a protocol for the constrained environment PubSub messaging. A Subscriber receives the messages on a subscribed topic. \n\n\u25cfXMPP CoRE, Presence and Address format are IETF recommendations for the XMPP Messages server. The server notify presence to the subscribers/registered clients (users) for the purpose of IMs (instant messaging) to one or many users at the same time. The server enables Instant Messaging (IM), chatting and multi-user chat (MUC) after the creation of a chat room, where different users after subscriptions do IMs. \n\nLO 3.3 \n\n\u25cfAPIs in connected-devices network communicate with the web using the communication gateway, SOAP, REST, RESTful HTTP and Web Sockets. \n\n\u25cfA communication gateway connects the sender and receiver ends and can also function in proxy between the two ends, such as HTTP-CoAP proxy. \n\n\u25cfWeb objects communicate using HTTP methods such as POST, GET, PUT, DELETE, SOAP, and WebSockets are used for web communication. \n\n\u25cfRESTful components provide simplicity and uniformity. The features are separation of concerns, use of layered systems, defining cache ability or not between client, server and an intermediate such as firewall or proxy. \n\n\u25cfAn HTTP connection enables one-way communication at an instance from client the API to a server or from the server to the API. HTTP transfer is stateless. A client polls the resources at the server and finds the changes in their states. When a state exhibits a change then the client retrieves that resource. \n\n\u25cfSOAP is protocol for exchange of objects between applications using XML SOAP body elements. Specifications are in an envelope. \n\n\u25cfWebSockets are used for bidirectional communication and instant messaging and chatting over a single TCP connection. WebSockets use the URIs ws://\u2026 and use the URIs wss://\u2026 when using the TLS. \n\nDesign Principles for Web Connectivity 115 \n\nExercises \n\nObjective Questions \n\nSelect one correct option out of the four in each question. \n\n1. CoRE environment constraints are: (i) data is limited in size around 1000 B, \n\n(ii) web clients and web servers use HTTP (Hyper Text Transfer Protocol), TCP (Transmission Control Protocol) and IP (Internet Protocol), (iii) data routes as in an ROLL network, (iv) devices sleep most of the time, (v) wake when required (client initiates), (vi) connectivity for long periods, (vii) can have long up intervals. (a) (i) and (ii) true (b) All true except (vii) \n\n(c) (i)  to (iv) true (d) (iii) true 2. CoAP features are: \n\n(a) W3C defined CoAP web-objects (b) A specialised web transfer protocol used for CoRE using ROLL network. \n\n(c) Use of object model for resources and each object can have single instance. (d) Object or resource use CoAP-TLS (security binding with RSA and Certificate), \n\nand TCP protocols for sending a request or response. 3. LWM2M specifications and features are as follows: (i) An object or resource use \n\nCoAP, DTLS, TLS, TCP and UDP or SMS protocols for sending a request or response, (ii) use of plain text for a resource or use of JSON (Java Script Object Notation) during a single data transfer  or binary TLV format data transfer for a package for a batch of resource-representations in a single data transfer, (iii) objects or its resource access using URLs or file names, (iv) use of object model for resources and each object can have single instance, (v) LWM2M client-server interactions are over the access and CoRE networks which generally use CoAP over ROLL, and (vi ) M2M management functions can be MSBF (M2M Service Bootstrap Function) for credentials of the devices and gateway, and MAS (M2M Authentication Server) for security, root key data store and device and data authentication. (a) (i), (iii), (iv) not true (b) All true \n\n(c) Only (v) and (vi) true (d) All true except (ii) 4. CoAP-SMS protocol specifies as follows: \n\n(i) Computer or machine interface using IP receiving request or sending response as \n\nCoAP data to a mobile service provider using SMPP for data interchange. (ii) The SMS-C communicates that to MO using SS7. SMS-SP receives request or \n\nsends response to machine or IoT device or mobile origin. (iii) Computer or machine interface using IP receiving request or sending response as \n\nHTTP request to a mobile service provider using CIMD for data interchange. \n\n\u2605 \n\n\u2605 \n\n\u2605\u2605 \n\n\u2605\u2605 \n\n116 Internet of Things: Architecture and Design Principles \n\n(iv) The SMS-C communicates that to Mo using CIMP or SMPP. SMS-SP receives \n\nrequest or sends response to machine or IoT device or mobile origin. (a)  (i) not true (b)  (ii) not true \n\n(c)  (iii) not true (d) All true 5. CoAP-MQ Broker (MQ) does the following: (i) functions as a server node capable of \n\nstoring messages to and from other nodes, (ii) performs a store, compact, re-format and forward function between web clients and the CoAP-MQ capable endpoints, (iii) matches subscriptions and publications in order to route messages to right endpoints, (iv) does not send state of an endpoint when endpoint or a web client subscribes to the state of the endpoint, (v) enables the web client publishing of updates to the endpoint state through the MQ, (vi) returns the last published value to web clients or other endpoints on behalf of endpoints that are sleeping, and (vii) acts as a firewall. (a) (i) to (v) true (b) (ii), (iv) and (vii) not true \n\n(c)  All true (d) Only (vii) not true 6. MQTT features are as follows: (i) M2Mqtt library set of functions for coding in \n\nvisual C++ need just 100 kB and in Java just 30 kB, (ii) permits maximum number of exchanges, (iii) broker-based subscribe/notify messaging protocol, (iv) don\u2019t notify on an abnormal disconnection of a client, (v) does not have specifications for the final action to be taken on failure to send messages, (vi) UDP connectivity for the basic network, (vii) synchronous communication for real-time messaging at regular intervals. (a) All true (b) All true except (iv) and  (v) \n\n(c) None true (d) (i) and (vii) not true 7. XMPP-IoT server: (i) consists of xeps and services, (ii) extensible to publisher- \n\nsubscriber, (iii) does not support multi-user chat, (iii) supports devices and connected devices area network, (iv) support through a gateway between connected devices and IP networks communicates with XMPP APIs in web objects, (v) support SASL and TLS security protocols for the APIs and web object messages using TCP, (vi) HTML request/response, (vii) XML streams in XMPP format communicates. (a) All are true (b) (iii) and (vi) not true \n\n(c) (iii) and (v) not true (d) (iii) not true 8. Gateway does one or more actions as followings: (i) CoAP protocol conversion for \n\nRESTful HTTP client, (ii) HTTP-CoAP proxy, (iii) provisions RESTful interfaces between client and server, (iv) connectivity between ZigBee devices and IP \n\n\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605\u2605 \n\nDesign Principles for Web Connectivity 117 \n\nnetwork, (v) forwarding of HTTP requests/responses, (vi) functions as firewall, and (vii) connects WebSockets. (a) (i) to (v) true (b) (ii) and  (vi) not true \n\n(c) (iii), (v) to (vii) not true (d) (i) to (v) and (vii) true 9. (i) SOAP message structure has the following tags: envelope, encoding style, header, \n\nbody and fault (ii) dot net support SOAP for internet application development SOAP, (iii) object exchange could be through HTTP request/response when HTTP binding specified, and (iv) SOAP support the REST-style web resources. (a) All except (iv) true (b) Encoding style and fault tags not present \n\n(c) (ii) not true (d) (iii) not true 10. Simplicity of REST interfaces is because of: (i) modifiability of components, \n\n(ii) visibility of communication between components by service agents, (iii) portability of components by moving the objects, (iv) reliability, (v) scalability, and (vi) separation of concerns between interacting components. (a) Only (v) true (b) All except (iii) true \n\n(c) All except (i) and (ii) true (d) All except (vi) true 11. HTTP objects can transfer both ways at the same instant using (i) polling, \n\n(ii) Multiple TCP connection, (iii) HTTP requests at short regular intervals so that responses are nearly in real time, (iv) polling at successive intervals, (v) HTTP long polling means API sends a request to the server, server keeps the request open for a set period, and (vi) stream hidden in iframe. (a) All except (i) true (b) All except (i) and (iv) true \n\n(c)  cannot transfer simultaneously (d) All except (i) and (vi),  and (vi) true 12. WebSocket can include at a higher sublayer, the: (i) XMPP web object APIs, (ii) XMPP \n\nserver and gateway for connecting device network with IP network, (iii) can extend messaging and presence protocol, (iv) can include JMS (Java Message Service) for messaging and PubSub messaging, (v) FTP (File Transfer Protocol) for file transfer, (vi) other protocols supported at the client and server, (vii) extensibility of request- response (client-server) architecture to iq (Information through querying), (viii) chat, (ix) super chat, (x) extensibility to cloud services, (xi) support from intelligent and business analyst applications, and (xii) support from business processing (a) All true (b) All except (v), (vi) and (x) true \n\n(c) All except (x) to (xii) true (d) All except (i), (ii), (x) to (xii)  true \n\n\u2605\u2605 \n\n\u2605 \n\n\u2605\u2605 \n\n\u2605\u2605\u2605 \n\n118 Internet of Things: Architecture and Design Principles \n\nShort-Answer Questions \n\n1. What does constrained environment mean for IoT/M2M? [LO 3.1] 2. What are the features of REST architectural style? [LO 3.1] 3. How will a CoAP client send a request to an HTTP server using intermediate \n\ncomponents? [LO 3.1] 4. What are the additional features in LWM2M over CoAP? [LO 3.1] 5. Show diagrammatically how a device sends an SMS to a mobile terminal and how a \n\nmobile origin sends a message to an actuator device. [LO 3.2] 6. List the features of MQTT. [LO 3.2] 7. How do the connected devices connect to server-end functions in IoT for business \n\nprocesses? [LO 3.2] 8. Specify functions of CoAP, RESTful HTTP, MQTT and XMPP (Extensible Messaging \n\nand Presence Protocol) in IoT apps. [LO 3.2] 9. What are the protocols needed in web connectivity in IoT applications? [LO 3.2] 10. How do the actions of PSK, RPK and certification protocols compare? [LO 3.2] 11. How does XMPP-IoT apply in IoT applications? [LO 3.2] 12. What are the functions of a communication gateway? [LO 3.2] 13. Compare the use of an HTTP request response and a SOAP object transfer. [LO 3.2] \n\n14. How can an HTTP request/response be used for bidirectional data transfers? [LO 3.3] 15. What are features in WebSocket that enable extensibility to cloud services, support \n\nfrom intelligent and business analyst applications, and support from business processing? [LO 3.3] \n\nReview Questions \n\n1. Why do constrained environment and data ROLL network need a distinct set of \n\nprotocols? [LO 3.1] 2. Show diagrammatically and explain the communication gateway and proxies \n\nbetween CoAP objects and web applications. [LO 3.1] 3. Show diagrammatically and explain the features of LWM2M. [LO 3.1] 4. Show diagrammatically and explain the SMS communication between MO and CoAP \n\nobject, CoAP object and MT, CoAP object and Mobile service provider. [LO3.1] 5. Show by a diagram the object exchanges between devices, CoAP-MQ Broker and \n\nweb applications. [LO 3.2] 6. Draw message exchanges between devices, MQTT broker and web applications. \n\n[LO 3.2] 7. Explain REST architectural style of coding for client/server interactions. [LO 3.3] 8. What are the applications of SOAP? How does the SOAP message code and sent? \n\n[LO 3.3] 9. Describe the features of object exchanges using HTTP request/response and \n\nWebSockets. [LO 3.3] \n\nPractice Exercises \n\n1. List the protocols behind M2M communication with applications and service \n\ncapabilities. [LO 3.1] 2. Explain when CoAP-MQ and MQTT are used. [LO 3.1] \n\n\u2605 \u2605\u2605 \u2605\u2605\u2605 \n\n\u2605\u2605 \u2605\u2605 \n\n\u2605 \u2605\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605 \u2605\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605 \u2605\u2605 \n\n\u2605 \u2605\u2605\u2605 \n\n\u2605 \n\n\u2605\u2605 \n\n\u2605\u2605 \u2605\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605\u2605\u2605 \n\n\u2605 \n\n\u2605\u2605 \n\n\u2605 \n\n\u2605\u2605 \n\nDesign Principles for Web Connectivity 119 \n\n3. Draw an architectural view of IDs data transfer for web applications in Internet of \n\nRFIDs (Example 2.2). [LO 3.1] 4. Recall Example 1.1. Draw an architectural view of data exchanges between the \n\numbrella, web service for forecasting of rain and hot sunny days and mobile. \n\n[LO 3.2] 5. How is XMPP used for IoT applications? [LO 3.2] 6. How is HTTP POST method used for publishing weather service data? [LO 3.3] 7. Develop an architecture for bidirectional data exchanges between the CoAP client \n\nand WebSocket. [LO 3.3] \n\n\u2605\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605 \u2605\u2605\u2605 \n\n",
  "createdAt": "2026-02-17"
}