{
  "title": "4",
  "slug": "iot2-4",
  "description": "Module from iot2.pdf: 4",
  "tags": [
    "iot2",
    "Elite"
  ],
  "content": "# 4\n\nInternet Connectivity \n\nPrinciples \n\nLearning Objectives \n\nLO 4.1 Explain Internet-connectivity protocols\u2014IP, IPv6, RPL, 6LoWPAN, TCP/IP suite, TCP and UDP LO 4.2 Describe the functions of IP address, MAC address, DNS and DHCP LO 4.3 Explain the functions of application layer protocols\u2014HTTP, HTTPS, FTP, Telnet and Ports \n\nRecall from Previous Chapters \n\nWe learnt about conceptual framework, reference model and reference architecture in Sections 1.1 and 1.2 in Chapter 1. \n\nEquation 1.2 suggested that data gathers from the devices, enriches at the data adaptation stage and the enriched data-stream transfers to manage that at higher stages of data analysis the streaming process uses Internet connectivity. \n\nEquation 1.3 suggested that data gathers from the devices and consolidates at the data adaptation stage. Then a gateway connects through Internet to the server and other stages where data of the stream collects, assembles, manages and analyses. \n\nWe learnt that architecture of IoT/M2M has network and transport layers for data streaming to server, application or other entities. We learnt about IoT architecture layered model, in which application layer is highest and physical cum data-link layer is the lowest (Figure 2.1). Thus, data receives at a layeri from previous layerj (i > j), when it receives at applications and services layer from the physical cum data-link layer (Section 2.1). \n\nInternet Connectivity Principles 121 \n\n4.1 INTRODUCTION \n\nInternet is a global network with a set of connectivity protocols for: \n\n\u25cfConnected devices gateway for sending the data frames of the devices or to the devices. The data communicate over the network as packets, which communicate through a set of routers at the Internet. The processes manage, acquire, organise and analyse the data of the IoT devices for applications, services and business processes. \n\n\u25cfThe devices perform the controlling and monitoring functions using the messages, data-stacks and commands sent through the Internet by the applications, services or business processes. Following are some of the key terms and their meanings, which are required for understanding Internet connectivity principles for communication between connected devices network and IoT applications. \n\nHeader refers to words, which are required for processing a received data stack at a layer and which envelopes the data stack of the preceding upper layer before transfer to the succeeding lower layer. Header consists of header fields. Each word has 32 bits. Each header word can have one or more fields. The fields in the words are as per the processing required at succeeding stages up to the destination. \n\nIP header refers to header fields, which comprise parameters and their encodings as per the IP protocol. IP is Internet layer protocol at the source or destination. \n\nTCP header denotes header fields containing parameters whose encoding is as per the TCP protocol. TCP is transport layer protocol at the source or destination. \n\nProtocol Data Unit (PDU) is the unit of data stack maximum number of bytes, which can be processed at a layer as per the protocol at a layer or sublayer. \n\nTCP stream is a sequence of bytes or words in the data stack created at the transport layer that transmits to the destination-end transport layer. \n\nWe learnt that connected devices data from gateway use the network and transport protocols for connecting to the subsystems where data of the stream collects, assembles, manages and analyses, and where the applications execute and provide the services. (Section 2.2). An important aspect is that Internet connectivity is the key architectural element between the applications and devices. \n\nWe learnt in Chapter 3 that Internet connectivity is a basic need from the device-end to applications or services-end. The connecting entities use the WPAN protocols for personnel area network, and Internet protocols for connectivity with the applications or services. Client- server, pub/sub and other communication modes use the IP protocol at network layer, and TCP or UDP at the transport layer, TLS or DTLS for secure connection, and HTTP, WebSocket and other application-layer protocols for applications support. \n\n122 Internet of Things: Architecture and Design Principles \n\nMaximum Transferable Unit (MTU) is the unit of data-stack maximum number of bytes, which can be transferred from a higher layer to lower layer or physical network. \n\nPacket is a set of bytes with a fixed maximum specified size that transfers from network layer and communicates from one router to another, until it reaches at physical, data-link and network layer at the receiver\u2019s end. Internet technology provisions for packetising the received data stack at Internet layer for transmission to the next lower layer. Receiving-end Internet layer does de-packetising (unpacking) at the layer for sending it to the succeeding transport layer. \n\nIP packet is a data stack, which includes IP header. It communicates from a source IP address through the routers to the destination IP address. \n\nData segment refers to data stack from application-support layer for transport. Application data is divided into the segments when its size is more than the transportable limit. \n\nNetwork interface is a system software component or hardware for facilitating communication between two protocol layers/computers/nodes in a network. The interface software-component provides standard functions. For example, connection establishment, closing and message passing. Network interface examples are port (software or hardware component), network interface device and socket. An interface can be addressed by a unique port number/socket name/node id. \n\nPort is an interface to the network using a protocol that sends an application layer data stack to the lower layer for transmission. The port receives the data stack at the receiver\u2019s end from the lower layer. Each port uses an assigned number according to a protocol, which is used for transmission or reception at the application layer. For example, Port 80 is assigned number to HTTP, an application layer protocol. \n\nSocket is a software interface to the network that links to data stack using a port protocol and an IP address. Internet data can be considered as communicating between the sockets. Application data can be considered to flow between the sockets at sender and receiver. \n\nHost is a device or node that connects to a network of computers. It provides information, resources, services and applications to the other nodes on the network. A network layer assigns a host address to each host. \n\nIP host is the one that uses the Internet protocol suite. An IP host has one or more IP addresses for the network interfaces. \n\nSubnet is a subnetwork, which is logical and visible subdivision of an IP network. Subdivision enables addressing a set of networked computers in the subnet using a common and identical IP address. For example, an organisation has 1024 computers but uses a common and identical IP address(es). An IP address consists of two groups: msbs and lsbs, total 32-bits; msbs means most significant bits in a word, while lsbs means least significant bits in a set of bits. \n\n\n![Image](/src/assets/generated_images/iot2_p149_i0.png)\n\nInternet Connectivity Principles 123 \n\nRouting Prefix: Thirty-two bits IP address can be divided into the msbs consisting of 8, 16 or 24 bits and remaining lsbs. The division results in the logical division of an IP address into two fields\u2014a network address or routing prefix field and a rest field or host identifier. The rest field is an identifier for a specific host or network interface.1 \n\nHost Identifier: The rest field may also have two sub-fields\u2014one for subnet id and other for the host identifier. When a network subdivides into subnets and subnet has a number of hosts. \n\nData Flow Graph (DFG) denotes a graphical representation using arrows from one stage to another. A circle represents a stage and arrow characterises the direction of flow of data. Inputs (for example, incoming data for routing) at each stage compute (process) and cause the outputs from the stage. Inputs at the beginning of a circle continue to flow to the next circle, until the outputs (for example, outgoing data for routing) reach at the end of the circle. Data can be said to flow from beginning to end after being processed in the multiple stages in-between. \n\nAcyclic Data Flow Graph (ADFG) refers to a DFG where only one set of inputs generate only one set of outputs for the given input-set in the DFG model. All inputs are instantaneously available in APDFG, (no delay between various inputs) at each stage, except the processing interval at the stage. Examples of non-acyclic data input are an event input, a status-flag set (= 1) or reset (= 0) in a device, and input as per output condition of the previous process. \n\nDirected Acyclic Graph (DAG) means an ADFG in which none of the output cycles back to a previous processing stage or level or rank as an input during data flow. \n\nFollowing sections describe Internet-connectivity principles for connected devices. For details of the protocols, their usages and implementation, the reader can refer to any standard book on computer network or internet and web technology. \n\n4.2 INTERNET CONNECTIVITY \n\nFigure 4.1 shows a source-end network-layer connected to the destination through a set of IP routers. It also shows that a communication framework uses an IP address and communicates with the IoT/M2M IoT application and services layer using TCP/IP suite of application protocols to a destination IP address. \n\nInternet connectivity is through a set of routers in a global network of routers which carry data packets as per IP protocol from a source end to another and vice versa. A source sends data packets to a destination using IETF standardised formats. \n\n1 https://www.ietf.org/rfc/rfc7608.txt.pdf \n\nExplain Internet- \n\nconnectivity protocols\u2014IP, IPv6, RPL, 6LoWPAN, TCP/ IP suite, TCP and UDP \n\nLO 4.1 \n\n124 Internet of Things: Architecture and Design Principles \n\nApplication \n\nSmart Sensor \n\nFramework \n\nIoT Communication \n\nFramework \n\nApplication Framework \n\nIoT Communication \n\nFramework \n\nGateway \n\nData Consolidation \n\nFramework \n\nIoT Communication \n\nFramework \n\nSet of IP \n\nrouters \n\nSet of IP \n\nRouters \n\nSet of IP \n\nRouters \n\nSet of IP \n\nRouters \n\nIoT Application Layer TCP/IP Application Protocols \n\nTransport Layer TCP/IP \n\nNetwork Layer \n\nData-link Layer \n\nPhysical Layer \n\nSensor \n\nNetwork \n\nSource-end IP Address \n\nDestination End IP Address \n\nSource End IP Address \n\nFigure 4.1  Source-end network-layer connected through a set of IP routers for data packets from an IP \n\naddress and communicating with IoT/M2M IoT application and services layer using TCP/IP suite of application protocols \n\n4.3 INTERNET-BASED COMMUNICATION \n\nWhen data transmits from layeri to the next layerj, following are the actions that occur: \n\n\u25cfEach layer\u2019s processing of data is as per the protocol used for communication by that layer. \n\n\u25cfEach layer sends the data stack received from the previous upper layer plus a new header, and thus creates a fresh stack after performing the actions specified at that layer. \n\n\u25cfLayerj will specify new parameters as per protocol and create fresh stack for the subsequent lower layer. \n\n\u25cfThe process continues until data communicates over the complete network. Remember that IoT application layer is the highest in the modified OSI model and the physical layer is the lowest (Figure 2.1). Thus, data transmits from layeri to the next layerj, (i > j) when it transmits from the application layer to the physical layer. \n\nWhen data is received at the next layeri from a layerj, i.e. IoT device physical layer to the IoT application, the following actions are performed: \n\n\u25cfEach layer performs the processing as per the header field bits, which are received according to the protocol to be used for decoding the fields for the required actions at that layer. \n\nInternet Connectivity Principles 125 \n\n\u25cfEach layer receives the data stack from the previous lower layer and after the required actions, it subtracts the header words and creates a new stack specified for the next higher  layer. \n\n\u25cfThe process continues until the data is received at the port on the highest application layer. Upper layers use the header words alone. Lower layer, such as data-link layer protocol, such as Ethernet 802.3, provisions for the trailing bits also, in addition to the header words. Trailing-bits usage can be as error-control bits and end-of-the frame indicating bits. Note: Ethernet frame communicates between the data-link layers of two computers on a local area network (LAN). 802.3 specifies the maximum frame size of 1518 B (later increased to 1522 B) and consists of 32 trailing bits. These are called Frame Sequence Check (FRC) bits or Cyclic Redundancy Check (CRC) bits. CRC bits append during transmission. The receiving-end recalculates the CRC from the received data bits. If both of these match, then the frame in the sequence is accepted, else an error is reported. \n\nOnly four OSI model layers, such as 7, 4, 3 and 2 are specified at the TCP/IP protocol suite for Internet communication. Layer 1 is per communication protocol for physical link to routers. Figure 4.2 shows the communication between the source and destination. Internet-based TCP/IP communication uses application layer L7, transport L4, Internet L3 and link L2 layers. Figure 4.2 shows the PDUs at the layers. \n\nPort for Data from or to Application Layer L7 \n\nL7 Header L7 Data Segment \n\nData Stack from L7 or to L7 \n\nUDP Header + \n\nDatagram L4 TCP \n\nL3 Header \n\nHeader Data for TCP Stream \n\nData Stack from L4 or to L4 \n\nL3 IP Packet for the Network \n\nL2Header Data Stack from L3 L2 Trailing Bits \n\nData Stack from L2 (Link Layer) or to L2 \n\nPhysical Layer L1 Layer \n\nPDU = 1518 B \n\nfor Applications and Services \n\nPDU\u2013 232 B \n\nPDU\u2013 216 B \n\nFigure 4.2  TCI/IP suite four layers generating data stack for the network and for physical layer during \n\nInternet communication \n\n126 Internet of Things: Architecture and Design Principles \n\nA data segment (maximum 232 B per segment) is accepted from L7 layer for transport layer TCP. L4 then generates a TCP stream. The stream packetizes at the Internet layer L3. Alternatively, a datagram (maximum 214 B) is accepted from L7 layer for transport layer UDP usage. L4 then generates a UDP datagram (maximum 216B). The stream packetises at the Internet layer L3 into packets. Packet sent from L3 has maximum size 216B including L3 header. The datagram sent from L3 also has maximum size 216B. \n\nInternet layer uses the IP protocol (IPv4 or IPv6 or RPL). Packet routing occurs as: Each router has information about the path to the destination. When a number of paths are available, then the number of packets of the same source simultaneously follows different paths from a router. Destination-end transport layer reassembles the packet according to their sequences in the source transport layer data streams. Then the reassembled data segment transfers to IoT application layer at the destination end. \n\nThe data-link layer uses a protocol each in its sublayers. For example, Ethernet IEEE 802.3, MAC, PPP, ARP, RARP, NDP etc. Ethernet is protocol for logical-link layer on a LAN; MAC stands for Media Access Control; PPP stands for Point-to-Point Protocol; ARP stands for Address Resolution Protocol; RARP stands for Reverse Address Resolution Protocol. Resolution means using network data stack to find the MAC address. Reverse means MAC address used for finding IP address. NDP stands for Network Discovery Protocol. \n\nThe next subsections describe the features in IPv4, IPv6 and RPL. \n\n4.3.1 Internet Protocols \n\nInternet layer receives and forwards data to the next layer using IP version 4 (IPv4) or IP version 6 (IPv6) protocol. \n\nInternet Protocol Version 4 \n\nLet n = total number of header words. Figure 4.3 shows data stack received or transmitted at or to network layer and IP packet consists of IP header fields of n words (= 160 bits and extended header option words). The extension is done when required actions and using data stack from or for the transport layer. \n\nInternet layer protocol is abbreviated as IP and refers to the process when a packet transmits data. The transmission is unacknowledged data flow. IP packet segment consists of the data which the Internet layer receives on transfer from the transport layer to the receiver\u2019s end, when using the IP protocol. Protocol data unit, PDUIP = 1 packet and has maximum 216 B. PDUIP is the maximum data unit which can transmit or receive at the layer when using IP packets. \n\nFigure 4.3 shows an IP data stack which includes the IP header fields. The figure shows the start and end bit numbers in each word and data. The figure shows the data stack received or transmitted at or to the Internet layer. The IP packet consists of IP header fields 160 bits and the extended header consists of (n \u2013 5) words when required, plus data stack of len words from or for the transport layer. \n\nInternet Connectivity Principles 127 \n\n31 16 len [IP Packet length \n\nwords] \n\n15 8 Service Type and \n\nPrecedence \n\n7 4 Service Type and \n\nPrecedence \n\n3 0 IP Version \n\n63 51 Fragment Offset \n\n50 47 Flags \n\n46 32 First Byte Sequence Number in the Stream \n\n95 80 Check Sum \n\n79 72 Type of Protocol \n\n71 64 TTL (Time to Live) 127 96 Source IP Address \n\n159 128 Destination IP Address \n\nq 160 Option header words and fields plus the words as padding before the data \n\nv q \n\nData Stack of = [ \u2013 )/32] words V v q \n\nData Packet (stack) from or to Transport Layer (Maximum Size 2 B 14 words 16 \n\nHeader \n\nPacket Length len = \n\n/32 words v \n\nExtended Header \n\nq n n \n\nv n \n\n= (32 \u2013 1), [ is number of words = 5 words for header plus options plus padding words for extension. Maximum = (214 \u2013 ) 32 \u2013 1 \n\n\u00a5 \n\n\u00a5 \n\nFigure 4.3  Data stack received or transmitted at or to network layer and IP packet consists of IP header \n\nfield 160 bits and extended header up to bit q (extended when required) plus data stack from or for the transport layer \n\nThe features of IPv4 are: \n\n\u25cfIP header consists of five words. The header can extend when using option and padding words. Data stack to the network layer has maximum v = (n + len) words where v <= (214 \u2013 n). \n\n\u25cfHeader first, second and third word fields are as shown in the figure (meaning of header fields in the first three words and option words are not given here and the reader can refer to the author\u2019s Internet and Web Technology book). \n\n\u25cfHeader fourth and fifth words are source IP address and destination IP address. \n\n\u25cfIP protocol transport is half duplex unacknowledged data flow from Internet layer at one end (End 1) to internet layer of other end (End 2). \n\n\u25cfEach IP layer data stack is called IP packet and this packet is not guaranteed to reach the destination when the transport layer protocol is UDP, and guaranteed to reach the destination when the transport layer protocol is TCP. \n\n\u25cfOne packet communicates in one direction at an instance. \n\n128 Internet of Things: Architecture and Design Principles \n\nInternet Protocol Version 6 \n\nInternet Protocol Version 6 is a protocol with the following features: \n\n\u25cfProvisions a larger addressing space \n\n\u25cfPermits hierarchical address allocation, and thus route aggregation across the Internet, and limit the expansion of routing tables \n\n\u25cfProvisions additional optimisation for the delivery of services using routers, subnets and interfaces \n\n\u25cfManages device mobility, security and configuration aspects \n\n\u25cfExpanded and simple use of multicast addressing \n\n\u25cfProvisions jumbo grams (big size datagram) \n\n\u25cfExtensibility of options While an IPv4 address is of size 32-bit, the IPv6 address has a size of 128 bits.2 Therefore, IPv6 has a vastly enlarged address space compared to IPv4. The IPv6 address provides a numerical label. It identifies a network interface of a node or other network nodes and subnets participating in IPv6 Internet. A device is the node in the network when it communicates on a network. \n\nRPL [IPv6 Routing Protocol for Low Power Lossy Networks (LLNs)] \n\nLow Power Lossy Network refers to a constrained nodes network, which has low data transfer rate relative to IP, a low packet delivery-rate and unstable links. IETF has given specifications for RPL for the ROLL network. RPL is a non-storing routing mode. \n\nIoT/M2M low power lossy environment uses RPL protocol. Internet layer IPv6 receives and transmits from/to data-adaptation layer (Figure 2.1) when using IEEE 802.15.4 WPAN devices (Figure 2.5). \n\nLow power nodes need to confine communication to the nearest (or at most next) levels upwards or downwards. Lossy environment needs disjoint nodes, as in case of error or no acknowledgment, a repeat transmission can be made using the same previous instance. Data communicate with optimum data size at an instance. \n\nData flow between the nodes is as per Destination Oriented Directed Acyclic Graph (DODAG) model. Directed acyclic graph is a data flow model between the nodes. Destination orientation means either upwards (for transport) or downward directed (for device-layer end-node) in a tree-like structure of DODAGs. The following example clarifies the DODAG data flow approach for RPL. \n\nExample 4.1 \n\nProblem (a) Give an example of the DODAG data-flow approach for RPL assuming routing nodes at four ranks (levels) 0, 1, 2 and 3 consisting of 3, 6, 3 and 6 nodes, respectively. The node communicates in the RPL network environment. (b) How do the paths (called RPL instances) establish for DODAG data flow? (c) List the DODAG characteristics taking the nodes assumed in the example. \n\n2 http://www.webopedia.com/DidYouKnow/Internet/ipv6_ipv4_difference.html \n\nInternet Connectivity Principles 129 \n\nSolution \n\n(a) An access point can be root of a tree, which enables DODAG data flow for the RPL network. Assume \n\nthat: \n\n\u25cfA0 is the root node at rank 0. A1 and A2 are other nodes at rank 0. \n\n\u25cfB01 and B02 are A0\u2019s child nodes at rank 1 that have upward connectivity to rank 0 and downward connectivity to rank 2 nodes. \n\n\u25cfC21, C22 and C23 are three nodes at rank 2 that have upward connectivity to B\u2019s at rank 1 and downward connectivity to 3. \n\n\u25cfD211 and D212 are C21\u2019s child nodes at rank 3. D221 and D222 are the C22\u2019s child nodes. D231 and D232 are the C23\u2019s child nodes. Figure 4.4 shows RPL network nodes at four ranks, and RPL data-flow instances for upward and \n\ndownward flow. \n\nA0 \n\nB01 \n\nA2 \n\nC21 \n\nD211 \n\nA1 \n\nB11 \n\nC22 \n\nB12 Rank 1 \n\nRank 0 \n\nB21 \n\nC23 \n\nB22 \n\nD231 D232 D212 \n\nB02 \n\nD221 D222 Rank 3 \n\nRank 2 \n\nFigure 4.4  RPL network nodes at four ranks and RPL data-flow instances for upward and downward \n\nflow \n\nRanks 0, 1, 2 and 3 thus have 1, 2, 3 or 6 nodes communicating in the network. Consider that devices \n\nare at rank 3 and destination access point is at rank 0. DOADG in RPL specifies that all data flow is upward directed and will be from a rank 3 node to a rank 2 node, a rank 2 node to a rank 1 node, and a rank 1 node to the destination node rank 0. Data flow upwards can also be from a rank 3 node to a rank 1 node in case sufficient power is present at the node D211. \n\nSimilarly, all data flow downwards will be from a rank 0 node to a rank 1 node, a rank 1 node to a rank \n\n2 node and a rank 2 node to the destination node, rank 3. Data flow downwards can also be from a rank i node to a rank i + 2 node in case sufficient power is present, where i is an integer greater or equal to 0, and i + 2 maximum value can be j, if leaf nodes (end nodes) are rank j. \n\n(b) Paths (called RPL instances) establish using the Directed Acyclic Graph (DAG) Information Option \n\n(DIO) messages. The messages are broadcast to seek new connectivity instance, called RPL instance. Each node selects a parent. This is based on the received DIO messages. Each node calculates its rank in the tree. \n\nSuppose rank 0 node, A0 broadcast the DIO to find a possible node with which it can connect and \n\ncommunicate. Assume two rank 1 nodes, B01 and B02 respond. Other nodes at rank 1 may not respond due to insufficient power. Other nodes at rank 2 may also not respond due to the need of higher power, which may not be there in the DIOs. \n\n130 Internet of Things: Architecture and Design Principles \n\nAssume rank 2 node, C011 also responds to B01, C012 also responds to B01, and then the downward \n\npaths A0-B01-C011, A0-B02-C012 establish, and upward path builds which forms the tree. DIOs includes a node\u2019s rank (its level) and enable the tree-like structure of RPL nodes and also establishes RPL instances at a given instance. \n\n(c) DODAG characteristics are thus: \n\n\u25cfDODAGS are disjoint (no shared nodes) \n\n\u25cfMany-to-one communication: Upwards, where nodes at rank k can communicate to one node m at lower or higher in rank, where k < m \n\n\u25cfOne-to-many communication: Downwards, where nodes at rank m can communicate to one node m at lower or higher in rank, where k  > m \n\n\u25cfPoint-to-point communication: Upwards or downwards where a node at rank m communicates with another node at rank k, where m < k or m > k \n\n\u25cfRPL instances create with objective of optimisation \n\n\u25cfMultiple RPL instances with different optimisation objectives can coexist \n\n\u25cfRoot node or parent node need not use RPL instances to next to next ranks by keeping power level just sufficient to communicate with the nearest rank nodes. DODAG thus minimises the cost to the root per objective function. \n\nThe data flow directs downwards in an RPL instance from root at transport layer to child nodes and from child node to leaf node at physical layer device node. The data flow directs upwards in an RPL instance from a leaf/child node to another child node and then to the root. DODAGs are no share nodes (disjoint). \n\nThe features of RPL are: \n\n\u25cfA routing protocol for the LLNs \n\n\u25cfRPL-controlled messages are Destination Advertisement Object (DAO), DODAG Information Object (DIO) and DAG Information Object (DIO) \n\n\u25cfTransfers data at an RPL instance data point to point (one device nodes to one receiver node) as well as point to multipoint (one to many device nodes) or multipoint to point (many device nodes to one receiver node) \n\n\u25cfSends or receives multiple DODAGs at each  instance \n\n\u25cfSends data from DODAGs to DODAG root or DODAG leaves to support low data transfer rate, compared to IP low packet delivery rate \n\n\u25cfSupports unstable links \n\n\u25cfHas optimisation objective for an RPL instance \n\n\u25cfSupports coexistence of different optimisation objectives using multiple RPL instances \n\n\u25cfSupports nodes, inform parents of their presence and reach ability to descendants using DIOs \n\n\u25cfSupports soliciting (seeking) information of a DODAG using DIS \n\n\u25cfSupports destination, inform nodes for discovery of an RPL instance, know about configuration parameters and select DODAG parents using DIOs \n\nInternet Connectivity Principles 131 \n\n4.3.2 6LoWPAN \n\nInternet layer IPv6 receives and transmits from/to adaptation layer (Figure 4.1). The data stack uses 6LoWPAN (IPv6 Over Low Power Wireless Personal Area Network) protocol at adaptation layer before the data stack transmits to IPv6 Internet layer. An IEEE 802.15.4 WPAN device has a 6LowPAN interface serial port for connectivity. \n\n6LoWPAN is an adaptation-layer protocol for the IEEE 802.15.4 network devices. The devices are the nodes having low speed and low power. They are the WPAN nodes of a multiple device mesh network. \n\nLow-power devices need to limit data size per instance. Data compression reduces data size. Fragmentation of data also reduces data size per instance. Features of 6LoWPAN are header compression, fragmentation and reassembly. When data is fragmented before communication, the first fragment header has 27 bits which includes the datagram size (11 bits) and a datagram tag (16 bits). Subsequent fragments have header 8 bits which include the datagram size, datagram tag and the offset. Fragments reassembly time limit can be set equal to 60s. \n\nFigure 4.5 (a) shows networked i devices physical layer in IEEE 802.15.4 WPAN. Figure 4.5 (b) shows data-link sublayer and adaptation layer 6LoWPAN protocol. \n\nIEEE 802.15.4 Device Node Frame 127 B \n\nIPv6 Header 40 B \n\nUDP Header 8 B \n\nIEEE 802.15.4 Device \n\nSecurity 21B \n\nMAC Header 25 B \n\nApp Data 33B \n\nReassembly \n\nIPv6 Link Layer MTU 1280 B \n\nFragmentation \n\n[Bytes for and from Network Layer] \n\n127 B \n\n94 B \n\nPhysical/Data-link Layer Adaptation Layer 6LoWPAN Protocol \n\n(a) (b) \n\n10s of Bytes of Device App data \n\nDevice 1 \n\nDevice 2 \n\n......... \n\n......... \n\nDevice ( \u2013 1) i \n\nDevice i \n\nMax. 33 Bytes App Data at Single Data Transfer \n\nFigure 4.5  (a) Networked i devices at physical layer in IEEE 802.15.4 WPAN and (b) Adaptation layer \n\n6LoWPAN protocol 127 B (maximum) fragmented frames reassembly into IPv6 maximum 1280 B or  fragmentation of IPv6 MTU 1280 B into 127 B frames for transfer to a device. \n\n6LoWPAN protocol is used at Adaptation \n\nlayer before a data stack transmits to IPv6 \n\nInternet layer \n\n132 Internet of Things: Architecture and Design Principles \n\nFigure 4.5 shows that IPv6 over IEEE 802.15.4 standard network nodes uses the headers, security and application data as follows: IPv6 header = 40 B; UDP header = 8 B; device node MAC address = 25 B; AES-128 security = 21 B; Total device node frame size = 127 B (maximum). Therefore, maximum 33 Octets are left for the application data from the device. MAC is data communication protocol sublayer at the data-link layer (Refer Example 2.4 and Section 2.4.1 for meaning and usages of AES). \n\nIPv6 Maximum Transmission Unit (MTU) at link layer = 1280 B. Therefore, link-layer frame fragmentation is needed in order to communicate frame of 127 B over IEEE 802.15.4 nodes (device). The frame MTU is 1280 B for transmission to network layer. Fragments from frames from the device of 127 B each reassemble into an IPv6 frame. Also, IPv6 MTU at data-link layer 1280 B fragments into frame of 127 B each for single transfer to a device node. \n\n6LoWPAN has the following features: \n\n\u25cfSpecifies the IETF recommended methods for reassembly of fragments, and IPv6 and UDP (or ICMP) headers compression (6LoWPAN-hc adaptation layer), neighbour discovery (6LoWPAN-nd adaptation layer), and \n\n\u25cfSupports mesh routing ICMP stands for Internet Control Message Protocol. Routers or other devices on the network send error messages or relay the query messages. \n\n6LoWPAN can be implemented using Berkley IP implementation with operating system TinyOS or 3BSD or other implementations for IoT nodes from Sensinode or Hitachi or others. IPv6 network layer has two options, viz. RH4 routing header and hop-to-hop header RPL option. \n\n4.3.3 TCP/IP Suite \n\nTCP/IP suite means a set of protocols with layers for the Internet. Application layers protocol examples are HTTPS, HTTP, MQTT, XMPP, SOAP, FTP, TFTP, Telnet, PoP3, SMTP, SSL/TLS and others for communication using TCP stream. DNS, TFTP, Bootpc, Bootps, SNMP, DHCP, CoAP, LWM2M and others are for datagram communication using UDP. Application layer security protocols are TLS and DTLS. \n\nTCP is a transport layer, connection-oriented protocol that enables acknowledged data flow. \n\nUDP is another transport layer protocol that is a connectionless protocol and is meant for datagram communication. Other protocols in the TCP/IP suite for the transport layer are RSVP and DCCP. \n\nInternet layer protocol is IPv4/IPv6/RPL/ICMP/ICMPv6/IPSec or other. Data-link layer protocol is PPP/ARP/RARP/NDP, MAC or other. A MAC protocol is Ethernet or DSL or ISDN or other. \n\nFigure 4.6 shows the protocol layers and representative protocols at each layer. \n\nTCP/IP suite of protocols most used protocols for the global \n\nInternet networking \n\nInternet Connectivity Principles 133 \n\nDTLS Datagram (PDU = 2 B) 16 \n\nTLS \n\nSegment PDU = 2 B 32 \n\nNetwork Management \n\nND, RPL \n\nTransport UDP \n\nDatagram \n\nPacket PDU = 2 B 16 \n\nInternet Layer IPv4/IPv6 \n\nPDU = 1 Frame \n\nARP/RARP Data-link Layer \n\nWiFi/Ethernet Adaptation 6Lo WPAN, CoAP, LWM2M \n\nApplication Layer Protocols (DNS, TFTP, Bootpc, Bootps, SNMP, DHCP, \n\nCoAP, LWM2M \n\nApplication Layer Protocols (HTTPS, HTTP, MQTT, XMPP, SOAP, FTP, TFTP, \n\nTelnet, PoP3, SMTP) \n\nTransport Layer TCP Acknowledged Data Flow Stream \n\nFigure 4.6 IoT TCP/IP suite of protocols for Internet \n\nTCP/UDP Transport Layer for the Data Stack from or to Application Layer Port \n\nFollowing subsections describe the TCP and UDP transport layer protocols. TCP/IP transport layer receives or transmits the data segment and datagram from or to a port at the application layer. Following subsections describe TCP and UDP protocols. \n\nTCP \n\nTransport layer uses TCP when the receiver acknowledges the successful segment sequence number (within a specified interval) and remaining data segment sequences retransmit to the receiver. TCP also process data segment (maximum 232 B from application-layer port but transmits the segment part only. The size of actual data transmission in a TCP stream instance depends on network traffic conditions. When congestion is high, less number of words in the packets are sent for the receiver-end Internet layer L3. \n\nProtocol data unit, PDUTCP is the maximum data unit which can transmit or receive at the layer when using the TCP stream. PDUTCP = 1 segment and 1 segment maximum value = 232 B. TCP stream means transmitted or received data from or to the layer in a sequence during one cycle of transmission and acknowledgement of data stack. \n\nFigure 4.7 shows TCP data stack which includes TCP header fields. The figure shows start and end bit numbers in each word and data. The figure shows the data stack received \n\nTCP protocol is used for the acknowledged \n\ndata flow and almost \n\nconfirmed delivery \n\n134 Internet of Things: Architecture and Design Principles \n\nor transmitted at or to transport layer stream consisting of TCP header field 160 bits and extended header words up to qth bit when required, plus data stack of len words from or for the application layer. \n\nThe features of TCP protocol are as follows: \n\n\u25cfTCP header consists of five words. The header can be extended by using option words and padding words. Data stack to next layer or data packet to router has maximum v = (n + len) words where v <= (214 \u2013 n). \n\n\u25cfHeader first word fields are as follows: Upper 16 bits are for the source port number and lower 16 bits are for the destination port number. Second and third words are shown in Figure 4.7. \n\n\u25cfHeader fourth word upper 16 bits, lower 16 bits and header fourth word upper 16 bits, lower 16 bits are as shown in Figure 4.7. \n\n\u25cfTCP protocol transport is a full-duplex acknowledged data flow from the transport layer at one end (End 1) to the transport layer of the other end (End 2). \n\n31 16 Destination Port \n\nNumber \n\n15 0 Source Port \n\nNumber \n\n63 31 First Byte Sequence Number in the Stream \n\n95 64 \n\n127 112 w \n\nlen n [TCP Byte Stream size, + ) words] \n\n159 144 urgent [Data End Pointer (Location of \n\n143 128 Check Sum \n\nq 160 Option header words and fields plus the \n\nwords as padding before the data \n\nv q \n\nData of words = ( + ) 32 \u2013 1 len v n len \u00a5 \n\nHeader \n\n111 96 Flag (6-bit), Reserved (6 bit) plus Extended Header \n\nn q = (32 \u00a5 n \u2013 1), \n\n[ is number of words = words for header plus option plus padding words \n\nData Stack, from or to Application layer \n\nNext Expected Sequence Number in the Acknowledgement \n\nData Offset (4-bit) \n\nData Stack last word)] \n\nFigure 4.7  Data stack received or transmitted at or to transport layer stream consisting of TCP header \n\nfield 160 bits (5 words) and extended-header words (= n \u2013 5), extension is when required, plus data stack of len words from or for the application layer \n\nInternet Connectivity Principles 135 \n\n\u25cfEach TCP layer data stack reaches the destination almost each time. This is because retransmission takes from the next of last acknowledged sequence number to another sequence number. Difference in numbers is called window size between two numbers. \n\n\u25cfOne TCP connection communicates in one direction at an instance. \n\n\u25cfAcknowledged flow means that the request as well as response messages communicate in unicast mode. End 2 sends acknowledgement message and the header field of that conveys expected sequence number from transmitter by the receiver End 2. \n\n\u25cfTCP is connection-oriented. The connection first establishes using a connection establishment procedure adopted when transmitting a TCP data stack for the first time. The connection closes using a connection closing procedure adopted when the last sequence completes transmission of the TCP segment stack. \n\nUniversal Datagram Protocol (UDP) \n\nApplication may need to transmit through the transport layer when no acknowledgment is needed from the receiver, and when data in a transporting instance limits to a datagram of size 216 B including the header words enveloped at the layer. Then TCP/IP transport layer protocol is Universal Datagram Protocol (UDP). Datagram means data that it is just one message, which does not correlate with the next message or preceding message during an end-to-end transmission. UDP is also a protocol for the constrained environment and ROLL environment (Section 3.1). \n\nUDP header fields are 2 words (1 word = 32 bit) and optionally of 4 words (when including source and destination IP addresses, and is for communication of application layer stack (For example, DNS, TFTP, Bootpc, Bootps, SNMP, DHCP) or an application- support layer protocol stack (for example, CoAP or LWM2M). \n\nFigure 4.8 shows the UDP datagram format for transfer to the network layer during transmission or to the application layer during reception. The figure shows UDP header fields. The figure also shows a pseudo header of 2 words (64 bits) for source and destination IP addresses, which the next layer can use. \n\nThe features of UDP protocol are as follows: \n\n\u25cfUDP header consists of two words. Data stack to network layer has maximum m words where m <= (214 \u2013 2). Header first word fields are as follows: Upper 16 bits are for the source port number and lower 16 bits are for the destination port number. Header second word upper 16 bits are length and lower 16 bits are checksum. \n\n\u25cfUDP protocol transport is a half-duplex unacknowledged data flow from the transport layer at one end (End 1) to the transport layer of the other end (End 2). \n\n\u25cfEach UDP layer data stack may or may not reach the destination due to unacknowl- edged flow. \n\n\u25cfOne UDP connection communicates in one direction at an instance between two ends. \n\nUDP protocol is used for the unacknowledged \n\ndata flow when an application datagram \n\ntransmits on the \n\nInternet \n\n136 Internet of Things: Architecture and Design Principles \n\n31 0 Source IP address \n\n63 32 Destination IP address \n\n31 16 Destination Port \n\nnumber \n\n15 0 Source Port \n\nnumber 15 32 Check Sum 63 16 Length (4 m + 8) B \u00a5 p 64 \n\nm p m \n\nwords = ( + 4) 32 \u2013 1 \u00a5 \n\nPseudo Header \n\nHeader \n\nData stack \n\nfrom or to Application \n\nlayer \n\nFigure 4.8  Transport layer UDP header fields with data stack from the application layer and pseudo \n\nheader of 2 words (64 bits) for source and destination IP addresses \n\n\u25cfHalf duplex means that at a given instance only one direction, End 1 to End 2 or End 2 to End 1, is functional. Unacknowledged flow means that the request as well as response messages communicate in broadcast mode. End 2 does not send an acknowledgement message. \n\n\u25cfUDP is connectionless. It thus permits multicasting (means to multiple destinations). Connection-less means no connection establishment procedure is adopted when transmitting a UDP data stack for the first time and no connection closure procedure is adopted. \n\nReconfirm Your Understanding \n\n\u25cfInternet layer forwards data to the next layer using IP protocol. Internet connectivity is through a set of routers in a global network of routers. Routers carry data packets as per IP protocol from a source end to a destination and vice versa. \n\n\u25cfFour layers for Internet communication through physical layer are application, transport, Internet and data-link layers. Internet communication layers use the TCP/IP suite of protocols. \n\n\u25cfApplication, transport and Internet layers add the header words in the data stack for transmission to the next layer as new data stack. Data-link layer adds the header words as well as the trailing bits at the end before transmitting using physical layer. \n\n\u25cfTransport layer uses TCP or UDP. The Internet layer uses IP version 4 (IPv4) or IP version 6 (IPv6) or RPL. \n\nInternet Connectivity Principles 137 \n\n\u25cfApplication layer communicates a data segment or a datagram. It depends on the kind of protocol (or port) used by the layer. \n\n\u25cfApplication layer communicates a data segment (maximum 232 B per segment) from L7 layer and generates a TCP stream at the transport layer using TCP. The stream packetises (maximum 216 B per packet) at the Internet layer. \n\n\u25cfAlternatively, the application layer communicates a datagram (maximum 216 B) at L7 layer for sending a UDP datagram from the transport layer. \n\n\u25cfThe Internet layer uses an IP protocol for packet or message forwarding.  IP protocol is IPv4 or IPv6 or RPL or other. \n\n\u25cfRPL communication instance uses DODAG data flow. \n\n\u25cfThe Internet layer in IPv6 receives and transmits from/to data-adaptation layer when using IEEE 802.15.4 WPAN devices. \n\n\u25cfThe data stack uses 6LoWPAN protocol at the adaptation layer before data stack transmits to IPv6 Internet layer. \n\n\u25cfUDP header has fields for source and destination port numbers. \n\n\u25cfTCP header has fields for sequence number of the data segment from where the data stack communicates and for window size which specifies the number of transmitting bytes. \n\n\u25cf IP packet header has fields for IP version and source and destination IP addresses. \n\nSelf-Assessment Exercise \n\n1. Why does a header add when a data stack transfers from a higher layer to a \n\nlower layer? Why does a header subtract when data stack transfers from a lower layer to a higher layer? 2. How do four layers generate data stack for the network and physical layers \n\nduring Internet communication? Show diagrammatically. 3. Compare the features in IPv4 and IPv6. 4. How do packets route over the Internet using a set of four routers between \n\nsource and destination? Show diagrammatically. 5. What are the features of RPL? 6. List the features of 6LoWPAN. 7. Make a table for the application layer and corresponding protocol used at \n\ntransport for the application/service/business process in TCP/IP suite of protocols. 8. List the header fields in a UDP header and their functions. 9. List the functions of the header fields in an IP header when packets transmit \n\nbetween source and destination. 10. List the functions of the header fields in a TCP header at the transmitting \n\nend. How are the fields used when sending an acknowledgement from the receiver end? \n\n\u2605 \n\n\u2605\u2605 \n\n\u2605\u2605 \u2605\u2605\u2605 \n\n\u2605 \u2605 \u2605\u2605 \n\n\u2605 \u2605\u2605 \n\n\u2605\u2605\u2605 \n\nNote: \u2605 Level 1 & Level 2 category \u2605\u2605 Level 3 & Level 4 category \u2605\u2605\u2605 Level 5 & Level 6 category \n\n\n![Image](/src/assets/generated_images/iot2_p164_i0.png)\n\n138 Internet of Things: Architecture and Design Principles \n\n4.4 IP ADDRESSING IN THE IoT \n\nAn IP header consists of source and destination addresses, called IP addresses. The Internet generally uses IPv4 addresses. IoT/M2M use IPv6 addresses. Following subsections describe the addressing schemes. \n\n4.4.1 IP Address \n\nIP version 4 address consists of 32 bits. However, it can be considered as four decimal numbers separated by dots. For example, 198.136.56.2 for 32 bits\u201411000110 10001000 00111000 00000010. Each decimal number is decimal value of an Octet (= 8 bits). IP addresses can be between 0.0.0.0 to 255.255.255.255; total 232 addresses due to 32-bit address. Three separate fields with a decimal number each for each set of 8 bits are easier to use. Let\u2019s see an analogy with postal network addressing method. Consider an address: \n\nMcGraw-Hill Education, 2 Pennsylvania Plaza, New York City, USA. \n\nIn the above example, three fields are separated by a comma and a new line each. A mail routes to the destination using the address. First the mail routes to USA, then to New York City, then to Pennsylvania Plaza and then the final destination.  Similar are the actions, when a packets route to a destination IP address from a source IP address. \n\nEach device or node which communicates on the Internet must have an IP address. The number of nodes or devices can be very large. Recall Figure 4.1 where a communication framework communicates with number of sensors. Each sensor or device is assigned the addresses used internally. The framework communicates with the Internet with one IP address externally to the applications. One solution for a large number of nodes is dividing the network into Internet address and subnet address. \n\nFor example, 2 Pennsylvania Plaza, New York City, USA may be a globally visible address. Internally, the mail is to be directed to which individual at McGraw-Hill Education is decided by an internal distribution network, invisible to the outside world. \n\nAlternatively, New York City, USA may be a globally visible address. Internally, the mail to be directed to which individual at McGraw-Hill Education, 2 Pennsylvania Plaza is decided by an internal distribution network, invisible to outside world. \n\nInternet address is visible to outside world means it is visible to the routers on the Internet. Subnet address is for use within the group internally and is invisible to the outside world. A subnet is a subnetwork consisting of number of hosts or nodes or devices or machines. \n\nA subnet mask and network 32-bit IP address after ANDing operation gives individual subnet address.  Logical AND operation with complement of subnet mask with the IP address gives the host identifier on the subnet. Example 4.3 will clarify the procedure. \n\nDescribe the functions of IP address, MAC address, \n\nDNS and DHCP \n\nLO 4.2 \n\nInternet Connectivity Principles 139 \n\nIP address 198.136.56.2 is visible on the Internet. Number of servers, such as web server, mail server and FTP server are invisible and these have the same IP address globally and separate addresses internally on a subnet of server or nodes or devices. \n\nAn IP address serves the purpose of uniquely identifying an individual network interface of a host. The interface locates on the network using that address. The address enables routing of IP packets between the hosts. IP addresses are present in fields of the packet header for routing. The header indicates both source and destination of the packet.3 \n\nStatic IP address \n\nA static IP address is the one assigned by the Internet service provider. The service provider may provide an individual just one address. When a company has a number of hosts, a service provider may provide a class C network address consisting of a group of 254 (= 28 \n\nhow the allocations of static addresses are made to a group of hosts. \n\nExample 4.2 \n\nProblem How are IP addresses allotted to a group of hosts on the Internet? What do class A, B, C and D network mean when using the subnets? Give an analogy with postal network for communication to McGraw-Hill Education, 2 Pennsylvania Plaza, New York City, USA. \n\nSolution \n\nA group of hosts on the Internet are allotted IP addresses as follows: Class A network group address means address n.x.x.x, where x is between 0 to 255 and n is between 1  and 126 for the addresses between 1.0.0.0 and 126.x.x.x. This is because the IP address 32-bit has msb bit 31 = 0. \n\nThree x.x.x specifies a network group of 224 \u2013 2 hosts, just as USA specifies a large group of addresses in USA. Minus 2 is because all 0s and all 1s in .x.x.x are not allotted in subnet. \n\nClass B network group address means address n.m.x.x, where x is between 0 to 255 and n.m is between 128.1 to 191.254 for the addresses between 128.1.0.0 and 191.254.x.x. This is because the IP address 32- bit has two msb bits 31\u201330 = 10. Two x.x specifies a network group of (216 \u2013 2) hosts, just as New York City, USA specifies a group of addresses in New York City, USA. [Minus 2 is because all 0s and all 1s in .x.x are not allotted in subnet.] \n\nClass C network group address means address n.m.k.x, where x is between 0 to 255 and n.m.k is between 192.0.1 and 223.255.254 for the addresses between 192.0.1.0 and 223.255.254.x.  This is because the IP address 32-bit has three msb bits 31-30-29  = 110. One  .x specifies a smaller group of (28 - 2) hosts, just as 2 Pennsylvania Plaza, New York City, USA specifies a group of addresses at 2 Pennsylvania Plaza, New York City, USA and one of them is McGraw-Hill education. Minus 2 is because all 0s and all 1s in msbs 11 or 00 in 8 bits in .x not allotted in subnet. \n\nClass D addresses are for multicasting and are from 224.0.0.0 and are less than 240.0.0.0. Address 0.x.x.x is a reserved address. Address 127.x.x.x is also a reserved address. \n\n3 http://www.webopedia.com/DidYouKnow/Internet/ipv6_ipv4_difference.html \n\n140 Internet of Things: Architecture and Design Principles \n\nExample 4.3 gives the method of finding the subnet address and host on the subnet using the IP address and subnet mask of a subnet in case of classifications A, B, C and D for the allocations of static addresses to a group of hosts. \n\nExample 4.3 \n\nProblem A subnet and its hosts communicate with the Internet using a subnet mask. How does the IP address and subnet mask find the subnet address and host on the subnet? What is the procedure for evaluation of subnet address and host address? \n\nSolution \n\nAn IP address consists of two parts: Upper bits (msbs) are for the network address and lower bits (lsbs) are for the subnet address and the individual host. Upper bits in a subnet mask allot for each node to address that node with the address of group of hosts on a subnet. Subnet mask bits depend on the class of the network group address. Mask bits are as follows: \n\nClass A network group address node has a subnet mask and the mask consists of all eight msbs = 11111111 and remaining 24 bits are set as per the subnet and host address. Subnet id is invisible to the outside world of the Internet. These 24 bits identify the host on a subnet. Class A group subnet masks are 224 \u2013 2 for 224 \u2013 2 hosts. \n\nClass B network group address node has a subnet mask and the mask consists of all sixteen msbs = 1s and remaining 16 bits are set as per the subnet id and host address at the subnet invisible to the outside world of the Internet.  Last 16 bits identify subnet and the host on that subnet. Class B group subnet masks are 216 \u2013 2 for 216 \u2013 2 hosts. Class C network group address node has a subnet mask and the mask consists of all 24 msbs = 1s and remaining 8 bits are set as per the subnet id and host address on the subnet. Subnet id is invisible to the outside world of the Internet. Last 8 bits identify a subnet id and the host on that subnet. Class C group subnet masks are 28 \u2013 2 for 28 \u2013 2 subnet plus host address bits. \n\nFollowing is the procedure for evaluation of subnet address and host address: \n\nSuppose 14 hosts function as subnets on a network. Assume that a Class C network group address when network communication is with 14 subnets. Each subnet thus identifies by 4 higher bits after the network address 24 bits. Therefore, subnet mask will 24 msbs as 1s plus 4 higher bits among 8 remaining bits in the subnet mask will be 1s. Subnet masks for an individual subnet will be (1111 1111 1111 1111 1111 1111 0001 0000), (1111 1111 1111 1111 1111 1111  0010 0000), \u2026to  (1111 1111 1111 1111 1111 1111 1110 0000). ANDing of 32-bit IP group address and 32-bit subnet mask gives the internal subnet address. Higher 4 bits identify the individual subnet among the 14 subnets functioning as host. Subnet address is network address bits plus 4 subnet identifier bits and plus 4 bits 0000 in the example given in above paragraph. ANDing of complement of 32-bit subnet mask with 32-bit IP group address gives the host identifier the external IP address for the Internet. \n\nIf 30 hosts function as subnets, then subnet mask will 24 msbs as 1s plus 5 higher bits among 8 remaining bits in the subnet mask will be 1s. This is because 30 equals 25 \u2013 2. Then last 3 bits of subnet mask will be 000. \n\nInternet Connectivity Principles 141 \n\nA new scheme, called Classless Inter-Domain Routing (CIDR) is used nowadays. For example, Class C 198.136.56.0/4 means Class C allotted four IP addresses for Internet routing by 4 public domain servers. The system administrator at a company allots servers for each of the 4 IP addresses, for the same domain name. \n\nDynamic IP address \n\nOnce a device connects to the Internet, it needs to be allotted an individual IP address. When the device connects to a router, the router and device use the DHCP (Dynamic Host Control Protocol) which assigns an IP address at an instance to the device. This address is called dynamic IP address. When a device disconnects or switches off or the router boots again, then the dynamic IP address is lost and a new allocation takes place when the device reconnects. \n\nDNS \n\nConsider an IP address, 198.136.56.2 (11000110 10001000 00111000 00000010). It is difficult to remember or use. The domain name for the address is rajkamal.org. Access to web- server hosted at the domain is made using the website name, http://www.rajkamal.org/. Access to mail-server hosted at the domain is made using the mail server name, http:// mail.rajkamal.org/. Another example of domain name is mheducation.com/. \n\n.com, .org, .in and .us are called Top Level Domain (TLD). A TLD can further be subdivided as .co.in or .gov.in. or .gov.uk. \n\nA registrar provides domain names at a certain cost per year. The DNS server at the Registrar has a control panel (cPanel) and can be configured using cPanel. Domain Names System (DNS) is an application which provides an IP address for a corresponding service from the named domain service. \n\nDHCP \n\nWhen a sensor, actuator or IoT device or node needs to connect to the Internet, a server called DHCP server provides a dynamic IP address, subnet mask, and ARP and RARP caches. The server (subnet) has its own IP address to provide connectivity to the Internet.4 \n\nDynamic Host Configuration Protocol (DHCP) is a protocol to dynamically provide new IP addresses and set subnet masks for the connected node so that it can use the subnet server and subnet router at the communication framework. \n\nIP addresses are configured. An administrator or user does this process. DHCP enables the process of configuring IP addresses automatically at start-up. \n\nA node has a software component for sending requests to the DHCP server and receiving responses. The component is called DHCP client. DHCP client protocol communicates with a server. Steps in the DHCP protocol for dynamically configuring the IP address and other networks are: \n\n1. The DHCP client broadcasts a discover-request, known as DHCPDISCOVER. \n\n4 https://www.ietf.org/rfc/rfc2131.txt \n\n142 Internet of Things: Architecture and Design Principles \n\n2. A DHCP server listens to DHCPDISCOVER and finds the configuration, which can \n\nbe offered to the client. Server(s) send(s) the configuration parameters, including an IP address not presently in use, at the subnet. The configuration parameters are in the DHCPOFFER for the offered configuration. 3. The selected DHCP server creates and manages bindings. DHCP server also sets a \n\ntime interval during which the offered IP address will be valid for the DHCP client node. 4. The DHCP server confirms the binding through a message. It sends DHCPACK after \n\ncreating the binding. 5. When the node with the DHCP client computer leaves the subnet, it sends a \n\nDHCPRELEASE message. If the client does not send DHCPRELEASE within a specified time interval, then the server frees the created binding. 6. The server and client also use authentication protocols before considering the \n\nDHCPDISCOVER from a client and before accepting a DHCPOFFER, respectively. The DHCP protocol guarantees that any assigned network address, at a given instant, is in use by either one DHCP client or none. \n\n4.4.2 IPv6 Address \n\nDevices (nodes) for IoT need large number of addresses. IPv6 uses 128-bit address. A hexadecimal digit represents 4-bit, 0 hex = 0000 binary to f hex = 1111. Therefore, 128-bit address has 32 hexadecimal digits. Eight sets of 4 hex-digits are each separated by a colon or dot in an IPv6 address. Example is 16-hexadecimal digits, 40a0: 0acb:8a00:b372:0000: 0000:0000:0000. IANA manages the allocation process for IPv6 addresses; 64 bits in the last when all zeros then can be omitted. \n\nDevices in mesh network may use 6LoWPAN protocol at the adaptation layer and Ipv6 when communication framework communicates on the Internet using IPv6. Last 64 bits are interface identifiers. An interface may have a distinct node. \n\nIPv6 addresses are classified into three classes. Each class differs in primary addressing and routing methods. An interface may be at a distinct node. Unicast address is for a single network interface. 48 bit or more in unicast specify routing prefix. 16 bit or less specify a subnet id. 64 bit are interface identifiers. \n\nAnycast address means address of a group of nodes or interfaces. A packet sent to an anycast address is delivered to just one of the member interfaces. One may be the nearest host. Nearest is measured according to the routing protocol\u2019s definition of distance. \n\nMulticast address means an address used by multiple hosts, which acquires the multicast address destination by participating in the multicast distribution protocol among network routers. A packet with multicast address delivers to all interfaces that have joined the corresponding multicast group. \n\nInternet Connectivity Principles 143 \n\n4.5 MEDIA ACCESS CONTROL \n\nEach network connected node has an MAC address. A device node receives data stacks using its MAC address. Media means physical media, fibre or wire using which a device or node accesses the Internet. The nodes can use the same physical network and IP address. Node means an IoT device or sensor or actuator or controller or computer, the data-link layer of which communicates to the Internet.  MAC address is 48 bit. \n\nEach network card or Ethernet protocol using a communicating node  has a unique MAC address for the source and destination node addresses. Ethernet frame communicates before the data stack source-node MAC address and destination-node MAC address. MAC address of each node is specified in the firmware of the network card or chip or core. \n\nUsage of ARP enables each node to be addressed by the MAC address. The node receives the network data from a router having an IP address. Usage of RARP enables each node for sending on the network the data to a router having an IP address. \n\nAddress Resolution Protocol (ARP) uses a lookup table. The network 32-bit address provides MAC address of the individual node using that table. RARP also uses that lookup table. The table stores the IP address in one column. MAC address is in another column in each row. Number of rows is equal to the number of nodes connected to the Internet. An individual node MAC address provides the network a 32-bit address for the Internet using the table. The lookup table is a table in which a value in a column of a row is used as a key to look for another value or a set of parameters from another column(s) of the row. \n\nARP cache serves as building up of the table for the address translation of the data stack received at the Internet layer to the node MAC address. Whenever the first time the network sends the receiver IP and MAC addresses, or a node sends the sender MAC and IP addresses, they save a cache called ARP cache. The cached addresses build a lookup table for the next communication between the node and the network. The process enables the node to transmit and receive the IP packets at the new IP address from the Internet by the address resolution. \n\nAlternatively, an address can be stored locally in a memory card or flash memory of a board or microcontroller chip. Software, when the microcontroller starts, read this address. The board or chip connects to the Ethernet LAN uses the saved MAC address. The chip connects to the Internet using this address and RARP. The chip receives IP data stack using ARP. \n\nARP and RARP could \n\nbe used for address \n\ntranslation \n\nReconfirm Your Understanding \n\n\u25cfIP version 4 address consists of 32 bits. However, it can be considered as four decimal numbers separated by dots. For example, 198.136.56.2 for 32 bits. Each decimal number\u2019s value is between 0 and 255. \n\n144 Internet of Things: Architecture and Design Principles \n\n\u25cfA subnet is a network of devices or nodes or machines or computers which connect using a common IP address. The Internet Service Provider allocates a common IP address to a group of subnets and their hosts.  Each subnet in the group has a subnet mask. \n\n\u25cfClass A network address corresponds to the biggest group of subnets and hosts [maximum (224 \u2013 2)] on a subnet (msb bit 31 =  0). \n\n\u25cfClass B network address corresponds to a big group of subnets and hosts [maximum (216 \u2013 2)] on a subnet (Two msb bits 31-30  = 10). \n\n\u25cfClass C network address corresponds to a small group of subnets and hosts (maximum [216 \u2013 2)] on a subnet (Three msb bits 31-30-29  = 110). \n\n\u25cfClass D addresses corresponds to a multicasting address. \n\n\u25cfAn IPv6 address is a 128-bit address, consisting of 32 hexadecimal digits. Example is 16-hexadecimal digits, 40a0: 0acb:8a00:b372:0000: 0000:0000:0000. IANA manages the allocation process for IPv6 addresses. 64 bits in the last when all zeros, then they can be omitted. \n\n\u25cfIPv6 addresses are classified into three classes: unicast, anycast and multicast addresses. 128 bits has 64 bits as interface identifier, 16 or fewer bits for subnet id and remaining msbs are the routing prefix. \n\n\u25cfDNS is a domain name system to translate top-level domain and domain names into IP address and vice versa. The name can easily be remembered. The names are registered. \n\n\u25cfAn IP address can be static or dynamic. Dynamic IP is generated as follows: A DHCP server configures and provides an IP address for the Internet for a certain specific interval. A DHCP client seeks from a DHCP server and discovers the IP address. \n\n\u25cfARP finds the node (device) MAC address at data-link layer from the Internet layer IP address. The node (device) data-link layer with a MAC address connects to the Internet using an IP address.  RARP finds the IP address using the MAC address. \n\nSelf-Assessment Exercise \n\n1. List the uses of IP addresses of source and destination on the Internet. 2. A service provider provides a class C network address to a company. How \n\nmany subnets and hosts can communicate with the Internet? 3. List the features of Class A, B, C and D network addresses. 4. An enterprise has number of subnets and hosts. How does a subnet host \n\nconnect to the Internet? 5. A subnet mask is 1111 1111 1111 1111  1001 0000 0000 0000. IP address is \n\n198.136.56.2. How do these figures provide subnet and host addresses? 6. How do the fields in IPv6 unicast, anycast and multicast addresses differ? 7. How does a domain name correlate with the URLs for mail and web servers? 8. What are the steps in DHCP protocol for allocation of a dynamic IP address? 9. Why is each node provided a fixed MAC address? When a new IoT device is \n\nmade, then an MAC address is placed in the firmware. Why? 10. How is an ARP cache used? Show it diagrammatically. \n\n\u2605 \u2605 \n\n\u2605\u2605 \u2605\u2605\u2605 \n\n\u2605\u2605\u2605 \n\n\u2605\u2605 \u2605\u2605 \u2605\u2605 \n\n\u2605 \n\n\u2605\u2605 \n\n\n![Image](/src/assets/generated_images/iot2_p171_i0.png)\n\nInternet Connectivity Principles 145 \n\n4.6 APPLICATION LAYER PROTOCOLS: HTTP, HTTPS, FTP, TELNET AND OTHERS \n\nTCP/IP suite consists of a number application layer protocols. For example, HTTP, HTTPS, FTP, Telnet and others. A port uses a protocol for sending and receiving messages. A TCP/IP message must be sent from the right port at the transmission end and to the right port at the receiver end, else the receiver port does not listen. \n\n4.6.1 HTTP and HTTPS Ports \n\nHyper Text Transfer Protocol (HTTP) port number is 80. A web HTTP server listens to port 80 only and responds to port 80 only. An HTTP port sends application data stack at the output to the lower layer using the HTTP protocol.5 \n\nAn HTTP port uses a URL like http://www. mheducation.com/. The default port is taken as 80. The port number can be specified after the TLD. For example, after \u2018.com\u2019 in URL http://www. mheducation.com:80/. \n\nHTTPS (HTTP over Secure Socket Layer or TLS) port number is 443. An HTTPS port sends a URL; for example,  https://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_ numbers.  Here, TLD is .org, domain name is wikipedia.org and Subdomain name is en. Resource URL is at /wiki/List_of_TCP_and_UDP_port_numbers. \n\nThe port receives the data stack at the input at the receiver end. Each port at the application layer uses a distinct protocol. A port is assigned a number according to protocol used for transmission and reception. \n\nThe important features of HTTP are: \n\n\u25cfHTTP is the standard protocol for\u00b7 requesting a URL defined web-page resource, and for sending a response to the web server. An HTTP client requests an HTTP server on the Internet and the server responds by sending a response. The response may be with or without applying a process. \n\n\u25cfHTTP is a stateless protocol. This is because for an HTTP request, the protocol assumes a fresh request. It means there is no session or sequence number field or no field that is retained in the next exchange. This makes a current exchange by an HTTP request independent of the previous exchanges. The later exchanges do not depend on the current one. E-commerce like application needs a state management mechanism. The stateless feature of HTTP is compensated by a method as: A cookie is a text file which creates during a particular pair of exchanges of HTTP request and response. The creation is either at a CGI or processing program. For example, JavaScript or script or at a client. A prior exchange may then depend on this cookie. The cookie thus provides an HTTP state management mechanism. \n\n5 http://www.w3.org/Protocols/ \n\nExplain the functions of Application Layer protocols\u2014HTTP, HTTPS, FTP, Telnet and \n\nPorts \n\nLO 4.3 \n\n146 Internet of Things: Architecture and Design Principles \n\n\u25cfBasically, HTTP is a file transfer-like protocol. We use it more efficiently than the FTP (a protocol for a file transfer on the Internet) because in FTP, we have to give a certain command. Then, a communication establishes between two systems just to retrieve a specified file. On the other hand, HTTP is simple. There are no command line overheads. This makes it easy to explore a website URL. A request (from a client) and reply (from a server) is the paradigm. \n\n\u25cfThe HTTP protocol is very light (a small format) and thus speedy as compared to other protocols, such as FTP. HTTP is able to transfer any type of data to a client provided it is capable of handling that data. \n\n\u25cfHTTP is flexible. Assume during a client web connection, the connection breaks. The client can start by re-connecting. Being a stateless protocol, HTTP does not keep track of the state as FTP does. Each time a connection establishes between the web server and the client, both these interpret this connection as a new connection. Simplicity is a must because a webpage has the URL resources distributed over a number of servers. \n\n\u25cfHTTP protocol is based on Object Oriented Programming System (OOPS). Methods are applied to objects identified by a URL. It means as in the normal case of an Object Oriented Program, various methods apply on an object. \n\n\u25cfFollowing features have been included from HTTP 1.0 and 1.1 version onwards: (a) Multimedia file access is feasible due to provision for the MIME (Multipurpose Internet Mail Extension) type file definition. \n\n\u25cfEight HTTP specific specified methods and extension methods included from HTTP 1.1 version onwards. The HTTP specific methods are as follows. 1. GET. 2. POST. 3. HEAD. 4. CONNECT. 5. PUT. 6. DELETE. 7. TRACE. 8. OPTIONS. (Last four from 1.1.) \n\n\u25cfEarlier versions, GET follows a space and then the document name. The server returns the documents and closes the connection. The POST method permits form processing as using it the client transmits the form data or other information to the server from 1.1.  Also, the server does not close the connection after response and thus response can be processed before it is sent. \n\n\u25cfA provision of user authentication exits besides the basic authentication. \n\n\u25cfDigest Access Authentication prevents the transmission of username and password as HTML or text from HTTP 1.1 version onwards. \n\n\u25cfA host header field adds to support those ports and virtual hosts that do not accept or send IP packets. An Error report to Client when an HTTP request is without a Host header field from HTTP 1.1 version onwards. \n\n\u25cfAn absolute URL is acceptable to the server. In the earlier version, only a proxy server accepted that. \n\n\u25cfMessage Headers uses are: A message during a request from a client or during a response from a server consists of two parts\u2014a start-line, none or several message-headers (fields) and empty line, and body of the message. Message headers are: \n\nInternet Connectivity Principles 147 \n\n\u274dCommon (general) headers are added when requesting a server and when responding \n\nto a client. A header includes MIME version, OPTIONS, cacheable or not cacheable, and transfer to close or not close the connection. \n\n\u274dRequest headers are for a request and client information to a server. The header \n\nincludes acceptable media or preferred specification\u2014specifies about acceptability of HTML or HTML or text or any other type informs if a special type of character set acceptable. \n\n\u274dEntity headers contain information about the entity body contained in the message \n\nor in case the body is not present then information about the entity is not present its body. For example, information for content-length in bytes. \n\n\u274dResponse headers are present in the response for server information to a client. \n\n\u25cfStatus codes add in the response and caching of a resource provided at a server (and proxy). For example, status code returned as response when 400 means a bad request (the request unrespondable), 401 unauthorized request, 402 means request requires a payment before response feasible, 403 means request is for a forbidden resource and 404 means URL resource not found by the server. \n\n\u25cfByte range specification helps an HTTP server to send large response in parts. Length specification helps in presentation in chunks. \n\n\u25cfSelection among various characteristics on retrieval by the client is feasible when a server sends a response to the client request. For example, the two characteristics, language and encoding can be specified in the server environment variables while the client sends the request header for retrieving a resource. The resource then retrieves in that language and with that encoding. The contents sent to the client do not change, only the way in which these are presented to the client change. The environment variables for the way in which a resource retrieves could not be changed at the server in the earlier HTTP versions before 1.1. \n\n4.6.2 Other Ports \n\nThe IANA reserves the port numbers.  The numbers are between 0 and 1023. They are well-known ports. System process or software connects to them. Port number 0 means the host itself. Internet Assigned Number Authority (IANA) registers a registered port number which is according to a specific protocol. Registered numbers are between 1024 and 49151. These are registered ports. 212 numbers between 49152 are unregistered, left for assignment and use by users. System process or software connects to them. A user unregistered server has a port number above 5000. \n\nA list of widely used ports is available at https://en.wikipedia.org/wiki/List_of_TCP_ and_UDP_port_numbers. \n\nTCP/UDP registered ports and unregistered \n\nports \n\n148 Internet of Things: Architecture and Design Principles \n\nExample 4.4 \n\nProblem Give examples of registered port numbers and the protocols which each port uses. \n\nSolution \n\nExamples are as follows: \n\nPort \n\nNumber \n\n17 21 23 25 53 79 80 108 110 \n\nProtocol Users List FTP Telnet SMTP DNS Finger HTTP SNA-GAS PoP3 \n\nPort \n\nNumber \n\n161 389 443 547 1293 2095 5222 5223 5683 \n\nProtocol SNMP LDAP HTTPS DHCPServer IPsec cPanel (default use is for web mail) \n\nXMPP XMPP-SSL CoAP \n\nFTP is a file transfer protocol. It is a stateful protocol. Telnet is for remote connection to a computer. SMTP is for mail transfer and PoP3 for mail retrieval from a mail server. \n\nA port supports multiple logical connections between a source at an IP address and destination at another IP address. A socket consisting of port and IP sends application data stack on the Internet to another socket at another IP address and port. \n\nReconfirm Your Understanding \n\n\u25cfHTTP, HTTPS, FTP, Telnet, SMTP, DNS, DHCP, PoP3, SNMP, LDAP, XMPP, XMPP-SSL, CoAP, LWM2M and IPSec are protocols for the application layer/application-support layer ports. \n\n\u25cfA URL specifies the protocol when sending a request for a resource. For example, http://, coap://, https:// and ws:// before a domain name. \n\n\u25cfHTTP is stateless communication. A method is used to save states during communication in web applications. \n\n\u25cfAn HTTP client is used for a web server for requesting a webpage as response from an HTTP server. \n\n\u25cfAn HTTPS port is for an HTTP message over a secure socket layer or TLS. \n\n\u25cfA port sends a TCP/IP message to a receiver port. IANA assigns a port number for each protocol. A receiver port listens only if the sender port is using the right port and sends to the right port. \n\n\u25cfA port number associates a protocol at the application/application-support layer. For example, port number 80 associates HTTP. \n\nInternet Connectivity Principles 149 \n\nSelf-Assessment Exercise \n\n1. What are the functions of HTTP, HTTPS, FTP, Telnet, CoAP and LWM2M \n\nports? 2. What is the advantage of a receiver port not listening to a message unless sent \n\nusing the right port at transmission end and received at the right port at the receiver end? 3. What do the terms language and encoding specify in the server environment \n\nvariables while client sends the request header for retrieving a resource? 4. List the features of HTTP. 5. List the usages of eight HTTP specific specified methods. 6. What are the message header types and the uses of each in HTTP 1.1? 7. What are the advantages of a server response consisting of a status code? 8. How does function of a port differ from that of a socket? 9. List the 16 port numbers along with their protocols. 10. Why is it that IANA registers a port number and assigns it a specific protocol? \n\n\u2605 \n\n\u2605\u2605 \n\n\u2605 \n\n\u2605\u2605\u2605 \n\n\u2605 \u2605\u2605 \n\n\u2605 \u2605\u2605 \u2605\u2605\u2605 \u2605\u2605\u2605 \n\nKey Concepts \n\n\u25cf6LoWPAN \n\n\u25cfARP \n\n\u25cfClass A, B and C \n\n\u25cfData segment \n\n\u25cfDHCP \n\n\u25cfDNS \n\n\u25cfHeader \n\n\u25cfHeader fields \n\n\u25cfHost \n\n\u25cfHTTP \n\n\u25cfHTTPS \n\n\u25cfIP \n\n\u25cfIP router \n\n\u25cfIPv6 \n\n\u25cfMAC address \n\n\u25cfMTU \n\n\u25cfPacket \n\n\u25cfPDU \n\n\u25cfPort \n\n\u25cfRARP \n\n\u25cfRPL \n\n\u25cfSubnet \n\n\u25cfTCP \n\n\u25cfTCP header \n\n\u25cfTCP/IP \n\n\u25cfUDP \n\n\u25cfUDP header \n\nLearning Outcomes \n\nLO 4.1 \n\n\u25cfInternet communication is through the routing of packets. A packet has a maximum 216 B. Packet routing for Internet communication is as follows: Each router has information about the path to the destination for the packets. When a number of paths are available at an instance, then number of packets of same source simultaneously follows different paths from a router. Destination-end transport layer reassembles the packet according to their sequences in source transport layer data streams.  Then, the reassembled data segment transfers to the IoT application layer at the destination end. \n\n150 Internet of Things: Architecture and Design Principles \n\n\u25cfFour layers for Internet communication are application, transport, Internet and data-link layers. These layers use the TCP/IP suite of protocols for Internet communication. TCP/IP suite is a set of protocols with layers for the Internet. \n\n\u25cfApplication layer protocol is HTTPS, HTTP, MQTT, XMPP, SOAP, FTP, TFTP, Telnet, PoP3, SMTP, SSL/TLS or other when a TCP stream communicates. The protocol is DNS, TFTP, Bootpc, Bootps, SNMP, DHCP, CoAP, LWM2M or other when a datagram communicates using UDP. \n\n\u25cfApplication layer security protocol is TLS or DTLS. \n\n\u25cfTransport layer protocol is TCP or UDP or RSVP, DCCP or other. TCP feature is acknowledged data flow and ensuring delivery of all sequences in the segment. UDP is unacknowledged data flow. \n\n\u25cfInternet layer protocol is IP protocol (IP v4/IPv6/ RPL)/ICMP/ICMPv6/IPSec or other. Internet layer uses an IP protocol for packet forwarding. \n\n\u25cfData-link layer protocol example is Ethernet, MAC, PPP, ARP, RARP or NDP. \n\n\u25cfAdaptation layer protocol is 6LoWPAN for IEEE 802.15.4 IoT/M2M devices. \n\n\u25cfRPL is a non-storing routing mode protocol. IoT/M2M low power lossy environment uses RPL protocol. Internet layer IPv6 receives and transmits from/to data-adaptation layer   when using IEEE 802.15.4 WPAN devices \n\nLO 4.2 \n\n\u25cfInternet communication between routers uses IP addresses. IPv4 address is 32-bit address and IPv6 of 128-bits. \n\n\u25cfA subnet is a network of devices, nodes, machines or computers, which connect using a common IP address. Internet Service Provider allocates a common IP address to group of subnets and their hosts.  Each subnet in the group has a subnet mask. \n\n\u25cfThree types of classes\u2014A, B and C network address corresponds to a group of subnets and hosts. \n\n\u25cfIPv6 address is 128-bit address, which has 32 hexadecimal digits. IPv6 addresses are classified into three classes: unicast, anycast and multicast addresses. \n\n\u25cfDNS is a domain name system to translate IP address into names and names into IP addresses. \n\n\u25cfIP address can be static or dynamic. Dynamic IP generates using DHCP client and server. \n\n\u25cfInternet layer IP address using ARP finds the node (device) MAC address at data-link layer. The node (device) data link layer with a MAC address connects  Internet using an IP address RARP  finds the IP address \n\nLO 4.3 \n\n\u25cfA port sends a TCP/IP message to a receiver port. An HTTP or HTTPS port is for sending a request and receiving the response. \n\n\u25cfIANA assigns a port number for each protocol for the Internet. A receiver port listens to only if sender port is using right port and sends to right port. \n\n\u25cfHTTP, HTTPS, FTP, Telnet, SMTP, DNS, DHCP, PoP3, SNMP, LDAP, XMPP, XMPP-SSL, CoAP, LWM2M and IPSec are the protocols for the application layer/application support layer ports. \n\n\u25cfA URL specifies the protocol when sending request for a resource, for example, http://, coap://, https:// and ws:// before a domain name. \n\n\u25cfA port number associates a protocol at the application/application-support layer. For example, port number 80 associates HTTP. \n\nInternet Connectivity Principles 151 \n\nExercises \n\nObjective Questions \n\nSelect one correct option out of the four in each question. \n\n1. TCP/IP protocol suite for IoT application/service/business process consists of: \n\n(a) Application, application-support, security, transport, network, adaptation and \n\ndata-link layer protocols (b) Security, transport, network, data-link layer protocols \n\n(c) Transport and Internet layer protocols (d) Security, transport and Internet layer protocols 2. TCP protocol (i) almost guarantees successful reception of all packets, (ii) specifies \n\nthat if within a specified interval, there is no acknowledgement of last sent sequence number for the messages or the acknowledged sequence number is less than the last sequence number, then the unacknowledged sequences retransmits. (iii) The acknowledged sequence number of data stack may be received after the interval, (iv) receiver end not receiving packets, (v) header field provisions for the multiple acknowledgements, and (vi) window size is large. Duplicate and triplicate acknowledgements in TCP are because of: (a) (ii) (b) (ii) and (iii) \n\n(c) (i) (d) (i) and (vi) 3. (i) Transport layer protocol is UDP when the application layer protocol is DNS, TFTP, \n\nBootpc, Bootps, SNMP, DHCP, CoAP or LWM2M, (ii) Internet layer protocol is IPv4/ IPv6/RPL/ICMP/ICMPv6/IPSec. (iii) Transport and IP layers use a header field for error detection. (iv) Data-link layer uses CRC bits for error detection. (a) All except (i) (b) All except (iv) \n\n(c) All except (iii) (d)  All 4. UDP (i) is Internet layer protocol, (ii) is Transport layer protocol for a CoAP client \n\nfor communication IoT sensor data, (iii) sends a datagram of size up to 216 B, (iv) packetizes the data stack  of Application layer, (v) acknowledged data flow. (a) All except (i) (b) All except (ii) and (v) \n\n(c) All except (iii) (d) (ii) and (iii) 5. (i) The data flow directs downwards in an RPL instance from root at transport \n\nlayer to child nodes and from child node to leaf node at physical layer device node. (ii) The data flow directs upwards in an RPL instance from a leaf or child node to other child node and then to the root. (iii) RPL is IoT/M2M low power loss environment uses RPL protocol. (iv) Internet layer IPv4 receives and transmits from/to adaptation layer when using IEEE 802.2  LAN devices. (v) ROLL is used when network has \n\n\u2605 \n\n\u2605\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605 \n\n152 Internet of Things: Architecture and Design Principles \n\nunconstrained nodes. (vi) When network required high data transfer rate, relative to IP low packet delivery rate, unstable links. (vii) RPL functions in storing mode. (a) All except (i) and (vii) (b) All except (ii) and (v) \n\n(c) (i), (ii) and (iii) (d) (i), (ii) and (iv) 6. IPv6 features are (i) provisioning a larger addressing space, (ii) permitting the \n\nhierarchical address allocation, (iii) route aggregation across the Internet, (iv) limit the expansion of routing tables, (v) provisions additional optimisation for the delivery of services using routers, subnets and interfaces, (vi) manages device mobility, security, and configuration aspects and (vii) provisions expanded and simple use of multicast addressing (viii) provisions 216 B data grams. (a) All except (ii) and (vii) (b) All except (viii) \n\n(c) (i) to (v) (d) (i), (ii) and (iv) 7. HTTP 1.1 supports HTTP specific specified methods (i) GET (ii) POST (iii)  HEAD \n\n(iv) CONNECT (v) PUT (vi) DELETE (vii) TRACE (viii) OPTIONS, and (ix) HTTP 1.1 supports the extension methods included from HTTP 1.1 version onwards. (a) All except (iii) and (vii) (b) All except (ix) \n\n(c) (i) to (v) (d) All 8. 6LoWPAN device node frame size is: \n\n(a) Same is Ethernet frame (b) 256 B \n\n(c) 127 B (d) 216 B 9. Port (i) is an interface to the network using a protocol, (ii) sends a data stack at the \n\noutput to the lower layer, (iii) Port sends a data stack at the output to the Internet layer, (iv) receives data stack at the input from the transport layer, (v) receives data stack at the input from the TLS layer, and (vi) is assigned number according to protocol used for transmission and reception. (a) All (b) All except (iii) and (v) \n\n(c) All except (ii) (d) All except (i) \n\nShort-Answer Questions \n\n1. Why do the header-fields add at a layer before a data stack transfer to a lower layer? \n\n[LO 4.1] 2. What are the header fields in 6LoWPAN? Why is the application data from a device \n\nnode is 33B or 54 B? [LO 4.1] 3. Explain, why IoT device nodes use RPL in place of IPv6 or IPv4, why a CoAP client \n\nin place of HTTP client and 6LoWPAN at the adaptation layer in place of the MAC. \n\n[LO 4.1] \n\n\u2605 \n\n\u2605 \n\n\u2605 \n\n\u2605 \n\n\u2605 \n\n\u2605\u2605 \n\n\u2605 \n\nInternet Connectivity Principles 153 \n\n4. How are header fields formatted and used in unicast IPv6 address? [LO 4.1] 5. Why and how do DODAGs used in RPL? [LO 4.1] 6. A network address is 198.136.x.x. Recognize the class of the network. What can be the \n\nmaximum and minimum values for first decimal number of the network address? What can be the maximum and minimum values for second decimal number of the network address?  How will the network address 198.136.x.x.used to find the subnet address and host? [LO 4.2] 7. How do the subnets enable usage of a limited number of IP addresses in an enterprise \n\nnetwork? [LO 4.2] 8. What do the terms network interface, host, subnet, port, socket and subnet mean? \n\n[LO 4.2] 9. How does the subnet expand a network? [LO 4.2] 10. Explain the commonalities and contrast between HTTP and CoAP. [LO 4.3] 11. What are uses of four types of headers, environmental variables and status codes in \n\nHTTP? [LO 4.3] \n\nReview Questions \n\n1. How does data communicate from a gateway using an IP address after formatting as \n\npackets? [LO 4.1] 2. IoT applications and services layer is using TCP/IP suite application protocols. How \n\ndoes the source-end network layer connect through a set of IP routers with the receiving-end application layer? [LO 4.1] 3. When and how does the UDP datagram communicate from source-end transport \n\nlayer to destination-end application-support layer? [LO 4.1] 4. When and how does TCP stream communicate from source to end using IP packets? \n\n[LO 4.1] 5. What are the features of RPL? How do they enable routing in a lossy environment? \n\n[LO 4.1] 6. Show and explain the header fields in a 6LoWPAN frame, IP packet, TCP stream. \n\n[LO 4.1] 7. Describe class A, B and C networks. [LO 4.2] 8. What is MAC address? How does a MAC address assign to an IoT node? How does \n\naddress resolved to enable packets in IP network reach the node? [LO 4.2] 9. How are the port and port number used? [LO 4.3] 10. Describe the features of HTTP. [LO 4.3] \n\nPractice Exercises \n\n1. Redraw Figure 4.1 for source-end IoT/M2M IoT applications and services layer \n\nconnected through a set of IP routers to send data packets using an IP address and communicating to the devices network layer IP address using TCP/IP suite of application protocols. [LO 4.1] 2. Create a table giving usages of IP, IPv6, RPL, 6LoWPAN, TCP and UDP protocols. \n\n[LO 4.1] 3. Show by diagram, the fields in 127 B data stack which communicate between the IoT \n\ndevice and 6LoWPAN adaptation layer. [LO 4.1] \n\n\u2605\u2605 \u2605\u2605\u2605 \u2605\u2605\u2605 \n\n\u2605 \u2605 \n\n\u2605 \n\n\u2605\u2605 \u2605\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605 \n\n\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605 \n\n\u2605\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605\u2605\u2605 \u2605\u2605\u2605 \n\n\u2605 \u2605\u2605 \n\n\u2605 \n\n\u2605 \n\n\u2605\u2605 \n\n154 Internet of Things: Architecture and Design Principles \n\n4. List the RPL instances in Figure 4.4 for communication from each device node data \n\ntransfer to an access point. [LO 4.1] 5. Create a table for a number of bits in data stack, usages and fields in an IPv4 address, \n\nIPv6 address, routing prefix, subnet address, subnet mask, subnet id, host identifier, and MAC addresses. [LO 4.2] 6. Make a table giving in each row the subnet mask, class of the network address, \n\nsubnet ID, subnet addresses and lsbs of host. Assume four rows have subnet masks for individual subnets = (1111 1111 1111 1111  0001 0000  0000 0000), (1111 1111 1111 1111  0010 0000 0000 0000),  (1111 1111 1111 1111 1110 0000 0000 0000). (1111 1111 1110 1100 0000 0000 0000 0000).  The table gives the identifiers addresses. [LO 4.2] 7. Compare the port, socket and WebSocket by examples. [LO 4.3] 8. Create a table for understanding which port number to use when, for each port. Use \n\nthe port  numbers listed at https://en.wikipedia.org/wiki/List_of_TCP_and_UDP_ port_numbers. [LO 4.3] \n\n\u2605\u2605\u2605 \n\n\u2605 \n\n\u2605\u2605 \n\n\u2605\u2605\u2605 \u2605\u2605\u2605 \n\n",
  "createdAt": "2026-02-17"
}