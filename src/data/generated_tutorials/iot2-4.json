{
  "title": "4",
  "slug": "iot2-4",
  "description": "Module from iot2.pdf: 4",
  "tags": [
    "iot2",
    "Elite"
  ],
  "content": "# 4\n\n\nInternet Connectivity \n\nPrinciples \n\nLearning Objectives \n\nLO 4.1 \nExplain Internet-connectivity protocols\u2014IP, IPv6, RPL, 6LoWPAN, TCP/IP suite, TCP \nand UDP \nLO 4.2 \nDescribe the functions of IP address, MAC address, DNS and DHCP \nLO 4.3 \nExplain the functions of application layer protocols\u2014HTTP, HTTPS, FTP, Telnet and \nPorts \n\nRecall from Previous Chapters \n\nWe learnt about conceptual framework, reference model and reference architecture in Sections \n1.1 and 1.2 in Chapter 1. \n\nEquation 1.2 suggested that data gathers from the devices, enriches at the data adaptation \nstage and the enriched data-stream transfers to manage that at higher stages of data analysis the \nstreaming process uses Internet connectivity. \n\nEquation 1.3 suggested that data gathers from the devices and consolidates at the data \nadaptation stage. Then a gateway connects through Internet to the server and other stages where \ndata of the stream collects, assembles, manages and analyses. \n\nWe learnt that architecture of IoT/M2M has network and transport layers for data streaming \nto server, application or other entities. We learnt about IoT architecture layered model, in which \napplication layer is highest and physical cum data-link layer is the lowest (Figure 2.1). Thus, \ndata receives at a layer i from previous layer j (i > j), when it receives at applications and services \nlayer from the physical cum data-link layer (Section 2.1). \n\nInternet Connectivity Principles \n121 \n\n4.1 \nINTRODUCTION \n\nInternet is a global network with a set of connectivity protocols for: \n\n\u25cf Connected devices gateway for sending the data frames of the devices or to the devices. \nThe data communicate over the network as packets, which communicate through a set \nof routers at the Internet. The processes manage, acquire, organise and analyse the \ndata of the IoT devices for applications, services and business processes. \n\n\u25cf The devices perform the controlling and monitoring functions using the messages, \ndata-stacks and commands sent through the Internet by the applications, services or \nbusiness processes. \nFollowing are some of the key terms and their meanings, which are required for \nunderstanding Internet connectivity principles for communication between connected \ndevices network and IoT applications. \n\nHeader refers to words, which are required for processing a received data stack at a layer \nand which envelopes the data stack of the preceding upper layer before transfer to the \nsucceeding lower layer. Header consists of header fields. Each word has 32 bits. Each \nheader word can have one or more fields. The fields in the words are as per the processing \nrequired at succeeding stages up to the destination. \n\nIP header refers to header fields, which comprise parameters and their encodings as per \nthe IP protocol. IP is Internet layer protocol at the source or destination. \n\nTCP header denotes header fields containing parameters whose encoding is as per the TCP \nprotocol. TCP is transport layer protocol at the source or destination. \n\nProtocol Data Unit (PDU) is the unit of data stack maximum number of bytes, which can be \nprocessed at a layer as per the protocol at a layer or sublayer. \n\nTCP stream is a sequence of bytes or words in the data stack created at the transport layer \nthat transmits to the destination-end transport layer. \n\nWe learnt that connected devices data from gateway use the network and transport protocols \nfor connecting to the subsystems where data of the stream collects, assembles, manages and \nanalyses, and where the applications execute and provide the services. (Section 2.2). An important \naspect is that Internet connectivity is the key architectural element between the applications and \ndevices. \n\nWe learnt in Chapter 3 that Internet connectivity is a basic need from the device-end to \napplications or services-end. The connecting entities use the WPAN protocols for personnel \narea network, and Internet protocols for connectivity with the applications or services. Client- \nserver, pub/sub and other communication modes use the IP protocol at network layer, and TCP \nor UDP at the transport layer, TLS or DTLS for secure connection, and HTTP, WebSocket and \nother application-layer protocols for applications support. \n\n122 \nInternet of Things: Architecture and Design Principles \n\nMaximum Transferable Unit (MTU) is the unit of data-stack maximum number of bytes, \nwhich can be transferred from a higher layer to lower layer or physical network. \n\nPacket is a set of bytes with a fixed maximum specified size that transfers from network \nlayer and communicates from one router to another, until it reaches at physical, data-link \nand network layer at the receiver\u2019s end. Internet technology provisions for packetising the \nreceived data stack at Internet layer for transmission to the next lower layer. Receiving-end \nInternet layer does de-packetising (unpacking) at the layer for sending it to the succeeding \ntransport layer. \n\nIP packet is a data stack, which includes IP header. It communicates from a source IP \naddress through the routers to the destination IP address. \n\nData segment refers to data stack from application-support layer for transport. Application \ndata is divided into the segments when its size is more than the transportable limit. \n\nNetwork interface is a system software component or hardware for facilitating \ncommunication between two protocol layers/computers/nodes in a network. The interface \nsoftware-component provides standard functions. For example, connection establishment, \nclosing and message passing. Network interface examples are port (software or hardware \ncomponent), network interface device and socket. An interface can be addressed by a \nunique port number/socket name/node id. \n\nPort is an interface to the network using a protocol that sends an application layer data \nstack to the lower layer for transmission. The port receives the data stack at the receiver\u2019s \nend from the lower layer. Each port uses an assigned number according to a protocol, \nwhich is used for transmission or reception at the application layer. For example, Port 80 \nis assigned number to HTTP, an application layer protocol. \n\nSocket is a software interface to the network that links to data stack using a port protocol \nand an IP address. Internet data can be considered as communicating between the sockets. \nApplication data can be considered to flow between the sockets at sender and receiver. \n\nHost is a device or node that connects to a network of computers. It provides information, \nresources, services and applications to the other nodes on the network. A network \nlayer assigns a host address to each host. \n\nIP host is the one that uses the Internet protocol suite. An IP host has one or more IP \naddresses for the network interfaces. \n\nSubnet is a subnetwork, which is logical and visible subdivision of an IP network. \nSubdivision enables addressing a set of networked computers in the subnet using a \ncommon and identical IP address. For example, an organisation has 1024 computers but \nuses a common and identical IP address(es). An IP address consists of two groups: msbs \nand lsbs, total 32-bits; msbs means most significant bits in a word, while lsbs means least \nsignificant bits in a set of bits. \n\n\n![Image](/src/assets/generated_images/iot2_p149_i0.png)\nInternet Connectivity Principles \n123 \n\nRouting Prefix: Thirty-two bits IP address can be divided into the msbs consisting of 8, 16 \nor 24 bits and remaining lsbs. The division results in the logical division of an IP address \ninto two fields\u2014a network address or routing prefix field and a rest field or host identifier . \nThe rest field is an identifier for a specific host or network interface. 1 \n\nHost Identifier: The rest field may also have two sub-fields\u2014one for subnet id and other for \nthe host identifier. When a network subdivides into subnets and subnet has a number of \nhosts. \n\nData Flow Graph (DFG) denotes a graphical representation using arrows from one stage to \nanother. A circle represents a stage and arrow characterises the direction of flow of data. \nInputs (for example, incoming data for routing) at each stage compute (process) and cause \nthe outputs from the stage. Inputs at the beginning of a circle continue to flow to the next \ncircle, until the outputs (for example, outgoing data for routing) reach at the end of the \ncircle. Data can be said to flow from beginning to end after being processed in the multiple \nstages in-between. \n\nAcyclic Data Flow Graph (ADFG) refers to a DFG where only one set of inputs generate only \none set of outputs for the given input-set in the DFG model. All inputs are instantaneously \navailable in APDFG, (no delay between various inputs) at each stage, except the processing \ninterval at the stage. Examples of non-acyclic data input are an event input, a status-flag \nset (= 1) or reset (= 0) in a device, and input as per output condition of the previous process. \n\nDirected Acyclic Graph (DAG) means an ADFG in which none of the output cycles back to \na previous processing stage or level or rank as an input during data flow. \n\nFollowing sections describe Internet-connectivity principles for connected devices. \nFor details of the protocols, their usages and implementation, the reader can refer to any \nstandard book on computer network or internet and web technology. \n\n4.2 \nINTERNET CONNECTIVITY \n\nFigure 4.1 shows a source-end network-layer connected \nto the destination through a set of IP routers. It also shows \nthat a communication framework uses an IP address and \ncommunicates with the IoT/M2M IoT application and services \nlayer using TCP/IP suite of application protocols to a destination IP address. \n\nInternet connectivity is through a set of routers in a global network of routers which \ncarry data packets as per IP protocol from a source end to another and vice versa. A source \nsends data packets to a destination using IETF standardised formats. \n\n1 https://www.ietf.org/rfc/rfc7608.txt.pdf \n\nExplain Internet- \n\nconnectivity \nprotocols\u2014IP, IPv6, \nRPL, 6LoWPAN, TCP/ \nIP suite, TCP and UDP \n\nLO 4.1 \n\n124 \nInternet of Things: Architecture and Design Principles \n\nApplication \n\nSmart Sensor \n\nFramework \n\nIoT \nCommunication \n\nFramework \n\nApplication \nFramework \n\nIoT \nCommunication \n\nFramework \n\nGateway \n\nData \nConsolidation \n\nFramework \n\nIoT \nCommunication \n\nFramework \n\nSet of IP \n\nrouters \n\nSet of IP \n\nRouters \n\nSet of IP \n\nRouters \n\nSet of IP \n\nRouters \n\nIoT Application Layer \nTCP/IP Application Protocols \n\nTransport Layer TCP/IP \n\nNetwork Layer \n\nData-link Layer \n\nPhysical Layer \n\nSensor \n\nNetwork \n\nSource-end IP Address \n\nDestination End IP Address \n\nSource End IP Address \n\nFigure 4.1 Source-end network-layer connected through a set of IP routers for data packets from an IP \n\naddress and communicating with IoT/M2M IoT application and services layer using TCP/IP \nsuite of application protocols \n\n4.3 \nINTERNET-BASED COMMUNICATION \n\nWhen data transmits from layer i to the next layer j , following are the actions that occur: \n\n\u25cf Each layer\u2019s processing of data is as per the protocol used for communication by that \nlayer. \n\n\u25cf Each layer sends the data stack received from the previous upper layer plus a new \nheader, and thus creates a fresh stack after performing the actions specified at that \nlayer. \n\n\u25cf Layer j will specify new parameters as per protocol and create fresh stack for the \nsubsequent lower layer. \n\n\u25cf The process continues until data communicates over the complete network. \nRemember that IoT application layer is the highest in the modified OSI model and the \nphysical layer is the lowest (Figure 2.1). Thus, data transmits from layer i to the next layer j , \n(i > j) when it transmits from the application layer to the physical layer. \n\nWhen data is received at the next layer i from a layer j , i.e. IoT device physical layer to the \nIoT application, the following actions are performed: \n\n\u25cf Each layer performs the processing as per the header field bits, which are received \naccording to the protocol to be used for decoding the fields for the required actions at \nthat layer. \n\nInternet Connectivity Principles \n125 \n\n\u25cf Each layer receives the data stack from the previous lower layer and after the required \nactions, it subtracts the header words and creates a new stack specified for the next \nhigher  layer. \n\n\u25cf The process continues until the data is received at the port on the highest application \nlayer. \nUpper layers use the header words alone. Lower layer, such as data-link layer protocol, \nsuch as Ethernet 802.3, provisions for the trailing bits also, in addition to the header words. \nTrailing-bits usage can be as error-control bits and end-of-the frame indicating bits. \nNote: Ethernet frame communicates between the data-link layers of two computers on a \nlocal area network (LAN). 802.3 specifies the maximum frame size of 1518 B (later increased \nto 1522 B) and consists of 32 trailing bits. These are called Frame Sequence Check (FRC) \nbits or Cyclic Redundancy Check (CRC) bits. CRC bits append during transmission. The \nreceiving-end recalculates the CRC from the received data bits. If both of these match, \nthen the frame in the sequence is accepted, else an error is reported. \n\nOnly four OSI model layers, such as 7, 4, 3 and 2 are specified at the TCP/IP protocol \nsuite for Internet communication. Layer 1 is per communication protocol for physical \nlink to routers. Figure 4.2 shows the communication between the source and destination. \nInternet-based TCP/IP communication uses application layer L7, transport L4, Internet L3 \nand link L2 layers. Figure 4.2 shows the PDUs at the layers. \n\nPort for Data from or to Application Layer L7 \n\nL7 Header \nL7 Data Segment \n\nData Stack from L7 or to L7 \n\nUDP Header + \n\nDatagram \nL4 TCP \n\nL3 Header \n\nHeader \nData for TCP Stream \n\nData Stack from L4 or to L4 \n\nL3 IP Packet for the Network \n\nL2Header \nData Stack from L3 \nL2 Trailing Bits \n\nData Stack from L2 (Link Layer) or to L2 \n\nPhysical Layer L1 Layer \n\nPDU = 1518 B \n\nfor Applications \nand Services \n\nPDU\u2013 2 32 B \n\nPDU\u2013 2 16 B \n\nFigure 4.2 TCI/IP suite four layers generating data stack for the network and for physical layer during \n\nInternet communication \n\n126 \nInternet of Things: Architecture and Design Principles \n\nA data segment (maximum 2 32 B per segment) is accepted from L7 layer for transport \nlayer TCP. L4 then generates a TCP stream. The stream packetizes at the Internet layer L3. \nAlternatively, a datagram (maximum 2 14 B) is accepted from L7 layer for transport layer \nUDP usage. L4 then generates a UDP datagram (maximum 2 16 B). The stream packetises at \nthe Internet layer L3 into packets. Packet sent from L3 has maximum size 2 16 B including \nL3 header. The datagram sent from L3 also has maximum size 2 16 B. \n\nInternet layer uses the IP protocol (IPv4 or IPv6 or RPL). Packet routing occurs as: Each \nrouter has information about the path to the destination. When a number of paths are \navailable, then the number of packets of the same source simultaneously follows different \npaths from a router. Destination-end transport layer reassembles the packet according \nto their sequences in the source transport layer data streams. Then the reassembled data \nsegment transfers to IoT application layer at the destination end. \n\nThe data-link layer uses a protocol each in its sublayers. For example, Ethernet IEEE \n802.3, MAC, PPP, ARP, RARP, NDP etc. Ethernet is protocol for logical-link layer on a \nLAN; MAC stands for Media Access Control; PPP stands for Point-to-Point Protocol; ARP \nstands for Address Resolution Protocol; RARP stands for Reverse Address Resolution \nProtocol. Resolution means using network data stack to find the MAC address. Reverse \nmeans MAC address used for finding IP address. NDP stands for Network Discovery \nProtocol. \n\nThe next subsections describe the features in IPv4, IPv6 and RPL. \n\n4.3.1 \nInternet Protocols \n\nInternet layer receives and forwards data to the next layer using IP version 4 (IPv4) or IP \nversion 6 (IPv6) protocol. \n\nInternet Protocol Version 4 \n\nLet n = total number of header words. Figure 4.3 shows data stack received or transmitted \nat or to network layer and IP packet consists of IP header fields of n words (= 160 bits and \nextended header option words). The extension is done when required actions and using \ndata stack from or for the transport layer. \n\nInternet layer protocol is abbreviated as IP and refers to the process when a packet \ntransmits data. The transmission is unacknowledged data flow. IP packet segment consists \nof the data which the Internet layer receives on transfer from the transport layer to the \nreceiver\u2019s end, when using the IP protocol. Protocol data unit, PDU IP = 1 packet and has \nmaximum 2 16 B. PDU IP is the maximum data unit which can transmit or receive at the \nlayer when using IP packets. \n\nFigure 4.3 shows an IP data stack which includes the IP header fields. The figure shows \nthe start and end bit numbers in each word and data. The figure shows the data stack \nreceived or transmitted at or to the Internet layer. The IP packet consists of IP header fields \n160 bits and the extended header consists of ( n \u2013 5) words when required, plus data stack \nof len words from or for the transport layer. \n\nInternet Connectivity Principles \n127 \n\n31 \n16 \nlen [IP Packet length \n\nwords] \n\n15 \n8 \nService Type and \n\nPrecedence \n\n7 \n4 \nService Type and \n\nPrecedence \n\n3 \n0 \nIP \nVersion \n\n63 \n51 \nFragment Offset \n\n50 \n47 \nFlags \n\n46 \n32 \nFirst Byte Sequence Number in the Stream \n\n95 \n80 \nCheck Sum \n\n79 \n72 \nType of Protocol \n\n71 \n64 \nTTL (Time to Live) \n127 \n96 \nSource IP Address \n\n159 \n128 \nDestination IP Address \n\nq \n160 \nOption header words and fields plus the words as padding before the data \n\nv \nq \n\nData Stack of \n= [ \u2013 )/32] words \nV \nv \nq \n\nData Packet (stack) from or to Transport Layer (Maximum Size \n2 \nB \n14 words \n16 \n\nHeader \n\nPacket \nLength \nlen = \n\n/32 \nwords \nv \n\nExtended \nHeader \n\nq \nn \nn \n\nv \nn \n\n= (32 \n\u2013 1), [ \nis number of words \n= 5 words for \nheader plus options \nplus padding words \nfor extension. \nMaximum \n= (2 14 \u2013 ) \n32 \u2013 1 \n\n\u00a5 \n\n\u00a5 \n\nFigure 4.3 Data stack received or transmitted at or to network layer and IP packet consists of IP header \n\nfield 160 bits and extended header up to bit q (extended when required) plus data stack \nfrom or for the transport layer \n\nThe features of IPv4 are: \n\n\u25cf IP header consists of five words. The header can extend when using option and \npadding words. Data stack to the network layer has maximum v = ( n + len ) words \nwhere v <= (2 14 \u2013 n ). \n\n\u25cf Header first, second and third word fields are as shown in the figure (meaning of \nheader fields in the first three words and option words are not given here and the \nreader can refer to the author\u2019s Internet and Web Technology book). \n\n\u25cf Header fourth and fifth words are source IP address and destination IP address. \n\n\u25cf IP protocol transport is half duplex unacknowledged data flow from Internet layer at \none end (End 1) to internet layer of other end (End 2). \n\n\u25cf Each IP layer data stack is called IP packet and this packet is not guaranteed to reach \nthe destination when the transport layer protocol is UDP, and guaranteed to reach the \ndestination when the transport layer protocol is TCP. \n\n\u25cf One packet communicates in one direction at an instance. \n\n128 \nInternet of Things: Architecture and Design Principles \n\nInternet Protocol Version 6 \n\nInternet Protocol Version 6 is a protocol with the following features: \n\n\u25cf Provisions a larger addressing space \n\n\u25cf Permits hierarchical address allocation, and thus route aggregation across the Internet, \nand limit the expansion of routing tables \n\n\u25cf Provisions additional optimisation for the delivery of services using routers, subnets \nand interfaces \n\n\u25cf Manages device mobility, security and configuration aspects \n\n\u25cf Expanded and simple use of multicast addressing \n\n\u25cf Provisions jumbo grams (big size datagram) \n\n\u25cf Extensibility of options \nWhile an IPv4 address is of size 32-bit, the IPv6 address has a size of 128 bits. 2 Therefore, \nIPv6 has a vastly enlarged address space compared to IPv4. The IPv6 address provides \na numerical label. It identifies a network interface of a node or other network nodes \nand subnets participating in IPv6 Internet. A device is the node in the network when it \ncommunicates on a network. \n\nRPL [IPv6 Routing Protocol for Low Power Lossy Networks (LLNs)] \n\nLow Power Lossy Network refers to a constrained nodes network, which has low data \ntransfer rate relative to IP, a low packet delivery-rate and unstable links. IETF has given \nspecifications for RPL for the ROLL network. RPL is a non-storing routing mode. \n\nIoT/M2M low power lossy environment uses RPL protocol. Internet layer IPv6 receives \nand transmits from/to data-adaptation layer (Figure 2.1) when using IEEE 802.15.4 WPAN \ndevices (Figure 2.5). \n\nLow power nodes need to confine communication to the nearest (or at most next) levels \nupwards or downwards. Lossy environment needs disjoint nodes, as in case of error or no \nacknowledgment, a repeat transmission can be made using the same previous instance. \nData communicate with optimum data size at an instance. \n\nData flow between the nodes is as per Destination Oriented Directed Acyclic Graph \n(DODAG) model. Directed acyclic graph is a data flow model between the nodes. \nDestination orientation means either upwards (for transport) or downward directed \n(for device-layer end-node) in a tree-like structure of DODAGs. The following example \nclarifies the DODAG data flow approach for RPL. \n\nExample 4.1 \n\nProblem \n(a) Give an example of the DODAG data-flow approach for RPL assuming routing nodes at four ranks (levels) \n0, 1, 2 and 3 consisting of 3, 6, 3 and 6 nodes, respectively. The node communicates in the RPL network \nenvironment. (b) How do the paths (called RPL instances) establish for DODAG data flow? (c) List the DODAG \ncharacteristics taking the nodes assumed in the example. \n\n2 http://www.webopedia.com/DidYouKnow/Internet/ipv6_ipv4_difference.html \n\nInternet Connectivity Principles \n129 \n\nSolution \n\n(a) An access point can be root of a tree, which enables DODAG data flow for the RPL network. Assume \n\nthat: \n\n\u25cf A 0 is the root node at rank 0. A 1 and A2 are other nodes at rank 0. \n\n\u25cf B 01 and B 02 are A 0 \u2019s child nodes at rank 1 that have upward connectivity to rank 0 and downward \nconnectivity to rank 2 nodes. \n\n\u25cf C 21 , C 22 and C 23 are three nodes at rank 2 that have upward connectivity to B\u2019s at rank 1 and \ndownward connectivity to 3. \n\n\u25cf D 211 and D 212 are C 21 \u2019s child nodes at rank 3. D 221 and D 222 are the C 22 \u2019s child nodes. D 231 and D 232 \nare the C 23 \u2019s child nodes. \n\nFigure 4.4 shows RPL network nodes at four ranks, and RPL data-flow instances for upward and \n\ndownward flow. \n\nA0 \n\nB01 \n\nA2 \n\nC21 \n\nD211 \n\nA1 \n\nB11 \n\nC22 \n\nB12 \nRank 1 \n\nRank 0 \n\nB21 \n\nC23 \n\nB22 \n\nD231 \nD232 \nD212 \n\nB02 \n\nD221 \nD222 \nRank 3 \n\nRank 2 \n\nFigure 4.4 RPL network nodes at four ranks and RPL data-flow instances for upward and downward \n\nflow \n\n\nRanks 0, 1, 2 and 3 thus have 1, 2, 3 or 6 nodes communicating in the network. Consider that devices \n\nare at rank 3 and destination access point is at rank 0. DOADG in RPL specifies that all data flow is \nupward directed and will be from a rank 3 node to a rank 2 node, a rank 2 node to a rank 1 node, and \na rank 1 node to the destination node rank 0. Data flow upwards can also be from a rank 3 node to a \nrank 1 node in case sufficient power is present at the node D211. \n\n\nSimilarly, all data flow downwards will be from a rank 0 node to a rank 1 node, a rank 1 node to a rank \n\n2 node and a rank 2 node to the destination node, rank 3. Data flow downwards can also be from a \nrank i node to a rank i + 2 node in case sufficient power is present, where i is an integer greater or \nequal to 0, and i + 2 maximum value can be j , if leaf nodes (end nodes) are rank j . \n\n(b) Paths (called RPL instances) establish using the Directed Acyclic Graph (DAG) Information Option \n\n(DIO) messages. The messages are broadcast to seek new connectivity instance, called RPL instance. \nEach node selects a parent. This is based on the received DIO messages. Each node calculates its rank \nin the tree. \n\n\nSuppose rank 0 node, A0 broadcast the DIO to find a possible node with which it can connect and \n\ncommunicate. Assume two rank 1 nodes, B 01 and B 02 respond. Other nodes at rank 1 may not respond \ndue to insufficient power. Other nodes at rank 2 may also not respond due to the need of higher power, \nwhich may not be there in the DIOs. \n\n130 \nInternet of Things: Architecture and Design Principles \n\n\nAssume rank 2 node, C 011 also responds to B01, C 012 also responds to B01, and then the downward \n\npaths A0-B01-C011, A0-B02-C012 establish, and upward path builds which forms the tree. DIOs \nincludes a node\u2019s rank (its level) and enable the tree-like structure of RPL nodes and also establishes \nRPL instances at a given instance. \n\n(c) DODAG characteristics are thus: \n\n\u25cf DODAGS are disjoint (no shared nodes) \n\n\u25cf Many-to-one communication: Upwards, where nodes at rank k can communicate to one node m at \nlower or higher in rank, where k < m \n\n\u25cf One-to-many communication: Downwards, where nodes at rank m can communicate to one node \nm at lower or higher in rank, where k > m \n\n\u25cf Point-to-point communication: Upwards or downwards where a node at rank m communicates with \nanother node at rank k , where m < k or m > k \n\n\u25cf RPL instances create with objective of optimisation \n\n\u25cf Multiple RPL instances with different optimisation objectives can coexist \n\n\u25cf Root node or parent node need not use RPL instances to next to next ranks by keeping power level \njust sufficient to communicate with the nearest rank nodes. DODAG thus minimises the cost to the \nroot per objective function. \n\nThe data flow directs downwards in an RPL instance from root at transport layer to \nchild nodes and from child node to leaf node at physical layer device node. The data flow \ndirects upwards in an RPL instance from a leaf/child node to another child node and then \nto the root. DODAGs are no share nodes (disjoint). \n\nThe features of RPL are: \n\n\u25cf A routing protocol for the LLNs \n\n\u25cf RPL-controlled messages are Destination Advertisement Object (DAO), DODAG \nInformation Object (DIO) and DAG Information Object (DIO) \n\n\u25cf Transfers data at an RPL instance data point to point (one device nodes to one receiver \nnode) as well as point to multipoint (one to many device nodes) or multipoint to point \n(many device nodes to one receiver node) \n\n\u25cf Sends or receives multiple DODAGs at each  instance \n\n\u25cf Sends data from DODAGs to DODAG root or DODAG leaves to support low data \ntransfer rate, compared to IP low packet delivery rate \n\n\u25cf Supports unstable links \n\n\u25cf Has optimisation objective for an RPL instance \n\n\u25cf Supports coexistence of different optimisation objectives using multiple RPL instances \n\n\u25cf Supports nodes, inform parents of their presence and reach ability to descendants \nusing DIOs \n\n\u25cf Supports soliciting (seeking) information of a DODAG using DIS \n\n\u25cf Supports destination, inform nodes for discovery of an RPL instance, know about \nconfiguration parameters and select DODAG parents using DIOs \n\nInternet Connectivity Principles \n131 \n\n4.3.2 \n6LoWPAN \n\nInternet layer IPv6 receives and transmits from/to adaptation \nlayer (Figure 4.1). The data stack uses 6LoWPAN (IPv6 Over Low \nPower Wireless Personal Area Network) protocol at adaptation \nlayer before the data stack transmits to IPv6 Internet layer. An \nIEEE 802.15.4 WPAN device has a 6LowPAN interface serial port \nfor connectivity. \n\n6LoWPAN is an adaptation-layer protocol for the IEEE 802.15.4 network devices. The \ndevices are the nodes having low speed and low power. They are the WPAN nodes of a \nmultiple device mesh network. \n\nLow-power devices need to limit data size per instance. Data compression reduces data \nsize. Fragmentation of data also reduces data size per instance. Features of 6LoWPAN \nare header compression, fragmentation and reassembly. When data is fragmented before \ncommunication, the first fragment header has 27 bits which includes the datagram size (11 \nbits) and a datagram tag (16 bits). Subsequent fragments have header 8 bits which include \nthe datagram size, datagram tag and the offset. Fragments reassembly time limit can be \nset equal to 60s. \n\nFigure 4.5 (a) shows networked i devices physical layer in IEEE 802.15.4 WPAN. \nFigure 4.5 (b) shows data-link sublayer and adaptation layer 6LoWPAN protocol. \n\nIEEE 802.15.4 \nDevice Node Frame \n127 B \n\nIPv6 Header 40 B \n\nUDP Header 8 B \n\nIEEE 802.15.4 \nDevice \n\nSecurity 21B \n\nMAC \nHeader 25 B \n\nApp Data 33B \n\nReassembly \n\nIPv6 Link \nLayer \nMTU 1280 B \n\nFragmentation \n\n[Bytes \nfor and from \nNetwork \nLayer] \n\n127 B \n\n94 B \n\nPhysical/Data-link Layer \nAdaptation Layer 6LoWPAN Protocol \n\n(a) \n(b) \n\n10s of Bytes of Device \nApp data \n\nDevice 1 \n\nDevice 2 \n\n......... \n\n......... \n\nDevice ( \u2013 1) \ni \n\nDevice i \n\nMax. 33 Bytes App \nData at Single Data \nTransfer \n\nFigure 4.5 (a) Networked i devices at physical layer in IEEE 802.15.4 WPAN and (b) Adaptation layer \n\n6LoWPAN protocol 127 B (maximum) fragmented frames reassembly into IPv6 maximum \n1280 B or  fragmentation of IPv6 MTU 1280 B into 127 B frames for transfer to a device. \n\n6LoWPAN protocol \nis used at Adaptation \n\nlayer before a data \nstack transmits to IPv6 \n\nInternet layer \n\n132 \nInternet of Things: Architecture and Design Principles \n\nFigure 4.5 shows that IPv6 over IEEE 802.15.4 standard network nodes uses the \nheaders, security and application data as follows: IPv6 header = 40 B; UDP header = 8 B; \ndevice node MAC address = 25 B; AES-128 security = 21 B; Total device node frame size \n= 127 B (maximum). Therefore, maximum 33 Octets are left for the application data from \nthe device. MAC is data communication protocol sublayer at the data-link layer (Refer \nExample 2.4 and Section 2.4.1 for meaning and usages of AES). \n\nIPv6 Maximum Transmission Unit (MTU) at link layer = 1280 B. Therefore, link-layer \nframe fragmentation is needed in order to communicate frame of 127 B over IEEE 802.15.4 \nnodes (device). The frame MTU is 1280 B for transmission to network layer. Fragments \nfrom frames from the device of 127 B each reassemble into an IPv6 frame. Also, IPv6 MTU \nat data-link layer 1280 B fragments into frame of 127 B each for single transfer to a device \nnode. \n\n6LoWPAN has the following features: \n\n\u25cf Specifies the IETF recommended methods for reassembly of fragments, and IPv6 and \nUDP (or ICMP) headers compression (6LoWPAN-hc adaptation layer), neighbour \ndiscovery (6LoWPAN-nd adaptation layer), and \n\n\u25cf Supports mesh routing \nICMP stands for Internet Control Message Protocol. Routers or other devices on the \nnetwork send error messages or relay the query messages. \n\n6LoWPAN can be implemented using Berkley IP implementation with operating system \nTinyOS or 3BSD or other implementations for IoT nodes from Sensinode or Hitachi or \nothers. IPv6 network layer has two options, viz. RH4 routing header and hop-to-hop \nheader RPL option. \n\n4.3.3 TCP/IP Suite \n\nTCP/IP suite means a set of protocols with layers for the Internet. \nApplication layers protocol examples are HTTPS, HTTP, \nMQTT, XMPP, SOAP, FTP, TFTP, Telnet, PoP3, SMTP, SSL/TLS \nand others for communication using TCP stream. DNS, TFTP, \nBootpc, Bootps, SNMP, DHCP, CoAP, LWM2M and others are \nfor datagram communication using UDP. Application layer security protocols are TLS \nand DTLS. \n\nTCP is a transport layer, connection-oriented protocol that enables acknowledged data \nflow. \n\nUDP is another transport layer protocol that is a connectionless protocol and is meant \nfor datagram communication. Other protocols in the TCP/IP suite for the transport layer \nare RSVP and DCCP. \n\nInternet layer protocol is IPv4/IPv6/RPL/ICMP/ICMPv6/IPSec or other. Data-link layer \nprotocol is PPP/ARP/RARP/NDP, MAC or other. A MAC protocol is Ethernet or DSL or \nISDN or other. \n\nFigure 4.6 shows the protocol layers and representative protocols at each layer. \n\nTCP/IP suite of \nprotocols most used \nprotocols for the global \n\nInternet networking \n\nInternet Connectivity Principles \n133 \n\nDTLS \nDatagram \n(PDU = 2 B) \n16 \n\nTLS \n\nSegment PDU = 2 \nB \n32 \n\nNetwork \nManagement \n\nND, RPL \n\nTransport UDP \n\nDatagram \n\nPacket PDU = 2 \nB \n16 \n\nInternet Layer IPv4/IPv6 \n\nPDU = 1 Frame \n\nARP/RARP Data-link Layer \n\nWiFi/Ethernet \nAdaptation \n6Lo WPAN, CoAP, LWM2M \n\nApplication Layer Protocols (DNS, \nTFTP, Bootpc, Bootps, SNMP, DHCP, \n\nCoAP, LWM2M \n\nApplication Layer Protocols (HTTPS, \nHTTP, MQTT, XMPP, SOAP, FTP, TFTP, \n\nTelnet, PoP3, SMTP) \n\nTransport Layer TCP \nAcknowledged Data Flow Stream \n\nFigure 4.6 \nIoT TCP/IP suite of protocols for Internet \n\nTCP/UDP Transport Layer for the Data Stack from or to Application Layer Port \n\nFollowing subsections describe the TCP and UDP transport layer protocols. TCP/IP \ntransport layer receives or transmits the data segment and datagram from or to a port at \nthe application layer. Following subsections describe TCP and UDP protocols. \n\nTCP \n\nTransport layer uses TCP when the receiver acknowledges \nthe successful segment sequence number (within a specified \ninterval) and remaining data segment sequences retransmit to \nthe receiver. TCP also process data segment (maximum 2 32 B \nfrom application-layer port but transmits the segment part only. \nThe size of actual data transmission in a TCP stream instance depends on network traffic \nconditions. When congestion is high, less number of words in the packets are sent for the \nreceiver-end Internet layer L3. \n\nProtocol data unit, PDU TCP is the maximum data unit which can transmit or receive at \nthe layer when using the TCP stream. PDU TCP = 1 segment and 1 segment maximum value \n= 2 32 B. TCP stream means transmitted or received data from or to the layer in a sequence \nduring one cycle of transmission and acknowledgement of data stack. \n\nFigure 4.7 shows TCP data stack which includes TCP header fields. The figure shows \nstart and end bit numbers in each word and data. The figure shows the data stack received \n\nTCP protocol is used \nfor the acknowledged \n\ndata flow and almost \n\nconfirmed delivery \n\n134 \nInternet of Things: Architecture and Design Principles \n\nor transmitted at or to transport layer stream consisting of TCP header field 160 bits and \nextended header words up to q th bit when required, plus data stack of len words from or \nfor the application layer. \n\nThe features of TCP protocol are as follows: \n\n\u25cf TCP header consists of five words. The header can be extended by using option words \nand padding words. Data stack to next layer or data packet to router has maximum \nv = ( n + len ) words where v <= (2 14 \u2013 n ). \n\n\u25cf Header first word fields are as follows: Upper 16 bits are for the source port number \nand lower 16 bits are for the destination port number. Second and third words are \nshown in Figure 4.7. \n\n\u25cf Header fourth word upper 16 bits, lower 16 bits and header fourth word upper 16 bits, \nlower 16 bits are as shown in Figure 4.7. \n\n\u25cf TCP protocol transport is a full-duplex acknowledged data flow from the transport \nlayer at one end (End 1) to the transport layer of the other end (End 2). \n\n31 \n16 \nDestination Port \n\nNumber \n\n15 \n0 \nSource Port \n\nNumber \n\n63 \n31 \nFirst Byte Sequence Number in the Stream \n\n95 \n64 \n\n127 \n112 \nw \n\nlen \nn \n[TCP Byte Stream \nsize, \n+ ) words] \n\n159 \n144 \nurgent [Data End \nPointer (Location of \n\n143 \n128 \nCheck Sum \n\nq \n160 \nOption header words and fields plus the \n\nwords as padding before the data \n\nv \nq \n\nData of \nwords \n= ( + \n) \n32 \u2013 1 \nlen \nv \nn \nlen \u00a5 \n\nHeader \n\n111 \n96 \nFlag (6-bit), \nReserved (6 bit) plus \nExtended \nHeader \n\nn \nq = (32 \u00a5 n \u2013 1), \n\n[ is number of \nwords = words \nfor header plus \noption plus \npadding words \n\nData Stack, \nfrom or to \nApplication \nlayer \n\nNext Expected Sequence Number in the \nAcknowledgement \n\nData Offset (4-bit) \n\nData Stack last word)] \n\nFigure 4.7 Data stack received or transmitted at or to transport layer stream consisting of TCP header \n\nfield 160 bits (5 words) and extended-header words (= n \u2013 5), extension is when required, \nplus data stack of len words from or for the application layer \n\nInternet Connectivity Principles \n135 \n\n\u25cf Each TCP layer data stack reaches the destination almost each time. This is because \nretransmission takes from the next of last acknowledged sequence number to another \nsequence number. Difference in numbers is called window size between two numbers. \n\n\u25cf One TCP connection communicates in one direction at an instance. \n\n\u25cf Acknowledged flow means that the request as well as response messages communicate \nin unicast mode. End 2 sends acknowledgement message and the header field of that \nconveys expected sequence number from transmitter by the receiver End 2. \n\n\u25cf TCP is connection-oriented. The connection first establishes using a connection \nestablishment procedure adopted when transmitting a TCP data stack for the first \ntime. The connection closes using a connection closing procedure adopted when the \nlast sequence completes transmission of the TCP segment stack. \n\nUniversal Datagram Protocol (UDP) \n\nApplication may need to transmit through the transport layer \nwhen no acknowledgment is needed from the receiver, and when \ndata in a transporting instance limits to a datagram of size 2 16 B \nincluding the header words enveloped at the layer. Then TCP/IP \ntransport layer protocol is Universal Datagram Protocol (UDP). \nDatagram means data that it is just one message, which does not \ncorrelate with the next message or preceding message during \nan end-to-end transmission. UDP is also a protocol for the constrained environment and \nROLL environment (Section 3.1). \n\nUDP header fields are 2 words (1 word = 32 bit) and optionally of 4 words (when \nincluding source and destination IP addresses, and is for communication of application \nlayer stack (For example, DNS, TFTP, Bootpc, Bootps, SNMP, DHCP) or an application- \nsupport layer protocol stack (for example, CoAP or LWM2M). \n\nFigure 4.8 shows the UDP datagram format for transfer to the network layer during \ntransmission or to the application layer during reception. The figure shows UDP header \nfields. The figure also shows a pseudo header of 2 words (64 bits) for source and destination \nIP addresses, which the next layer can use. \n\nThe features of UDP protocol are as follows: \n\n\u25cf UDP header consists of two words. Data stack to network layer has maximum m words \nwhere m <= (2 14 \u2013 2). Header first word fields are as follows: Upper 16 bits are for the \nsource port number and lower 16 bits are for the destination port number. Header \nsecond word upper 16 bits are length and lower 16 bits are checksum. \n\n\u25cf UDP protocol transport is a half-duplex unacknowledged data flow from the transport \nlayer at one end (End 1) to the transport layer of the other end (End 2). \n\n\u25cf Each UDP layer data stack may or may not reach the destination due to unacknowl- \nedged flow. \n\n\u25cf One UDP connection communicates in one direction at an instance between two ends. \n\nUDP protocol is used \nfor the unacknowledged \n\ndata flow when an \napplication datagram \n\ntransmits on the \n\nInternet \n\n136 \nInternet of Things: Architecture and Design Principles \n\n31 \n0 \nSource IP address \n\n63 \n32 \nDestination IP address \n\n31 \n16 \nDestination Port \n\nnumber \n\n15 \n0 \nSource Port \n\nnumber \n15 \n32 \nCheck Sum \n63 \n16 \nLength \n(4 \nm + 8) B \n\u00a5 \np \n64 \n\nm \np \nm \n\nwords \n= ( \n+ 4) \n32 \u2013 1 \n\u00a5 \n\nPseudo \nHeader \n\nHeader \n\nData stack \n\nfrom or to \nApplication \n\nlayer \n\nFigure 4.8 Transport layer UDP header fields with data stack from the application layer and pseudo \n\nheader of 2 words (64 bits) for source and destination IP addresses \n\n\u25cf Half duplex means that at a given instance only one direction, End 1 to End 2 or End 2 to \nEnd 1, is functional. Unacknowledged flow means that the request as well as response \nmessages communicate in broadcast mode. End 2 does not send an acknowledgement \nmessage. \n\n\u25cf UDP is connectionless. It thus permits multicasting (means to multiple destinations). \nConnection-less means no connection establishment procedure is adopted when \ntransmitting a UDP data stack for the first time and no connection closure procedure \nis adopted. \n\nReconfirm Your Understanding \n\n\u25cf Internet layer forwards data to the next layer using IP protocol. Internet connectivity is through a \nset of routers in a global network of routers. Routers carry data packets as per IP protocol from a \nsource end to a destination and vice versa. \n\n\u25cf Four layers for Internet communication through physical layer are application, transport, Internet \nand data-link layers. Internet communication layers use the TCP/IP suite of protocols. \n\n\u25cf Application, transport and Internet layers add the header words in the data stack for transmission to \nthe next layer as new data stack. Data-link layer adds the header words as well as the trailing bits \nat the end before transmitting using physical layer. \n\n\u25cf Transport layer uses TCP or UDP. The Internet layer uses IP version 4 (IPv4) or IP version 6 (IPv6) \nor RPL. \n\nInternet Connectivity Principles \n137 \n\n\u25cf Application layer communicates a data segment or a datagram. It depends on the kind of protocol \n(or port) used by the layer. \n\n\u25cf Application layer communicates a data segment (maximum 2 32 B per segment) from L7 layer and \ngenerates a TCP stream at the transport layer using TCP. The stream packetises (maximum 2 16 B per \npacket) at the Internet layer. \n\n\u25cf Alternatively, the application layer communicates a datagram (maximum 2 16 B) at L7 layer for \nsending a UDP datagram from the transport layer. \n\n\u25cf The Internet layer uses an IP protocol for packet or message forwarding.  IP protocol is IPv4 or IPv6 \nor RPL or other. \n\n\u25cf RPL communication instance uses DODAG data flow. \n\n\u25cf The Internet layer in IPv6 receives and transmits from/to data-adaptation layer when using IEEE \n802.15.4 WPAN devices. \n\n\u25cf The data stack uses 6LoWPAN protocol at the adaptation layer before data stack transmits to IPv6 \nInternet layer. \n\n\u25cf UDP header has fields for source and destination port numbers. \n\n\u25cf TCP header has fields for sequence number of the data segment from where the data stack \ncommunicates and for window size which specifies the number of transmitting bytes. \n\n\u25cf IP packet header has fields for IP version and source and destination IP addresses. \n\nS elf-Assessment E xercise \n\n1. Why does a header add when a data stack transfers from a higher layer to a \n\nlower layer? Why does a header subtract when data stack transfers from a \nlower layer to a higher layer? \n2. How do four layers generate data stack for the network and physical layers \n\nduring Internet communication? Show diagrammatically. \n3. Compare the features in IPv4 and IPv6. \n4. How do packets route over the Internet using a set of four routers between \n\nsource and destination? Show diagrammatically. \n5. What are the features of RPL? \n6. List the features of 6LoWPAN. \n7. Make a table for the application layer and corresponding protocol used at \n\ntransport for the application/service/business process in TCP/IP suite of \nprotocols. \n8. List the header fields in a UDP header and their functions. \n9. List the functions of the header fields in an IP header when packets transmit \n\nbetween source and destination. \n10. List the functions of the header fields in a TCP header at the transmitting \n\nend. How are the fields used when sending an acknowledgement from the \nreceiver end? \n\n\u2605 \n\n\u2605\u2605 \n\n\u2605\u2605 \n\u2605\u2605\u2605 \n\n\u2605 \n\u2605 \n\u2605\u2605 \n\n\u2605 \n\u2605\u2605 \n\n\u2605\u2605\u2605 \n\nNote: \n\u2605 Level 1 & Level 2 category \n\n\u2605\u2605 Level 3 & Level 4 category \n\n\u2605\u2605\u2605 Level 5 & Level 6 category \n\n\n![Image](/src/assets/generated_images/iot2_p164_i0.png)\n138 \nInternet of Things: Architecture and Design Principles \n\n4.4 \nIP ADDRESSING IN THE IoT \n\nAn IP header consists of source and destination addresses, \ncalled IP addresses. The Internet generally uses IPv4 addresses. \nIoT/M2M use IPv6 addresses. Following subsections describe \nthe addressing schemes. \n\n4.4.1 \nIP Address \n\nIP version 4 address consists of 32 bits. However, it can be considered as four decimal \nnumbers separated by dots. For example, 198.136.56.2 for 32 bits\u201411000110 10001000 \n00111000 00000010. Each decimal number is decimal value of an Octet (= 8 bits). IP addresses \ncan be between 0.0.0.0 to 255.255.255.255; total 2 32 addresses due to 32-bit address. Three \nseparate fields with a decimal number each for each set of 8 bits are easier to use. Let\u2019s see \nan analogy with postal network addressing method. Consider an address: \n\nMcGraw-Hill Education, \n2 Pennsylvania Plaza, \nNew York City, \nUSA. \n\nIn the above example, three fields are separated by a comma and a new line each. A \nmail routes to the destination using the address. First the mail routes to USA, then to \nNew York City, then to Pennsylvania Plaza and then the final destination.  Similar are the \nactions, when a packets route to a destination IP address from a source IP address. \n\nEach device or node which communicates on the Internet must have an IP address. The \nnumber of nodes or devices can be very large. Recall Figure 4.1 where a communication \nframework communicates with number of sensors. Each sensor or device is assigned \nthe addresses used internally. The framework communicates with the Internet with one \nIP address externally to the applications. One solution for a large number of nodes is \ndividing the network into Internet address and subnet address. \n\nFor example, 2 Pennsylvania Plaza, New York City, USA may be a globally visible \naddress. Internally, the mail is to be directed to which individual at McGraw-Hill Education \nis decided by an internal distribution network, invisible to the outside world. \n\nAlternatively, New York City, USA may be a globally visible address. Internally, the \nmail to be directed to which individual at McGraw-Hill Education, 2 Pennsylvania Plaza \nis decided by an internal distribution network, invisible to outside world. \n\nInternet address is visible to outside world means it is visible to the routers on the \nInternet. Subnet address is for use within the group internally and is invisible to the \noutside world. A subnet is a subnetwork consisting of number of hosts or nodes or devices \nor machines. \n\nA subnet mask and network 32-bit IP address after ANDing operation gives individual \nsubnet address.  Logical AND operation with complement of subnet mask with the IP \naddress gives the host identifier on the subnet. Example 4.3 will clarify the procedure. \n\nDescribe the \nfunctions of IP \naddress, MAC address, \n\nDNS and DHCP \n\nLO 4.2 \n\nInternet Connectivity Principles \n139 \n\nIP address 198.136.56.2 is visible on the Internet. Number of servers, such as web server, \nmail server and FTP server are invisible and these have the same IP address globally and \nseparate addresses internally on a subnet of server or nodes or devices. \n\nAn IP address serves the purpose of uniquely identifying an individual network \ninterface of a host. The interface locates on the network using that address. The address \nenables routing of IP packets between the hosts. IP addresses are present in fields of the \npacket header for routing. The header indicates both source and destination of the packet. 3 \n\nStatic IP address \n\nA static IP address is the one assigned by the Internet service provider. The service provider \nmay provide an individual just one address. When a company has a number of hosts, a \nservice provider may provide a class C network address consisting of a group of 254 \n(= 2 8 \n\nhow the allocations of static addresses are made to a group of hosts. \n\nExample 4.2 \n\nProblem \nHow are IP addresses allotted to a group of hosts on the Internet? What do class A, B, C and D network mean \nwhen using the subnets? Give an analogy with postal network for communication to McGraw-Hill Education, \n2 Pennsylvania Plaza, New York City, USA. \n\nSolution \n\nA group of hosts on the Internet are allotted IP addresses as follows: \nClass A network group address means address n . x . x . x , where x is between 0 to 255 and n is between 1  and \n126 for the addresses between 1.0.0.0 and 126.x.x.x. This is because the IP address 32-bit has msb bit 31 \n= 0. \n\nThree x.x.x specifies a network group of 2 24 \u2013 2 hosts, just as USA specifies a large group of addresses in \nUSA. Minus 2 is because all 0s and all 1s in .x.x.x are not allotted in subnet. \n\nClass B network group address means address n . m . x . x , where x is between 0 to 255 and n.m is between \n128.1 to 191.254 for the addresses between 128.1.0.0 and 191.254.x.x. This is because the IP address 32- \nbit has two msb bits 31\u201330 = 10. \nTwo x.x specifies a network group of (2 16 \u2013 2) hosts, just as New York City, USA specifies a group of addresses \nin New York City, USA. [Minus 2 is because all 0s and all 1s in .x.x are not allotted in subnet.] \n\nClass C network group address means address n . m . k . x , where x is between 0 to 255 and n.m.k is between \n192.0.1 and 223.255.254 for the addresses between 192.0.1.0 and 223.255.254.x.  This is because the IP \naddress 32-bit has three msb bits 31-30-29  = 110. \nOne  . x specifies a smaller group of (2 8 - 2) hosts, just as 2 Pennsylvania Plaza, New York City, USA specifies \na group of addresses at 2 Pennsylvania Plaza, New York City, USA and one of them is McGraw-Hill education. \nMinus 2 is because all 0s and all 1s in msbs 11 or 00 in 8 bits in .x not allotted in subnet. \n\nClass D addresses are for multicasting and are from 224.0.0.0 and are less than 240.0.0.0. \nAddress 0.x.x.x is a reserved address. Address 127.x.x.x is also a reserved address. \n\n3 http://www.webopedia.com/DidYouKnow/Internet/ipv6_ipv4_difference.html \n\n140 \nInternet of Things: Architecture and Design Principles \n\nExample 4.3 gives the method of finding the subnet address and host on the subnet \nusing the IP address and subnet mask of a subnet in case of classifications A, B, C and D \nfor the allocations of static addresses to a group of hosts. \n\nExample 4.3 \n\nProblem \nA subnet and its hosts communicate with the Internet using a subnet mask. How does the IP address and \nsubnet mask find the subnet address and host on the subnet? What is the procedure for evaluation of subnet \naddress and host address? \n\nSolution \n\nAn IP address consists of two parts: Upper bits (msbs) are for the network address and lower bits (lsbs) are \nfor the subnet address and the individual host. Upper bits in a subnet mask allot for each node to address \nthat node with the address of group of hosts on a subnet. Subnet mask bits depend on the class of the \nnetwork group address. Mask bits are as follows: \n\nClass A network group address node has a subnet mask and the mask consists of all eight msbs = 11111111 \nand remaining 24 bits are set as per the subnet and host address. Subnet id is invisible to the outside world \nof the Internet. These 24 bits identify the host on a subnet. Class A group subnet masks are 2 24 \u2013 2 for \n2 24 \u2013 2 hosts. \n\nClass B network group address node has a subnet mask and the mask consists of all sixteen msbs = 1s and \nremaining 16 bits are set as per the subnet id and host address at the subnet invisible to the outside world \nof the Internet.  Last 16 bits identify subnet and the host on that subnet. Class B group subnet masks are \n2 16 \u2013 2 for 2 16 \u2013 2 hosts. \nClass C network group address node has a subnet mask and the mask consists of all 24 msbs = 1s and \nremaining 8 bits are set as per the subnet id and host address on the subnet. Subnet id is invisible to the \noutside world of the Internet. Last 8 bits identify a subnet id and the host on that subnet. Class C group \nsubnet masks are 2 8 \u2013 2 for 2 8 \u2013 2 subnet plus host address bits. \n\nFollowing is the procedure for evaluation of subnet address and host address: \n\nSuppose 14 hosts function as subnets on a network. Assume that a Class C network group address when \nnetwork communication is with 14 subnets. Each subnet thus identifies by 4 higher bits after the network \naddress 24 bits. Therefore, subnet mask will 24 msbs as 1s plus 4 higher bits among 8 remaining bits in the \nsubnet mask will be 1s. Subnet masks for an individual subnet will be (1111 1111 1111 1111 1111 1111 \n0001 0000), (1111 1111 1111 1111 1111 1111  0010 0000), \u2026to  (1111 1111 1111 1111 1111 1111 1110 \n0000). \nANDing of 32-bit IP group address and 32-bit subnet mask gives the internal subnet address. Higher \n4 bits identify the individual subnet among the 14 subnets functioning as host. Subnet address is network \naddress bits plus 4 subnet identifier bits and plus 4 bits 0000 in the example given in above paragraph. \nANDing of complement of 32-bit subnet mask with 32-bit IP group address gives the host identifier the \nexternal IP address for the Internet. \n\nIf 30 hosts function as subnets, then subnet mask will 24 msbs as 1s plus 5 higher bits among 8 remaining \nbits in the subnet mask will be 1s. This is because 30 equals 2 5 \u2013 2. Then last 3 bits of subnet mask will be \n000. \n\nInternet Connectivity Principles \n141 \n\nA new scheme, called Classless Inter-Domain Routing (CIDR) is used nowadays. For \nexample, Class C 198.136.56.0/4 means Class C allotted four IP addresses for Internet \nrouting by 4 public domain servers. The system administrator at a company allots servers \nfor each of the 4 IP addresses, for the same domain name. \n\nDynamic IP address \n\nOnce a device connects to the Internet, it needs to be allotted an individual IP address. \nWhen the device connects to a router, the router and device use the DHCP (Dynamic Host \nControl Protocol) which assigns an IP address at an instance to the device. This address \nis called dynamic IP address. When a device disconnects or switches off or the router \nboots again, then the dynamic IP address is lost and a new allocation takes place when the \ndevice reconnects. \n\nDNS \n\nConsider an IP address, 198.136.56.2 (11000110 10001000 00111000 00000010). It is difficult \nto remember or use. The domain name for the address is rajkamal.org. Access to web- \nserver hosted at the domain is made using the website name, http://www.rajkamal.org/. \nAccess to mail-server hosted at the domain is made using the mail server name, http:// \nmail.rajkamal.org/. Another example of domain name is mheducation.com/. \n\n.com, .org, .in and .us are called Top Level Domain (TLD). A TLD can further be \nsubdivided as .co.in or .gov.in. or .gov.uk. \n\nA registrar provides domain names at a certain cost per year. The DNS server at the \nRegistrar has a control panel (cPanel) and can be configured using cPanel. Domain Names \nSystem (DNS) is an application which provides an IP address for a corresponding service \nfrom the named domain service. \n\nDHCP \n\nWhen a sensor, actuator or IoT device or node needs to connect to the Internet, a server \ncalled DHCP server provides a dynamic IP address, subnet mask, and ARP and RARP \ncaches. The server (subnet) has its own IP address to provide connectivity to the Internet. 4 \n\nDynamic Host Configuration Protocol (DHCP) is a protocol to dynamically provide \nnew IP addresses and set subnet masks for the connected node so that it can use the \nsubnet server and subnet router at the communication framework. \n\nIP addresses are configured. An administrator or user does this process. DHCP enables \nthe process of configuring IP addresses automatically at start-up. \n\nA node has a software component for sending requests to the DHCP server and receiving \nresponses. The component is called DHCP client . DHCP client protocol communicates \nwith a server. Steps in the DHCP protocol for dynamically configuring the IP address and \nother networks are: \n\n1. The DHCP client broadcasts a discover-request, known as DHCPDISCOVER. \n\n4 https://www.ietf.org/rfc/rfc2131.txt \n\n142 \nInternet of Things: Architecture and Design Principles \n\n2. A DHCP server listens to DHCPDISCOVER and finds the configuration, which can \n\nbe offered to the client. Server(s) send(s) the configuration parameters, including an \nIP address not presently in use, at the subnet. The configuration parameters are in \nthe DHCPOFFER for the offered configuration. \n3. The selected DHCP server creates and manages bindings. DHCP server also sets a \n\ntime interval during which the offered IP address will be valid for the DHCP client \nnode. \n4. The DHCP server confirms the binding through a message. It sends DHCPACK after \n\ncreating the binding. \n5. When the node with the DHCP client computer leaves the subnet, it sends a \n\nDHCPRELEASE message. If the client does not send DHCPRELEASE within a \nspecified time interval, then the server frees the created binding. \n6. The server and client also use authentication protocols before considering the \n\nDHCPDISCOVER from a client and before accepting a DHCPOFFER, respectively. \nThe DHCP protocol guarantees that any assigned network address, at a given instant, \nis in use by either one DHCP client or none. \n\n4.4.2 \nIPv6 Address \n\nDevices (nodes) for IoT need large number of addresses. IPv6 uses 128-bit address. A \nhexadecimal digit represents 4-bit, 0 hex = 0000 binary to f hex = 1111. Therefore, 128-bit \naddress has 32 hexadecimal digits. Eight sets of 4 hex-digits are each separated by a colon \nor dot in an IPv6 address. Example is 16-hexadecimal digits, 40a0: 0acb:8a00:b372:0000: \n0000:0000:0000. IANA manages the allocation process for IPv6 addresses; 64 bits in the last \nwhen all zeros then can be omitted. \n\nDevices in mesh network may use 6LoWPAN protocol at the adaptation layer and Ipv6 \nwhen communication framework communicates on the Internet using IPv6. Last 64 bits \nare interface identifiers. An interface may have a distinct node. \n\nIPv6 addresses are classified into three classes. Each class differs in primary addressing \nand routing methods. An interface may be at a distinct node. Unicast address is for a single \nnetwork interface. 48 bit or more in unicast specify routing prefix . 16 bit or less specify a \nsubnet id . 64 bit are interface identifiers. \n\nAnycast address means address of a group of nodes or interfaces. A packet sent to an \nanycast address is delivered to just one of the member interfaces. One may be the nearest \nhost. Nearest is measured according to the routing protocol\u2019s definition of distance. \n\nMulticast address means an address used by multiple hosts, which acquires the multicast \naddress destination by participating in the multicast distribution protocol among network \nrouters. A packet with multicast address delivers to all interfaces that have joined the \ncorresponding multicast group. \n\nInternet Connectivity Principles \n143 \n\n4.5 \nMEDIA ACCESS CONTROL \n\nEach network connected node has an MAC address. A device node receives data stacks \nusing its MAC address. Media means physical media, fibre or wire using which a device or \nnode accesses the Internet. The nodes can use the same physical network and IP address. \nNode means an IoT device or sensor or actuator or controller or computer, the data-link \nlayer of which communicates to the Internet.  MAC address is 48 bit. \n\nEach network card or Ethernet protocol using a communicating node  has a unique MAC \naddress for the source and destination node addresses. Ethernet frame communicates \nbefore the data stack source-node MAC address and destination-node MAC address. \nMAC address of each node is specified in the firmware of the network card or chip or core. \n\nUsage of ARP enables each node to be addressed by the MAC address. The node \nreceives the network data from a router having an IP address. Usage of RARP enables \neach node for sending on the network the data to a router having an IP address. \n\nAddress Resolution Protocol (ARP) uses a lookup table. The \nnetwork 32-bit address provides MAC address of the individual \nnode using that table. RARP also uses that lookup table. The \ntable stores the IP address in one column. MAC address is in \nanother column in each row. Number of rows is equal to the number of nodes connected \nto the Internet. An individual node MAC address provides the network a 32-bit address \nfor the Internet using the table. The lookup table is a table in which a value in a column \nof a row is used as a key to look for another value or a set of parameters from another \ncolumn(s) of the row. \n\nARP cache serves as building up of the table for the address translation of the data \nstack received at the Internet layer to the node MAC address. Whenever the first time the \nnetwork sends the receiver IP and MAC addresses, or a node sends the sender MAC and \nIP addresses, they save a cache called ARP cache. The cached addresses build a lookup \ntable for the next communication between the node and the network. The process enables \nthe node to transmit and receive the IP packets at the new IP address from the Internet by \nthe address resolution. \n\nAlternatively, an address can be stored locally in a memory card or flash memory \nof a board or microcontroller chip. Software, when the microcontroller starts, read this \naddress. The board or chip connects to the Ethernet LAN uses the saved MAC address. \nThe chip connects to the Internet using this address and RARP. The chip receives IP data \nstack using ARP. \n\nARP and RARP could \n\nbe used for address \n\ntranslation \n\nReconfirm Your Understanding \n\n\u25cf IP version 4 address consists of 32 bits. However, it can be considered as four decimal numbers \nseparated by dots. For example, 198.136.56.2 for 32 bits. Each decimal number\u2019s value is between \n0 and 255. \n\n144 \nInternet of Things: Architecture and Design Principles \n\n\u25cf A subnet is a network of devices or nodes or machines or computers which connect using a common \nIP address. The Internet Service Provider allocates a common IP address to a group of subnets and \ntheir hosts.  Each subnet in the group has a subnet mask. \n\n\u25cf Class A network address corresponds to the biggest group of subnets and hosts [maximum (2 24 \u2013 2)] \non a subnet (msb bit 31 =  0). \n\n\u25cf Class B network address corresponds to a big group of subnets and hosts [maximum (2 16 \u2013 2)] on a \nsubnet (Two msb bits 31-30  = 10). \n\n\u25cf Class C network address corresponds to a small group of subnets and hosts (maximum [2 16 \u2013 2)] on \na subnet (Three msb bits 31-30-29  = 110). \n\n\u25cf Class D addresses corresponds to a multicasting address. \n\n\u25cf An IPv6 address is a 128-bit address, consisting of 32 hexadecimal digits. Example is 16-hexadecimal \ndigits, 40a0: 0acb:8a00:b372:0000: 0000:0000:0000. IANA manages the allocation process for IPv6 \naddresses. 64 bits in the last when all zeros, then they can be omitted. \n\n\u25cf IPv6 addresses are classified into three classes: unicast , anycast and multicast addresses. 128 bits \nhas 64 bits as interface identifier, 16 or fewer bits for subnet id and remaining msbs are the routing \nprefix. \n\n\u25cf DNS is a domain name system to translate top-level domain and domain names into IP address and \nvice versa. The name can easily be remembered. The names are registered. \n\n\u25cf An IP address can be static or dynamic. Dynamic IP is generated as follows: A DHCP server configures \nand provides an IP address for the Internet for a certain specific interval. A DHCP client seeks from \na DHCP server and discovers the IP address. \n\n\u25cf ARP finds the node (device) MAC address at data-link layer from the Internet layer IP address. The \nnode (device) data-link layer with a MAC address connects to the Internet using an IP address.  RARP \nfinds the IP address using the MAC address. \n\nS elf-Assessment E xercise \n\n1. List the uses of IP addresses of source and destination on the Internet. \n2. A service provider provides a class C network address to a company. How \n\nmany subnets and hosts can communicate with the Internet? \n3. List the features of Class A, B, C and D network addresses. \n4. An enterprise has number of subnets and hosts. How does a subnet host \n\nconnect to the Internet? \n5. A subnet mask is 1111 1111 1111 1111  1001 0000 0000 0000. IP address is \n\n198.136.56.2. How do these figures provide subnet and host addresses? \n6. How do the fields in IPv6 unicast, anycast and multicast addresses differ? \n7. How does a domain name correlate with the URLs for mail and web servers? \n8. What are the steps in DHCP protocol for allocation of a dynamic IP address? \n9. Why is each node provided a fixed MAC address? When a new IoT device is \n\nmade, then an MAC address is placed in the firmware. Why? \n10. How is an ARP cache used? Show it diagrammatically. \n\n\u2605 \n\u2605 \n\n\u2605\u2605 \n\u2605\u2605\u2605 \n\n\u2605\u2605\u2605 \n\n\u2605\u2605 \n\u2605\u2605 \n\u2605\u2605 \n\n\u2605 \n\n\u2605\u2605 \n\n\n![Image](/src/assets/generated_images/iot2_p171_i0.png)\nInternet Connectivity Principles \n145 \n\n4.6 \nAPPLICATION LAYER PROTOCOLS: \nHTTP, HTTPS, FTP, TELNET AND OTHERS \n\nTCP/IP suite consists of a number application layer protocols. \nFor example, HTTP, HTTPS, FTP, Telnet and others. A port \nuses a protocol for sending and receiving messages. A TCP/IP \nmessage must be sent from the right port at the transmission \nend and to the right port at the receiver end, else the receiver port does not listen. \n\n4.6.1 HTTP and HTTPS Ports \n\nHyper Text Transfer Protocol (HTTP) port number is 80. A web HTTP server listens to port \n80 only and responds to port 80 only. An HTTP port sends application data stack at the \noutput to the lower layer using the HTTP protocol. 5 \n\nAn HTTP port uses a URL like http://www. mheducation.com/. The default port is \ntaken as 80. The port number can be specified after the TLD. For example, after \u2018.com\u2019 in \nURL http://www. mheducation.com:80/. \n\nHTTPS (HTTP over Secure Socket Layer or TLS) port number is 443. An HTTPS port \nsends a URL; for example,  https://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_ \nnumbers.  Here, TLD is .org, domain name is wikipedia.org and Subdomain name is en. \nResource URL is at /wiki/List_of_TCP_and_UDP_port_numbers. \n\nThe port receives the data stack at the input at the receiver end. Each port at the \napplication layer uses a distinct protocol. A port is assigned a number according to \nprotocol used for transmission and reception. \n\nThe important features of HTTP are: \n\n\u25cf HTTP is the standard protocol for\u00b7 requesting a URL defined web-page resource, and \nfor sending a response to the web server. An HTTP client requests an HTTP server on \nthe Internet and the server responds by sending a response. The response may be with \nor without applying a process. \n\n\u25cf HTTP is a stateless protocol. This is because for an HTTP request, the protocol assumes \na fresh request. It means there is no session or sequence number field or no field that \nis retained in the next exchange. This makes a current exchange by an HTTP request \nindependent of the previous exchanges. The later exchanges do not depend on the \ncurrent one. E-commerce like application needs a state management mechanism. The \nstateless feature of HTTP is compensated by a method as: A cookie is a text file which \ncreates during a particular pair of exchanges of HTTP request and response. The \ncreation is either at a CGI or processing program. For example, JavaScript or script or \nat a client. A prior exchange may then depend on this cookie. The cookie thus provides \nan HTTP state management mechanism. \n\n5 http://www.w3.org/Protocols/ \n\nExplain the \nfunctions of \nApplication Layer \nprotocols\u2014HTTP, \nHTTPS, FTP, Telnet and \n\nPorts \n\nLO 4.3 \n\n146 \nInternet of Things: Architecture and Design Principles \n\n\u25cf Basically, HTTP is a file transfer-like protocol. We use it more efficiently than the \nFTP (a protocol for a file transfer on the Internet) because in FTP, we have to give a \ncertain command. Then, a communication establishes between two systems just to \nretrieve a specified file. On the other hand, HTTP is simple. There are no command \nline overheads. This makes it easy to explore a website URL. A request (from a client) \nand reply (from a server) is the paradigm. \n\n\u25cf The HTTP protocol is very light (a small format) and thus speedy as compared to other \nprotocols, such as FTP. HTTP is able to transfer any type of data to a client provided it \nis capable of handling that data. \n\n\u25cf HTTP is flexible. Assume during a client web connection, the connection breaks. The \nclient can start by re-connecting. Being a stateless protocol, HTTP does not keep track \nof the state as FTP does. Each time a connection establishes between the web server \nand the client, both these interpret this connection as a new connection. Simplicity is a \nmust because a webpage has the URL resources distributed over a number of servers. \n\n\u25cf HTTP protocol is based on Object Oriented Programming System (OOPS). Methods \nare applied to objects identified by a URL. It means as in the normal case of an Object \nOriented Program, various methods apply on an object. \n\n\u25cf Following features have been included from HTTP 1.0 and 1.1 version onwards: \n(a) Multimedia file access is feasible due to provision for the MIME (Multipurpose \nInternet Mail Extension) type file definition. \n\n\u25cf Eight HTTP specific specified methods and extension methods included from HTTP \n1.1 version onwards. The HTTP specific methods are as follows. 1. GET. 2. POST. \n3. HEAD. 4. CONNECT. 5. PUT. 6. DELETE. 7. TRACE. 8. OPTIONS. (Last four from \n1.1.) \n\n\u25cf Earlier versions, GET follows a space and then the document name. The server returns \nthe documents and closes the connection. The POST method permits form processing \nas using it the client transmits the form data or other information to the server from \n1.1.  Also, the server does not close the connection after response and thus response \ncan be processed before it is sent. \n\n\u25cf A provision of user authentication exits besides the basic authentication. \n\n\u25cf Digest Access Authentication prevents the transmission of username and password as \nHTML or text from HTTP 1.1 version onwards. \n\n\u25cf A host header field adds to support those ports and virtual hosts that do not accept \nor send IP packets. An Error report to Client when an HTTP request is without a Host \nheader field from HTTP 1.1 version onwards. \n\n\u25cf An absolute URL is acceptable to the server. In the earlier version, only a proxy server \naccepted that. \n\n\u25cf Message Headers uses are: A message during a request from a client or during a response \nfrom a server consists of two parts\u2014a start-line, none or several message-headers \n(fields) and empty line, and body of the message. Message headers are: \n\nInternet Connectivity Principles \n147 \n\n\u274d Common (general) headers are added when requesting a server and when responding \n\nto a client. A header includes MIME version, OPTIONS, cacheable or not cacheable, \nand transfer to close or not close the connection. \n\n\u274d Request headers are for a request and client information to a server. The header \n\nincludes acceptable media or preferred specification\u2014specifies about acceptability \nof HTML or HTML or text or any other type informs if a special type of character \nset acceptable. \n\n\u274d Entity headers contain information about the entity body contained in the message \n\nor in case the body is not present then information about the entity is not present \nits body. For example, information for content-length in bytes. \n\n\u274d Response headers are present in the response for server information to a client. \n\n\u25cf Status codes add in the response and caching of a resource provided at a server (and \nproxy). For example, status code returned as response when 400 means a bad request \n(the request unrespondable), 401 unauthorized request, 402 means request requires a \npayment before response feasible, 403 means request is for a forbidden resource and \n404 means URL resource not found by the server. \n\n\u25cf Byte range specification helps an HTTP server to send large response in parts. Length \nspecification helps in presentation in chunks. \n\n\u25cf Selection among various characteristics on retrieval by the client is feasible when \na server sends a response to the client request. For example, the two characteristics, \nlanguage and encoding can be specified in the server environment variables while the \nclient sends the request header for retrieving a resource. The resource then retrieves in \nthat language and with that encoding. The contents sent to the client do not change, only \nthe way in which these are presented to the client change. The environment variables \nfor the way in which a resource retrieves could not be changed at the server in the \nearlier HTTP versions before 1.1. \n\n4.6.2 Other Ports \n\nThe IANA reserves the port numbers.  The numbers are between 0 \nand 1023. They are well-known ports. System process or software \nconnects to them. Port number 0 means the host itself. Internet \nAssigned Number Authority (IANA) registers a registered port \nnumber which is according to a specific protocol. Registered numbers are between 1024 \nand 49151. These are registered ports. 2 12 numbers between 49152 are unregistered, left \nfor assignment and use by users. System process or software connects to them. A user \nunregistered server has a port number above 5000. \n\nA list of widely used ports is available at https://en.wikipedia.org/wiki/List_of_TCP_ \nand_UDP_port_numbers. \n\nTCP/UDP registered \nports and unregistered \n\nports \n\n148 \nInternet of Things: Architecture and Design Principles \n\nExample 4.4 \n\nProblem \nGive examples of registered port numbers and the protocols which each port uses. \n\nSolution \n\nExamples are as follows: \n\nPort \n\nNumber \n\n17 \n21 \n23 \n25 \n53 \n79 \n80 \n108 \n110 \n\nProtocol \nUsers List \nFTP \nTelnet \nSMTP \nDNS \nFinger \nHTTP \nSNA-GAS \nPoP3 \n\nPort \n\nNumber \n\n161 \n389 \n443 \n547 \n1293 \n2095 \n5222 \n5223 \n5683 \n\nProtocol \nSNMP \nLDAP \nHTTPS \nDHCPServer \nIPsec \ncPanel (default use \nis for web mail) \n\nXMPP \nXMPP-SSL \nCoAP \n\nFTP is a file transfer protocol. It is a stateful protocol. Telnet is for remote connection to \na computer. SMTP is for mail transfer and PoP3 for mail retrieval from a mail server. \n\nA port supports multiple logical connections between a source at an IP address and \ndestination at another IP address. A socket consisting of port and IP sends application \ndata stack on the Internet to another socket at another IP address and port. \n\nReconfirm Your Understanding \n\n\u25cf HTTP, HTTPS, FTP, Telnet, SMTP, DNS, DHCP, PoP3, SNMP, LDAP, XMPP, XMPP-SSL, CoAP, LWM2M and \nIPSec are protocols for the application layer/application-support layer ports. \n\n\u25cf A URL specifies the protocol when sending a request for a resource. For example, http://, coap://, \nhttps:// and ws:// before a domain name. \n\n\u25cf HTTP is stateless communication. A method is used to save states during communication in web \napplications. \n\n\u25cf An HTTP client is used for a web server for requesting a webpage as response from an HTTP server. \n\n\u25cf An HTTPS port is for an HTTP message over a secure socket layer or TLS. \n\n\u25cf A port sends a TCP/IP message to a receiver port. IANA assigns a port number for each protocol. A \nreceiver port listens only if the sender port is using the right port and sends to the right port. \n\n\u25cf A port number associates a protocol at the application/application-support layer. For example, port \nnumber 80 associates HTTP. \n\nInternet Connectivity Principles \n149 \n\nS elf-Assessment E xercise \n\n1. What are the functions of HTTP, HTTPS, FTP, Telnet, CoAP and LWM2M \n\nports? \n2. What is the advantage of a receiver port not listening to a message unless sent \n\nusing the right port at transmission end and received at the right port at the \nreceiver end? \n3. What do the terms language and encoding specify in the server environment \n\nvariables while client sends the request header for retrieving a resource? \n4. List the features of HTTP. \n5. List the usages of eight HTTP specific specified methods. \n6. What are the message header types and the uses of each in HTTP 1.1? \n7. What are the advantages of a server response consisting of a status code? \n8. How does function of a port differ from that of a socket? \n9. List the 16 port numbers along with their protocols. \n10. Why is it that IANA registers a port number and assigns it a specific protocol? \n\n\u2605 \n\n\u2605\u2605 \n\n\u2605 \n\n\u2605\u2605\u2605 \n\n\u2605 \n\u2605\u2605 \n\n\u2605 \n\u2605\u2605 \n\u2605\u2605\u2605 \n\u2605\u2605\u2605 \n\nKey Concepts \n\n\u25cf 6LoWPAN \n\n\u25cf ARP \n\n\u25cf Class A, B and C \n\n\u25cf Data segment \n\n\u25cf DHCP \n\n\u25cf DNS \n\n\u25cf Header \n\n\u25cf Header fields \n\n\u25cf Host \n\n\u25cf HTTP \n\n\u25cf HTTPS \n\n\u25cf IP \n\n\u25cf IP router \n\n\u25cf IPv6 \n\n\u25cf MAC address \n\n\u25cf MTU \n\n\u25cf Packet \n\n\u25cf PDU \n\n\u25cf Port \n\n\u25cf RARP \n\n\u25cf RPL \n\n\u25cf Subnet \n\n\u25cf TCP \n\n\u25cf TCP header \n\n\u25cf TCP/IP \n\n\u25cf UDP \n\n\u25cf UDP header \n\nLearning Outcomes \n\nLO 4.1 \n\n\u25cf Internet communication is through the routing of packets. A packet has a maximum 2 16 B. \nPacket routing for Internet communication is as follows: Each router has information about the \npath to the destination for the packets. When a number of paths are available at an instance, \nthen number of packets of same source simultaneously follows different paths from a router. \nDestination-end transport layer reassembles the packet according to their sequences in \nsource transport layer data streams.  Then, the reassembled data segment transfers to the IoT \napplication layer at the destination end. \n\n150 \nInternet of Things: Architecture and Design Principles \n\n\u25cf Four layers for Internet communication are application, transport, Internet and data-link \nlayers. These layers use the TCP/IP suite of protocols for Internet communication. TCP/IP suite \nis a set of protocols with layers for the Internet. \n\n\u25cf Application layer protocol is HTTPS, HTTP, MQTT, XMPP, SOAP, FTP, TFTP, Telnet, PoP3, \nSMTP, SSL/TLS or other when a TCP stream communicates. The protocol is DNS, TFTP, Bootpc, \nBootps, SNMP, DHCP, CoAP, LWM2M or other when a datagram communicates using UDP. \n\n\u25cf Application layer security protocol is TLS or DTLS. \n\n\u25cf Transport layer protocol is TCP or UDP or RSVP, DCCP or other. TCP feature is acknowledged \ndata flow and ensuring delivery of all sequences in the segment. UDP is unacknowledged data \nflow. \n\n\u25cf Internet layer protocol is IP protocol (IP v4/IPv6/ RPL)/ICMP/ICMPv6/IPSec or other. Internet \nlayer uses an IP protocol for packet forwarding. \n\n\u25cf Data-link layer protocol example is Ethernet, MAC, PPP, ARP, RARP or NDP. \n\n\u25cf Adaptation layer protocol is 6LoWPAN for IEEE 802.15.4 IoT/M2M devices. \n\n\u25cf RPL is a non-storing routing mode protocol. IoT/M2M low power lossy environment uses RPL \nprotocol. Internet layer IPv6 receives and transmits from/to data-adaptation layer   when using \nIEEE 802.15.4 WPAN devices \n\nLO 4.2 \n\n\u25cf Internet communication between routers uses IP addresses. IPv4 address is 32-bit address and \nIPv6 of 128-bits. \n\n\u25cf A subnet is a network of devices, nodes, machines or computers, which connect using a common \nIP address. Internet Service Provider allocates a common IP address to group of subnets and \ntheir hosts.  Each subnet in the group has a subnet mask. \n\n\u25cf Three types of classes\u2014A, B and C network address corresponds to a group of subnets and \nhosts. \n\n\u25cf IPv6 address is 128-bit address, which has 32 hexadecimal digits. IPv6 addresses are classified \ninto three classes: unicast , anycast and multicast addresses. \n\n\u25cf DNS is a domain name system to translate IP address into names and names into IP addresses. \n\n\u25cf IP address can be static or dynamic. Dynamic IP generates using DHCP client and server. \n\n\u25cf Internet layer IP address using ARP finds the node (device) MAC address at data-link layer. \nThe node (device) data link layer with a MAC address connects  Internet using an IP address \nRARP  finds the IP address \n\nLO 4.3 \n\n\u25cf A port sends a TCP/IP message to a receiver port. An HTTP or HTTPS port is for sending a \nrequest and receiving the response. \n\n\u25cf IANA assigns a port number for each protocol for the Internet. A receiver port listens to only if \nsender port is using right port and sends to right port. \n\n\u25cf HTTP, HTTPS, FTP, Telnet, SMTP, DNS, DHCP, PoP3, SNMP, LDAP, XMPP, XMPP-SSL, CoAP, \nLWM2M and IPSec are the protocols for the application layer/application support layer ports. \n\n\u25cf A URL specifies the protocol when sending request for a resource, for example, http://, coap://, \nhttps:// and ws:// before a domain name. \n\n\u25cf A port number associates a protocol at the application/application-support layer. For example, \nport number 80 associates HTTP. \n\nInternet Connectivity Principles \n151 \n\nExercises \n\nObjective Questions \n\nSelect one correct option out of the four in each question. \n\n1. TCP/IP protocol suite for IoT application/service/business process consists of: \n\n(a) Application, application-support, security, transport, network, adaptation and \n\ndata-link layer protocols \n(b) Security, transport, network, data-link layer protocols \n\n(c) Transport and Internet layer protocols \n(d) Security, transport and Internet layer protocols \n2. TCP protocol (i) almost guarantees successful reception of all packets, (ii) specifies \n\nthat if within a specified interval, there is no acknowledgement of last sent \nsequence number for the messages or the acknowledged sequence number is less \nthan the last sequence number, then the unacknowledged sequences retransmits. \n(iii) The acknowledged sequence number of data stack may be received after the \ninterval, (iv) receiver end not receiving packets, (v) header field provisions for the \nmultiple acknowledgements, and (vi) window size is large. Duplicate and triplicate \nacknowledgements in TCP are because of: \n(a) (ii) \n(b) (ii) and (iii) \n\n(c) (i) \n(d) (i) and (vi) \n3. (i) Transport layer protocol is UDP when the application layer protocol is DNS, TFTP, \n\nBootpc, Bootps, SNMP, DHCP, CoAP or LWM2M, (ii) Internet layer protocol is IPv4/ \nIPv6/RPL/ICMP/ICMPv6/IPSec. (iii) Transport and IP layers use a header field for \nerror detection. (iv) Data-link layer uses CRC bits for error detection. \n(a) All except (i) \n(b) All except (iv) \n\n(c) All except (iii) \n(d) All \n4. UDP (i) is Internet layer protocol, (ii) is Transport layer protocol for a CoAP client \n\nfor communication IoT sensor data, (iii) sends a datagram of size up to 2 16 B, \n(iv) packetizes the data stack  of Application layer, (v) acknowledged data flow. \n(a) All except (i) \n(b) All except (ii) and (v) \n\n(c) All except (iii) \n(d) (ii) and (iii) \n5. (i) The data flow directs downwards in an RPL instance from root at transport \n\nlayer to child nodes and from child node to leaf node at physical layer device node. \n(ii) The data flow directs upwards in an RPL instance from a leaf or child node to other \nchild node and then to the root. (iii) RPL is IoT/M2M low power loss environment \nuses RPL protocol. (iv) Internet layer IPv4 receives and transmits from/to adaptation \nlayer when using IEEE 802.2  LAN devices. (v) ROLL is used when network has \n\n\u2605 \n\n\u2605\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605 \n\n152 \nInternet of Things: Architecture and Design Principles \n\nunconstrained nodes. (vi) When network required high data transfer rate, relative to \nIP low packet delivery rate, unstable links. (vii) RPL functions in storing mode. \n(a) All except (i) and (vii) \n(b) All except (ii) and (v) \n\n(c) (i), (ii) and (iii) \n(d) (i), (ii) and (iv) \n6. IPv6 features are (i) provisioning a larger addressing space, (ii) permitting the \n\nhierarchical address allocation, (iii) route aggregation across the Internet, (iv) limit the \nexpansion of routing tables, (v) provisions additional optimisation for the delivery of \nservices using routers, subnets and interfaces, (vi) manages device mobility, security, \nand configuration aspects and (vii) provisions expanded and simple use of multicast \naddressing (viii) provisions 2 16 B data grams. \n(a) All except (ii) and (vii) \n(b) All except (viii) \n\n(c) (i) to (v) \n(d) (i), (ii) and (iv) \n7. HTTP 1.1 supports HTTP specific specified methods (i) GET (ii) POST (iii)  HEAD \n\n(iv) CONNECT (v) PUT (vi) DELETE (vii) TRACE (viii) OPTIONS, and (ix) HTTP 1.1 \nsupports the extension methods included from HTTP 1.1 version onwards. \n(a) All except (iii) and (vii) \n(b) All except (ix) \n\n(c) (i) to (v) \n(d) All \n8. 6LoWPAN device node frame size is: \n\n(a) Same is Ethernet frame \n(b) 256 B \n\n(c) 127 B \n(d) 2 16 B \n9. Port (i) is an interface to the network using a protocol, (ii) sends a data stack at the \n\noutput to the lower layer, (iii) Port sends a data stack at the output to the Internet layer, \n(iv) receives data stack at the input from the transport layer, (v) receives data stack at \nthe input from the TLS layer, and (vi) is assigned number according to protocol used \nfor transmission and reception. \n(a) All \n(b) All except (iii) and (v) \n\n(c) All except (ii) \n(d) All except (i) \n\nShort-Answer Questions \n\n1. Why do the header-fields add at a layer before a data stack transfer to a lower layer? \n\n[LO 4.1] \n2. What are the header fields in 6LoWPAN? Why is the application data from a device \n\nnode is 33B or 54 B? \n[LO 4.1] \n3. Explain, why IoT device nodes use RPL in place of IPv6 or IPv4, why a CoAP client \n\nin place of HTTP client and 6LoWPAN at the adaptation layer in place of the MAC. \n\n[LO 4.1] \n\n\u2605 \n\n\u2605 \n\n\u2605 \n\n\u2605 \n\n\u2605 \n\n\u2605\u2605 \n\n\u2605 \n\nInternet Connectivity Principles \n153 \n\n4. How are header fields formatted and used in unicast IPv6 address? \n[LO 4.1] \n5. Why and how do DODAGs used in RPL? \n[LO 4.1] \n6. A network address is 198.136.x.x. Recognize the class of the network. What can be the \n\nmaximum and minimum values for first decimal number of the network address? \nWhat can be the maximum and minimum values for second decimal number of the \nnetwork address?  How will the network address 198.136.x.x.used to find the subnet \naddress and host? \n[LO 4.2] \n7. How do the subnets enable usage of a limited number of IP addresses in an enterprise \n\nnetwork? \n[LO 4.2] \n8. What do the terms network interface, host, subnet, port, socket and subnet mean? \n\n[LO 4.2] \n9. How does the subnet expand a network? \n[LO 4.2] \n10. Explain the commonalities and contrast between HTTP and CoAP. \n[LO 4.3] \n11. What are uses of four types of headers, environmental variables and status codes in \n\nHTTP? \n[LO 4.3] \n\nReview Questions \n\n1. How does data communicate from a gateway using an IP address after formatting as \n\npackets? \n[ LO 4.1 ] \n2. IoT applications and services layer is using TCP/IP suite application protocols. How \n\ndoes the source-end network layer connect through a set of IP routers with the \nreceiving-end application layer? \n[ LO 4.1 ] \n3. When and how does the UDP datagram communicate from source-end transport \n\nlayer to destination-end application-support layer? \n[ LO 4.1 ] \n4. When and how does TCP stream communicate from source to end using IP packets? \n\n[ LO 4.1 ] \n5. What are the features of RPL? How do they enable routing in a lossy environment? \n\n[LO 4.1] \n6. Show and explain the header fields in a 6LoWPAN frame, IP packet, TCP stream. \n\n[LO 4.1] \n7. Describe class A, B and C networks. \n[LO 4.2] \n8. What is MAC address? How does a MAC address assign to an IoT node? How does \n\naddress resolved to enable packets in IP network reach the node? \n[ LO 4.2 ] \n9. How are the port and port number used? \n[LO 4.3] \n10. Describe the features of HTTP. \n[ LO 4.3] \n\nPractice Exercises \n\n1. Redraw Figure 4.1 for source-end IoT/M2M IoT applications and services layer \n\nconnected through a set of IP routers to send data packets using an IP address \nand communicating to the devices network layer IP address using TCP/IP suite of \napplication protocols. \n[LO 4.1] \n2. Create a table giving usages of IP, IPv6, RPL, 6LoWPAN, TCP and UDP protocols. \n\n[LO 4.1] \n3. Show by diagram, the fields in 127 B data stack which communicate between the IoT \n\ndevice and 6LoWPAN adaptation layer. \n[LO 4.1] \n\n\u2605\u2605 \n\u2605\u2605\u2605 \n\u2605\u2605\u2605 \n\n\u2605 \u2605 \n\n\u2605 \n\n\u2605\u2605 \n\u2605\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605 \n\n\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605 \n\n\u2605\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605\u2605\u2605 \n\u2605\u2605\u2605 \n\n\u2605 \n\u2605\u2605 \n\n\u2605 \n\n\u2605 \n\n\u2605\u2605 \n\n154 \nInternet of Things: Architecture and Design Principles \n\n4. List the RPL instances in Figure 4.4 for communication from each device node data \n\ntransfer to an access point. \n[LO 4.1] \n5. Create a table for a number of bits in data stack, usages and fields in an IPv4 address, \n\nIPv6 address, routing prefix, subnet address, subnet mask, subnet id, host identifier, \nand MAC addresses. \n[LO 4.2] \n6. Make a table giving in each row the subnet mask, class of the network address, \n\nsubnet ID, subnet addresses and lsbs of host. Assume four rows have subnet masks \nfor individual subnets = (1111 1111 1111 1111  0001 0000  0000 0000), (1111 1111 1111 \n1111  0010 0000 0000 0000),  (1111 1111 1111 1111 1110 0000 0000 0000). (1111 1111 \n1110 1100 0000 0000 0000 0000).  The table gives the identifiers addresses. \n[LO 4.2] \n7. Compare the port, socket and WebSocket by examples. \n[LO 4.3] \n8. Create a table for understanding which port number to use when, for each port. Use \n\nthe port  numbers listed at https://en.wikipedia.org/wiki/List_of_TCP_and_UDP_ \nport_numbers. \n[LO 4.3] \n\n\u2605\u2605\u2605 \n\n\u2605 \n\n\u2605\u2605 \n\n\u2605\u2605\u2605 \n\u2605\u2605\u2605 \n\n",
  "createdAt": "2026-02-17"
}