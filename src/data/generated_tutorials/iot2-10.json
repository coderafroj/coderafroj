{
  "title": "10",
  "slug": "iot2-10",
  "description": "Module from iot2.pdf: 10",
  "tags": [
    "iot2",
    "Elite"
  ],
  "content": "# 10\n\nIoT Privacy, Security and Vulnerabilities Solutions \n\nLearning Objectives \n\nLO 10.1 Explain the requirements of privacy and security, vulnerabilities from threats, and need of threat-analysis in IoT LO 10.2 Familiarise with modelling using use cases and misuse cases LO 10.3 Outline security tomography of large networks and layered attacker model LO 10.4 Examine functions for source identity-management, identity-establishment, device messages access-control, message-integrity, message non-repudiation and availability in IoT applications and services LO 10.5 Describe security model, security profiles and security protocols for IoT \n\nRecall from Previous Chapters \n\nChapter 1 introduced IEEE P2413 standard which provisions for reference architecture that builds upon a reference model. The reference architecture covers the definition of basic architectural building blocks and their integration capability into multitiered systems. The framework includes the provisions for the quality \u2018quadruple\u2019 trust that includes protection, security, privacy and safety. \n\nThe chapter also introduced communication modules for IoT that include a cryptographic protocol TLS or DTLS for secure Internet communication, and DeviceHive for M2M platforms and their integration that includes web-based management software which creates security rules-based networks and monitors the devices. \n\nIoT Privacy, Security and Vulnerabilities Solutions 397 \n\nChapter 2 introduced data privacy and security steps. For example, a device data can be encrypted at physical (device) layer for security on the network. The devices can opt for link-level as well as service-level security, just the service level or unsecured level. Example of service level is use of TLSv1.2 public key (RSA and ECC) and PSK cipher suite for providing the transport level security end-to-end security protocols. End-to-end means application layer to physical layer. The chapter also introduced usage of Wireless Protected Access (WPA) and Wired Equivalent Privacy (WEP) security sublayer because wireless communication needs security, integrity and reliability. \n\nChapter 3 described features of DTLS. The DTLS has provisions for three types of security services, viz. integrity, authentication and confidentiality. LWM2M OMA specification for device gateway to Internet has provisions for M2M Authentication Server (MAS) for security, root key data store, and devices and data authentication. XMPP protocol includes layer Simple Authentication and Security Layer (SASL) for security. \n\nChapter 4 introduced IPv6 at IP layer which includes headers for managing device mobility, security and configuration aspects. IPv6 uses AES-128 security = 21 B header. \n\nChapter 5 introduced data centres provision for data security and protection using advanced tools, full data backups along with data recovery and redundant data communication connections, servers and data centres high security standards high degree of security and integrity and effective protection of data, files and databases at the organisation. \n\nChapter 6 introduced data security at cloud servers in a multi-tenant environment. Data needs high trust and low risks, and security from the loss of users\u2019 control. Security provisions as per the developer requirements are the responsibilities of cloud service providers. Nimbits cloud servers for the device provisions usage of security tokens and provisions data integrity. \n\nChapter 7 introduced sensor level security and participatory sensing challenges of security, privacy and reputation. Section 7.6 described security challenges in RFID usages. RFID IDs need provisioning for full implementation of privacy and security needs and data processing at the tag and reader with access encryption and authentication algorithms. A security issue in an RFID network is a vulnerability to external virus attacks. Section 7.6.2 described methods of securing communication for WSNs, including usages of Berkeley laboratories suggested SPINS Symmetric Cryptographic Protocols [Secure Network Encryption Protocol (SNEP), and micro- Tesla (m-Tesla)]. \n\nChapter 8 introduced: (i) Arduino using WiShield Library1 preinstalled with the IDE for Wi-Fi interface security; (ii) RPi IDE security interfaces; (iii) mBed device platform; and (iv) REST APIs for administration, security, data flow, device, multitenancy, authentication, directory and subscription management. \n\nChapter 9 introduced security of data for embedded device platforms. The chapter described the authentication process and uses of result of the hash algorithmic functions or message digest operation. The chapter gave examples of using crypto-library functions in the cryptosuite.2 \n\nChapter 9 also described encryption process using AES or DES algorithms for encryption. The key length can be 128, 192 or 256 bits. Data encryption can use AES256 (Advanced Encryption \n\n1 http://github.com/asynlabs/WiSield 2 http://code.google.com/p/cryptosuite \n\n398 Internet of Things: Architecture and Design Principles \n\n10.1 INTRODUCTION \n\nInternational organisations are making a number of efforts towards ensuring that IoT design must ensure trust, data security and privacy. \n\nTrust is important. For example, consider the messages and video clips of the operations from the ATMs to server. A user places the trust in the bank that sensitive information will not be disclosed which can harm the user. When things communicate in an analogous manner, then trust of safe use of data exists. When one tweets on Twitter, trust must exist that no one will harm him/her due to his tweets. Tweets expose ones\u2019 behaviour, thinking about the actions, inactions and policies of government officials and functionaries. Trust in IoT context means dependability, accuracy, quality of data from multiple sources for the intended applications and services. \n\nAn organisation, Open Trust Alliance3 established IoT Trustworthy Group (ITWG) for recognising the priority (must in designs for security and privacy) from the onset of product development and addressing holistically. \n\nAn organization, \u2018I am the Cavalry\u20194 has prescribed an Oath for connected medical devices on the lines similar to Hippocratic Oath which is attestation by physicians to provide care in the best interest of patients. The medical devices should have commitments to capabilities that preserve patient safety, as well as trust in the process of delivering care itself. \n\nSecurity is important. For example, consider the ATM messages. They should communi- cate on Internet securely. The security distortions can lead to serious consequences. \n\nA smart city security is also important. The city deploys smart health, public safety, transport, and deploys IoT and smart home applications and services. An organization5 \n\nhas taken initiative for solving cyber security problems in smart cities. \n\nPrivacy is important. The video clips communicate on the Internet in a smart home security application. If the clips reach unrelated entities, it can lead to serious breach of home security. \n\n3 https://www.otalliance.org 4 https:www.iamthecavalry.org 5 http://securingsmartcities.org \n\nDesign must ensure trust, data security and \n\nprivacy in IoT \n\nStandard 256-bit encryption key length) or DES (Data Encryption Standard). Arduino AES 256 library can be downloaded and used for Arduino boards. Authentication can be by using SHA1/ SHA256 secured hash algorithms or MD5 message digest algorithm. Eclipse Californium has DTLS security implementations. \n\nPrevious chapters described security protocols and standard implementations at device to application and service levels. Security, privacy, authentication, encryption and protection are must for end-to-end solutions from device level to network and application/service levels. \n\nIoT Privacy, Security and Vulnerabilities Solutions 399 \n\nIndustrial Internet Consortium6 (IIC) was formed by Intel, IBM, CISCO, GE and AT&T (2014) for coordinating efforts and initiatives to connect and integrate objects. Another organisation, AllSeen Alliance7 established by Linux Foundation is a collaborative project of cross-industry consortium which is dedicated for enabling the interoperability of billions of IoT devices and applications/services. \n\nFollowing are the terms, whose meanings must be understood before learning the topics covered in this chapter. \n\nMessage is a string that represents data or client-request or server-response which communicates between sender and receiver objects. \n\nHash refers to a collection or bundle which gives an irreversible result after many operations on data and the operations are just one way. For example, when wheat crop is ripe and cut, hashing process separates out the grains which are used for consumption and the resultant waste is discarded. When data such as user ID and password needs secret communication for the purpose of authentication, then it is communicated after a set of standard operations on the usage of an algorithm, called secure hash algorithm. The algorithm generates a fixed size, say, 128, or 256-bit value using a secret key. Only the hash value communicates. Receiver-end retrieves the hash value, and compares that with stored hash value. If both are equal then the sender message is authenticated. \n\nDigest is a process which gives the irreversible result involving many operations. A standard algorithm called MD5 (Message Digest 5) is also used for digest, similar to the hash value. Receiver-end stores the digest value expected to be obtained after the MD5 operations, and compares that with received value. If both are equal then the sender message is authenticated. \n\nEncryption is a process of generating new data using a secret key known only to a receiver. Before sending the encrypted data, the sender and receiver, both identify each other and know the key that will be used by them. The encryption uses a 128, 192 or 256- bit key for encrypting the data. \n\nDecryption is a process which retrieves the data from the encrypted data. Use Case means a list of event steps or actions which define the interactions between two ends, in which one is playing the role and other is the system. The steps accomplish a task or goal or mission. One end is called actor in Unified Modelling Language (UML), while other end is the system. Use Case is a software engineering term. For example, an API is playing the role of obtaining inputs (events) and generation of outputs which interact with the system such as a web server or web API or service or web application using a callback() function as per the output (Sections 9.2 and 9.4). Use cases define the required behaviour of software under development. Use cases describe the details of usages of software and its normal behaviour. \n\nMisuse Case can be understood as reverse sense of Use case. Misuse case defines the behaviour which is not required from the software under development. A Misuse case \n\n6 https://www.iiconsortium.org 7 https://www.allseenalliance.org \n\n\n![Image](/src/assets/generated_images/iot2_p426_i0.png)\n\n400 Internet of Things: Architecture and Design Principles \n\ndefines the behaviour which should not happen. This in turn specifies the threats also. Misuse case gives information and renders help in identifying the requirement of new Use cases for prevention of attack and find out what should not happen. \n\nLayer means a stage during a set of actions at which the action is taken as per the specific protocol or method and then the result passes to the next layer until the set of actions completes (Figures 2.1 to 2.3). A design using the layers\u2019 model enables representation of a set of systematic actions which are followed sequentially for accomplishing a task. \n\nSublayer is a layer consisting of various sublayers in a model to provide set of actions sequentially taking place at the layer. \n\nFirewall is a software interface, which interconnects networks with differing trusts, and is immune to penetration and provides perimeter defence. It functions as a choke point for controlling and monitoring. It does auditing and provides controlled accesses. It allows only authorised traffic and imposes restrictions on network services. It can raise alarms for abnormal behaviours. \n\nFollowing sections describe the processes and actions for ensuring security and privacy that are taken at the device, network, transport, application and service levels. Section 10.2 describes IoT vulnerabilities, security requirements and method of analysis of the threats to privacy and security. Section 10.3 describes Use cases and Misuse case methods. Section 10.4 describes the security tomography uses in large networks, such as RFID networks and WSNs. This section also describes layer model of attacks. Section 10.5 describes how things (embedded devices, sensor or actuators) establish their identity before the messages are used by them after set of message exchanges on the Internet. This section also describes practical aspects of access control, message integrity, non-repudiation and availability. Section 10.6 describes security model for IoTs. \n\n10.2  VULNERABILITIES, SECURITY \n\nREQUIREMENTS AND THREAT ANALYSIS \n\n10.2.1 Privacy \n\nMessage privacy means that the message should not reach into the hands of the unrelated entities. When data or messages communicate from the things (device platforms), those are meant only for the applications or services and for targeted goals only. \n\nPrivacy also means no interference or disturbance from other. Consider an example of messages from embedded devices in an automobile using the Internet to an automobile service centre (Example 5.2). Privacy means the messages reach only the centre and used only by the services of the centre. Another automobile company on whose hands the data falls may face serious business consequences. \n\nExplain the requirements of privacy and security, \n\nvulnerabilities from \n\nthreats and threat \n\nanalysis in IoT \n\nLO 10.1 \n\nIoT Privacy, Security and Vulnerabilities Solutions 401 \n\nIoT necessarily need privacy policy. A privacy policy needs to determine that \u2018how much of the IoT devices data and which data need absolute privacy and which need limited privacy\u2019. Company authorities need the support for accessing the data which may be private for individuals. The authorities also need to respect the individual customer needs of privacy and understand that privacy is a legitimate human need. Privacy policy vendors should take privacy seriously. They must respect their customers enough to understand that the privacy is a legitimate human need. \n\nNational Institute of Standards and Technology (NIST), USA is developing the standards for privacy. A system may be secure but may inadvertently breach the privacy of an individual. A tracking service may track a vehicle while does not want his/her movements to be tracked. \n\nSecurity authorities and agencies need support for accessing data which may be private for individuals. The authorities also need to respect the individual\u2019s needs. \n\nPrivacy standards for IoT data are under development. A community organisation is \u2018I am The Cavalry\u2019.8 \u2018Cavalry\u2019 means a group of soldiers who used horses in earlier centuries or formed part of army that used fast armoured vehicles. The Cavalry focuses on computer security issues where these interact with public safety, such as medical devices, automobiles, public infrastructure and home electronics. The organisation strives to ensure that these technologies are worthy of the trust. \n\n10.2.2 Vulnerabilities of IoT \n\nVulnerability means weak without complete protection, weakness to defend oneself or can be easily influenced from surrounding unwanted things from itself. An IoT security article describes that there are many vulnerabilities, due to participation of the number of layers, hardware sublayers and software in applications and services.9 The nature of IoT also varies. For example, sensors, machines, automobiles, wearables, and so on. Each faces different kind of vulnerabilities and has complex security and privacy issues. \n\nIoT network can be vulnerable to eavesdropping. Eavesdropper creates security issues. An eavesdropper, say E, listens to the messages and commands in the network during communication and obtains confidential messages. A server at E sends fake commands which a server S for the devices data assumes that are from the devices or applications. S issues responses for the device operations in response to requests from E. E listens these responses. A fake device at E can be used to send the device data, such as sensor data, requests and commands from E for disrupting the control system. Use of secret key encryption can protect the messages to and from device, server, application or service. \n\n8 https:www.iamthecavalry.org 9 http://www.networkcomputing.com/internet-things/iot-security-privacy-reducing-vulnerabilities/807681850 \n\nIoT system vulnerabilities are numerous, due to \n\nparticipation of a number of layers, and hardware and software \n\ncomponents \n\n402 Internet of Things: Architecture and Design Principles \n\nThe key is a device software-generated string which can be cracked by trying large number of combinations. Device unique ID and authentication issues exist in negligible user interaction scenario. \n\nSecurity features needs to be incorporated in a standard format recommended for IoT. For example, a standard for electronic products architecture is from a developing group, EPCglobal. The group is responsible for creation and maintenance of privacy policy products. \n\nOpen Web Application Security Project10 (OWASP) has undertaken the associated security issues of IoT for the purpose of helping developers, manufacturers and consumers. OWASP is open source and has free to use licensing policy. Project is community-model- based software development initiative. A community model is making collective efforts and initiative by universities, organisations and institutions in an open source project. OWASP has undertaken a number of security related subprojects, such as ones for defining, the \u2018Top Vulnerabilities\u2019, \u2018Attack Surface Areas\u2019 and Testing Guides\u2019. \n\nOWASP has identified top ten vulnerabilities in IoT applications/services as follows: \n\n\u25cfInsecure web interface \n\n\u25cfInsufficient authentication or authorisation \n\n\u25cfInsecure network services \n\n\u25cfLack of transport encryption/integrity verification \n\n\u25cfPrivacy concerns \n\n\u25cfInsecure cloud interface \n\n\u25cfInsecure mobile interface \n\n\u25cfInsufficient security configurability \n\n\u25cfInsecure software or firmware \n\n\u25cfPoor physical security Reader can refer to the OWASP project definitions of IoT attack surface areas. Attack surface areas mean the areas in software or hardware which are vulnerable to attack (Example 10.1). \n\nExample 10.1 \n\nProblem What are the attack surface areas in Device Web Interface (DWI) and Cloud Web Interface (CWI) defined in OWASP? \n\nSolution \n\nFollowing are attack surface areas for DWI: SQL injection, cross-site scripting, cross-site request forgery, account lock out, username enumeration, weak passwords and known default credentials. Following are attack surface areas for CWI: SQL injection, cross-site scripting, cross-site request forgery, account lock out, username enumeration, weak passwords and known default credentials, same as ones for DWIs plus transport encryption, encrypted personally identifiable information (PII) sent, unencrypted PII sent, device information leaked and location leaked and cloud user data disclosure, user/device location disclosure and differential privacy. \n\n10 https://www.owasp.org/index.php/OWASP_Internet_of_Things_Project \n\nIoT Privacy, Security and Vulnerabilities Solutions 403 \n\nCERT Coordination Centre (CERT/CC) at Carnegie Mellon University (CMU) has taken the initiative for coordinating the vulnerabilities in IoT devices.11 CERT stands for Computer Emergency Response Team at CMU Software Engineering Institute. The team researches on software bugs that impact software and Internet security. \n\nRefer to work of Danj K. Klinedinst web hosted in January 2016.12 The team completed a survey for vulnerabilities in common home Wi-Fi routers in 2015 and reported a number of vulnerabilities database. \n\n10.2.3 Security Requirements \n\nIoT reference architecture means a guide for one or more concrete architects. IoT reference architecture is a set of three architectural views\u2014functional, information, and deployment and operational. A functional view is from F. Carrez and co-workers13. Security is one of the functional groups (FG) of the functional view. FG for security consists of security functions between the application and device. \n\nSecurity FG contains five sets of functions which are required for ensuring security and privacy. Large number of devices, applications and services communicate in IoT. Five functional components (FCs) of security are defined in IoT reference architecture. \n\nFollowing are five functional components (FCs): 1. Identity management (IdM) 2. Authentications 3. Authorisation 4. Key exchange and management 5. Trust and reputation \n\nFigure 10.1 lists the functions of a security function group in functional view in IoT reference architecture. \n\n10.2.4 Threat Analysis \n\nA threat-analysis tool first generates the threats and analyses a system for threat(s). Threat analysis means uncovering the security design flaws after specifying the stride category, data flow diagram, elements between that the interactions occuring during the stride, and processes which are activated for analysis. Stride means a regular or steady course, pace or striding means, passing over or across in one long step (set of statements when considering a threat to a software component). Stride means taking a long step for dainty little steps. Example 10.2 shows the case of a threat-analysis tool for analysis during a stride. \n\n11 https://insights.sei.cmu.edu/cert/2016/01/coordinating-vulnerabilities-in-iot-devices.html 12 http://www.kb.cert.org/vuls/ 13 F. Carrez and co-workers, 2013, as referred in book A Jan Holler and co-workers, \u201cM2M to Internet of Things\u2014Introduction to a New Age of Intelligence\u201d, Chapter 8 Academic Press/Elsevier, 2014. \n\n404 Internet of Things: Architecture and Design Principles \n\nExample 10.2 \n\nProblem How is the threat analysis for a system performed using Microsoft Threat Modelling Tool 2014? \n\nSolution \n\nA model is designed for threat analysis with definitions of strides and elements. The interacting elements are processes, data store, flow, boundary or may be external specified elements in the system. The tool has three components: Getting started guide, Create a model and Open a model. \u2018Create a model\u2019 is used after \u2018Getting started guide\u2019. The tool component \u2018open the model\u2019 precedes the threat analysis for each stride. \n\nThe tool also provisions for definitions of new threats using a stride category. A stride category is first created which generates a list of threats which are active and based on interactions between the elements. The list is as per the definitions in the model open for analysis. \n\nFigure 10.2 shows an example of tool usage for threat analysis during a web service interaction between the application and web. Examples of element types are process, data store, flow, boundary and an external specified element. Tool predefines a number of threat categories. A new category can also be created. The tool suggests threat definitions and generates the mitigation solutions automatically. The tool messages on display (analysis view) show the vulnerabilities and the data flow diagram. For example, data flow between the device and application or service. \n\nThe analysis view shows threats which are active and which inactive. An example of threat is \u2018data store inaccessible\u2019. The view also shows the category in which it is active and inactive. A stride category example is \u2018spoofing\u2019 and threat is \u2018spoofing the web context process\u2019. Another example of threat is \u2018denial of service category\u2019. \n\n1: \n\n2: \n\n3: \n\n4: \n\n5: \n\n1: Applications 2: Business \n\nApplications \n\n1: Identify \n\n2: Authentication \n\n3: Authorisation 4: Key Exchange \n\nand Management \n\nManagement \n\n5: Trust and \n\nReputation \n\nApplication Support \n\nLayer APIs/ SW Security Device Network \n\nTags Activation \n\nSensing \n\nStorage \n\nData Processing \n\nFigure 10.1 Security function group components in functional view in IoT reference architecture \n\nIoT Privacy, Security and Vulnerabilities Solutions 405 \n\nWeb Context \n\nLocal Web Context Boundary Application \n\nLocal Process and \n\nContext \n\nStore System \n\nHTTP HTTP \n\nInternet \n\nWeb Service \n\nFigure 10.2  An application threat model in Microsoft threat modelling tool display when \u2018diagram\u2019 item \n\nselected \n\nWhen a search item is for the element \u2018process\u2019 then the view displays the processes which are active and inactive among the OS process, Thread, Kernel Thread, Native Application or Managed Application, Thick Client, Browser Client, Browser, Active-X Plug-ins, Web Server, Web Application and Win32 Server. \n\nReconfirm Your Understanding \n\n\u25cfMessage privacy functions ensure that messages do not reach into the hands of unrelated entities and reach from the things to the applications or services only. \n\n\u25cfIoT has a large number of vulnerabilities. This is due to participation of the number of layers, hardware sublayers, FCs, applications and services. \n\n\u25cfSecuity features must incorporate in a standard format recommended for IoT. \n\n\u25cfOWASP has identified vulnerabilities in detail and listed top ten vulnerabilities in IoT applications/ services. They have also defined the attach surface areas for vulnerabilities. \n\n\u25cfCERT at CMU defined the vulnerabilities in common home WiFi routers and reported a number of vulnerabilities and listed them in a database. \n\n\u25cfAn IoT reference architecture has three\u2014functional, information, deployment and operational. \n\n\u25cfFive functional components (FCs) in security functional group in-between the application/service and device are identity management, authentications, authorisation, key exchange and management, trust and reputation. \n\n\u25cfA threat analysis tool uncovers the security design flaws after specifying the stride category, data flow diagram, elements between which the interactions occur during the stride, and specifying the processes which are activated for analysis. \n\n\n![Image](/src/assets/generated_images/iot2_p432_i0.png)\n\n406 Internet of Things: Architecture and Design Principles \n\n10.3 USE CASES AND MISUSE CASES \n\nUML notation use case diagrams are required for the FCs of a security FG. A use case analysis enables the requirement analyses. Use cases are key features of many models and frameworks for processes development. Oracle Unified Method (OUM) and IBM Rational Unified Process (RUP) are examples of frameworks for software development process models and requirements analyses. \n\nFigure 10.3 shows a simple use case diagram for generating and communicating a key. \n\nEncryption Key \n\nSender Application/Service Encryption Key Receiver \n\nGenerate random number \n\nGenerate Key \n\nSend Key \n\nKey \n\nFigure 10.3 Simple use case diagram for generating and communicating a key \n\nFamiliarise with modelling using use cases and \n\nmisuse cases \n\nLO 10.2 \n\nSelf-Assessment Exercise \n\n1. How do you define message privacy? 2. What do you mean by trust? 3. List the top ten vulnerabilities for attack. 4. List the focus areas of \u2018I am the Cavalry\u2019 for computer security issues. 5. List the focus areas of OWASP and importance of each in IoT security. 6. Write the meaning of SQL injection, cross-site scripting, cross-site request \n\nforgery, account lock out, username enumeration, weak passwords, known default credentials, transport encryption, encrypted personally identifiable information (PII). 7. Write the usage of five functions components in the security group of \n\nfunctions. 8. List the steps in threat analysis when using Microsoft Threat Analysis Tool \n\n2014. \n\n\u2605 \u2605 \u2605 \u2605\u2605 \u2605\u2605 \u2605\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605\u2605\u2605 \n\nNote: \u2605 Level 1 & Level 2 category \u2605\u2605 Level 3 & Level 4 category \u2605\u2605\u2605 Level 5 & Level 6 category \n\nIoT Privacy, Security and Vulnerabilities Solutions 407 \n\nExample 10.3 gives the use cases for security and privacy in IoT applications and services. \n\nExample 10.3 \n\nProblem What are the examples of security issues for which use cases are required in IoT? \n\nSolution \n\nUse cases depict the requirements as follows: \n\n\u25cfBoot process protection: Boot process runs initial programs. If it corrupts then the system fails. \n\n\u25cfSecure software and firmware update: When software and firmware update, then secure updates are needed. \n\n\u25cfStored data encryption and integrity protection: Data storage needs protection from hackers. \n\n\u25cfPlatform integrity verification: The device platform integrity needs verification, else fake device platform communicates and the fake sends the command spoofing as the IoT device platform commands. \n\n\u25cfKey generation, management and exchanges need security as these are prerequisite for authentication, authorisation and messages encryption. \n\n\u25cfAuthentication of sender and receiver is must for secure message communication. \n\n\u25cfSecured communication through a network: Required for secure message exchanges between IoT devices and applications or services. \n\n\u25cfLifecycle management: All messages, keys and data have specific life and need to be deleted from the system. \n\nFirstly, the actors and collaborating actors are identified. Then, misuse cases are developed for each of them. Purpose of this is creating specifications for communicating the potential risks and rationale for security-relevant decisions to the device platform, application or service. Example 10.4 elucidates the misuse cases for security and privacy in IoT application/services. \n\nExample 10.4 \n\nProblem What are the examples of security issues for which misuse cases are required in IoT so that the requirements of new use cases can be analysed? \n\nSolution \n\nMisuse cases depict the requirements as follows: \n\n\u25cfIdentity misuse cases \n\n\u25cfNon-repudiation \n\n\u25cfCrypto offloads: The transfer of cryptographic keys and messages need to be protected from eavesdropper or hackers \n\n\u25cfEavesdropping \n\n\u25cfFake server \n\n\u25cfFake device platform \n\n\u25cfFlooding of TCP/SYN \n\n\u25cfUnauthorised access to a data store \n\n\u25cfAudit and accountability: Each transaction needs to be securely stored for future auditing and fixing accountabilities. \n\n\n![Image](/src/assets/generated_images/iot2_p434_i0.png)\n\n408 Internet of Things: Architecture and Design Principles \n\n10.4 IoT SECURITY TOMOGRAPHY AND LAYERED ATTACKER MODEL \n\n10.4.1 Security Tomography \n\nComputational tomography means a computing method of producing a three-dimensional picture of the internal structures of an object, by observation and recording of the differences in effects on passage of energy waves impinging on those structures. \n\nComputational security in complex set of networks utilises the network tomography procedures of identifying the network vulnerabilities. This enables design of efficient attack strategies. \n\nOutline security \n\ntomography of large networks and layered attacker model \n\nLO 10.3 \n\nComputational security \n\nin complex set of networks and system \n\nutilises the security tomography procedures \n\nof identifying the \n\nvulnerabilities \n\nReconfirm Your Understanding \n\n\u25cfUML notation use-case-diagrams are required for FCs of a security FG. \n\n\u25cfUse cases analysis enables requirements analyses. Use cases are key feature of many models and frameworks for processes development. \n\n\u25cfExamples of use cases need are boot process protection, secure software, firmware update, stored data encryption and integrity protection. Data storage need protection from hackers. \n\n\u25cfMisuse cases define the required behaviour of components under development which should not happen. That highlights the threats to enable designing of new use cases for prevention of attack and find out what should not happen. \n\n\u25cfExample of misuse cases requirements are identity misuse cases and non-repudiation. \n\nSelf-Assessment Exercise \n\n1. What is the purpose of use cases? 2. Explain the meaning of actors and collaborating actors in use cases. 3. What is the purpose of misuse cases? 4. Write the definition of each of the following terms: communicating the \n\npotential risks, rationale for security-relevant decisions, Misuse cases for key management. 5. Draw a use case diagram for creating authentication code using SHA1 \n\nalgorithm. 6. Write meanings of misuse cases for identity, non-repudiation, crypto offloads, \n\neavesdropping, fake server and fake device platform. \n\n\u2605 \u2605\u2605 \n\n\u2605 \u2605\u2605 \n\n\u2605\u2605\u2605 \n\n\u2605\u2605\u2605 \n\nIoT Privacy, Security and Vulnerabilities Solutions 409 \n\nA complex set of networks may be distributed or collaborative. Network tomography refers to the study of vulnerabilities and security aspects for network monitoring in a complex system, such as WSNs, RFIDs or IoT networks and allocating resources and ensuring network reliability and security. \n\nMonitoring of individual nodes is not fast acting and is also impractical. Network tomography helps in observing each network section (for example, a WSN nodes network between two access points) and subsections. The security tomography means finding attack vulnerable sections/subsections from the observations for behaviours using a finite number of objects or threats in a complex set of subsystems. \n\n10.4.2 Layered Attacker Model \n\nFigure 10.4 shows a layered attacker model and possible attacks on the layers. \n\n6: Applications/Services \n\n5: Applications Support \n\n4: Transport \n\n3: Network \n\n2: Data Adaptation \n\n1: Physical cum data-link layer \n\nPacket sniffing and DoS attacks such as Ping floods and ICMP attacks \n\nVulnerabilities in application/service can be exploited through attacks such as SQL injection, where the developer has failed to ensure that user input is validated against a defined schema \n\nVulnerable ports \n\nUn-encrypted data store, tempering or sniffing \n\nInsecure in Ptotocols DHCP or STP, LAN node attack using MAC flooding or ARP poisoning Physical or service disruption/attacts on wireless networks \n\nFigure 10.4  Layered attacker model and possible attacks using IETF six-layer modified model for \n\nIoT/M2M \n\nFollowing are the suggested solutions for mitigating the attacks on the layers (OSI modified six layers IoT Architecture). \n\nLayer 1 Attacks Solution \n\nSolution depends on the devices used. For example, link-level provisioning of security uses\u2014BT LE link level AES-CCM 128 authenticated encryption algorithm for confidenti- ality and authentication, and ZigBee at link-level security using AES-CCM-128. \n\n410 Internet of Things: Architecture and Design Principles \n\nLayer 2 Attacks Solution \n\nProgramming the network switches to prevent internal node attacks during use of DHCP or Spanning Tree Protocol (STP). Additional controls may include ARP inspection, disabling unused ports and enforcing effective security on VLAN\u2019s (Virtual LAN) to prevent VLAN hopping. VLAN refers to a group of end stations with a common set of requirements, independent of a physical location.14 VLANs have the same attributes as a physical LAN but allow you to group end stations even if they are not located physically on the same LAN segment. \n\nLWM2M OMA specification for device gateway to the Internet has provisions for MAS for security, root key data store, and devices and data authentication. \n\nLayer 3 Attacks Solution \n\nUse of temper resistant router, use of packet filtering and controlling routing messages and packets data between layers 3 and 4 through a firewall reduces the risks. \n\nLayer 4 Attacks Solution \n\nPort scanning method is a solution which identifies the vulnerable port. A solution is the opening of network ports and configuring effectively the firewall, and locking down ports only to those required. A solution is DTLS between layers 5 and 4. The DTLS has provisions for three types of security services, viz. integrity, authentication and confidentiality. A solution is include SASL (Simple Authentication and Security Layer) for security when using the XMPP protocol. \n\nLayers 5 and 6 Attacks Solution \n\nAbove layer 4, we are looking primarily at application-level attacks which are results of poor coding practices. Assume an attacker injects the SQL input to extract data from the database (e.g. SELECT * from USERS). When the application fails to validate the injection, the query extracts the data. \n\nWeb applications/services can use HTTPS communication link. The features of S-HTTP (Secure HTTP) are as follows: \n\n\u25cfApplication-level security (HTTP specific) \n\n\u25cfContent privacy domain header \n\n\u25cfAllows use of digital signatures and encryption, various encryption options \n\n\u25cfServer-client negotiations \n\n\u25cfCryptographic scheme is a property assigned for the link \n\n\u25cfSpecific algorithm is the value assigned \n\n\u25cfDirection specification is done, one-way or two-way security \n\n14 http://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst6500/ios/12 and http://www.cisco.com/c/en/us/td/docs/2SX/ configuration/guide/book/vlans.html \n\nIoT Privacy, Security and Vulnerabilities Solutions 411 \n\nCISCO suggested layered framework provisions for following solutions: \n\n\u25cfLayers 1\u20136: Role-based security \n\n\u25cfLayers 1\u20134 Anti-temper and detection-based security \n\n\u25cfLayers 1\u20136: Data protection and confidentiality \n\n\u25cfLayers 1\u20136: IP protection \n\nReconfirm Your Understanding \n\n\u25cfMonitoring of individual nodes is not fast acting and is also impractical. Network tomography helps in observing each network section (for example, a WSN nodes network between two access points) and subsections. \n\n\u25cfSecurity tomography enables finding the attack vulnerable sections/subsections on observations for behaviours using a finite number of objects or threats in a complex set of subsystems. \n\n\u25cfData between the things and application/service communicate through six layers and their sublayers. Layered attacker model shows the vulnerabilities at each layer, so that necessary solutions can be given for each layer attack. For example, using a temper resistant router, packet filtering and controlling routing messages and packets data between layers 3 and 4 through a Firewall reduce the risks. \n\n\u25cfS-HTTP (Secure HTTP) enables secure communication between the client and server sockets. \n\nSelf-Assessment Exercise \n\n1. Why does security tomography enable fast detection in case of complex set of \n\nsubsystems or networks? 2. List the physical cum data-link layer attacks in layered attack model. 3. What are transport layer attacks in layered attack model? 4. How do the port scanning and DTLS features enable mitigation of the attacks \n\nat layer 4. 5. List and explain the features of HTTPS. 6. What are the meanings of ARP inspection and disabling unused ports and \n\nhow are they used for layer 2 attack mitigation? \n\n\u2605 \n\n\u2605 \u2605 \u2605\u2605\u2605 \n\n\u2605\u2605 \u2605\u2605\u2605 \n\n\n![Image](/src/assets/generated_images/iot2_p438_i0.png)\n\n412 Internet of Things: Architecture and Design Principles \n\n10.5  IDENTITY MANAGEMENT, AND \n\nESTABLISHMENT, ACCESS CONTROL AND SECURE MESSAGE COMMUNICATION \n\nSource of message needs to specify an identity (ID) when sending the messages. The receiver can thus know that from where the messages have been received. Number of ways exist for specifying identity (ID). The messages can be from several sensors, actuators and platforms and those may be for several applications and services. Id management and establishment for IoT are therefore basic requirements. \n\nA MAC address can specify identity of a computing device platform. However, the platform may connect several sensors and actuators. An application layer may consist of number of applications and services. An URI (Universal Resource Identifier) can be used on the Internet. Many devices however do not use the URI. An Object Identifier (OID) in IoT can have the following identifiers: \n\n\u25cfTypes of things (for example, streetlight, vehicle, ATM, WSN, RFID) \n\n\u25cfClass identifier, since it refers to a class (or type, or category) of things; for example, make and model \n\n\u25cfInstance identifier; for example, VIN (Vehicle identity number) for vehicles Subsection 10.5.1 describes identity management and identity establishment mechanisms. Subsection 10.5.2 describes access control mechanisms. Message integrity, non-repudiation and availability are important requirements for security and privacy. Subsections 10.5.3 to 10.5.5 describe these. \n\n10.5.1 Identity Management and Establishment \n\nIdentity Management (IDM) for the devices, applications and services is an FC of security FG. IdM means managing different identities, pseudo-names, hierarchies of group IDs as well as IDs for message senders and receivers. The FC anonymously manages the IDs. Example 10.5 gives four examples of uses of IDM functions. \n\nExample 10.5 \n\nProblem Give examples of usages identity management for establishing identities of device and application/services. \n\nSolution \n\nIETF transport layer does the device IDM and identity registry functions. \n\nOracle\u2019s IoT architecture (Figure 1.5) provisions for device IDM functions at the manage sublayer between stream and acquire layers. \n\nExamine functions for source identity- management, identity- \n\nestablishment, device \n\nmessages access- \n\ncontrol, message- integrity, messages non-repudiation and \n\navailability in IoT \n\napplications and \n\nservices \n\nLO 10.4 \n\nIoT Privacy, Security and Vulnerabilities Solutions 413 \n\nOMA-DM model suggests use of a DM server. One of the functions of a DM server is assigning the device ID or address, and activating, configuring (managing device parameters and settings), subscribing to device services, opting out of the device services, and configuring the device modes (Section 2.4.2). Reader uses an RFID identity manager when reading from the RFIDs. EPCglobal architecture framework is used for assignment of a unique identity for business processes, applications and services, and uniquely identify the physical objects, loads, locations, assets and other entities. ONS performs the lookup functions based upon the DNS. DNS name enables web server Internet connectivity using HTTP, REST, WebSockets and Internet protocols (Section 7.6.2). NIST suggests the specifications for cyber-physical systems and for the asset identification specifications, and common platform enumeration specifications for naming, name matching, dictionary and applicability language. ITU-T X.660 suggests the procedures for the operation of object identifier registration authorities: General procedures and top arcs of the international object identifier tree. ITU-T X.672 suggests an OID (object identifier) resolution system. ITU-T OID Flyer suggests object identifiers and their registration authorities: your solution to identification. \n\nCommunication between the device and application/services is after each one establishes the identity of the other securely, using authentication and authorisation and other functions. \n\n10.5.2 Access Control \n\nThree FCs in a security FG for ensuring security and privacy are: \n\n\u25cfAuthentications \n\n\u25cfAuthorisation \n\n\u25cfKey exchange and management \n\nAuthentication \n\nID establishment and authentication are essential elements of access control. A hash function or MD5 gives the irreversible result after many operations on that and the operations are just one way. The algorithm generates a fixed size, say, 128 or 256-bit hash or digest value using authentication data and secret key. Only the hash or digest value communicates. The receiver-end receives the value, and compares that with a stored value. If both are equal then the sender is authenticated. \n\nHash function characteristic features are pre-image resistance, hash function should not alter, before or after communication and should be as per the previous image (original message), second pre-image resistance: hash function should not be altered by an in- between entity (called eavesdropper), should remain the same as one for the previous image (original message) should be collision-resistance and should not be the same for any form of altered message. \n\nAuthorisation \n\nAccess control allows only an authorised device or application/service access to a resource, such as web API input, IoT device, sensor or actuator data or URL. Authorisation model \n\n414 Internet of Things: Architecture and Design Principles \n\nis an essential element of secure access control. The standard authorisation models are as follows: \n\n\u25cfAccess Control List (ACL) for coarse-grain access control \n\n\u25cfRole-Based Access Control (RBAC) for fine-grain access control \n\n\u25cfAttribute-Based Access Control (ABAC) or other capability-based fine grain access control An access control server and data communication gateway can be centrally used to control accesses between application/service and IoT devices. The server central control can be on a cloud server. Each device can access the server and communicate data to another server. \n\nAlternatively, a distributed architecture enables: \n\n\u25cfEach device to request access to the server and the server grants application/service access token \n\n\u25cfEach application/service to request access to the server and the server grants device access token for the device. \n\nKey Exchange and Management \n\nKey of sender messages needs to be known to receiver for accessing the received data. Key of respondent of messages needs to be known to sender for accessing the responses. The keys, therefore, need to be exchanged before the communication of authentication code, authorisation commands and encrypted messages. Since each application/service component and device data application or service may need unique and distinct keys, an FC provisions for the functions of key management and exchanges. Example 10.6 gives the steps for key exchanges and encryption and decryption. \n\nExample 10.6 \n\nProblem Show and list the steps for the key generation and exchange for authentication and authorisations followed by secure communication of an application/service message to the device/gateway. \n\nSolution \n\nFigure 10.5 shows the steps of using FCs. The steps are for key exchanges and management, authentication and authorisations. The steps follow secure communication of an application or service message to the gateway and device. Steps for designing use case for key exchanges and encrypting and decrypting the messages are: \n\n1. 1 and 2: Device/gateway D generates secret key K 2. 3 and 4: Application/service A generates secret key K 3. 5 and 6: D exchanges key K and K\u2019 4. 7 and 8: Authentication and authorisation of D and A, 5. 9: Message given to encryption algorithm 6. 10: Encrypted message using K\u2019 to D 7. 11: Decryption algorithm decrypts encrypted message using K\u2019 for D 8. 12: Message M retrieves at D \n\nIoT Privacy, Security and Vulnerabilities Solutions 415 \n\n9. 13: Status code sends \u2018Error\u2019 or \u2018OK\u2019. As per the status of data exchanges for authentication, \n\nauthorisations and message communication. \n\nSimilarly, message encrypts at D using K and decrypts at A using K. \n\n10.5.3 Message-Integrity \n\nAn important aspect of system design is message integrity (data integrity), which means the message remains unaltered. A message should not be altered during its communication. The encrypted data after decrypting should be identical to one before encryption. \n\nMessage integrity check involves the following steps: \n\n\u25cfHash function or digest algorithm calculates 128 or 192 or 256 Hash value h0, taking the message M0 and K as inputs \n\n\u25cfAppends the h0 along with the message \n\n\u25cfCommunicate or store h0 \n\nIntegrity Check \n\nIntegrity check steps are as follows: \n\n1. Retrieve M any time later. Assume that retrieved message is M1. 2. Calculate 128 or 192 or 256 Hash value h1, taking the message M1 and K as inputs. 3. Compare h1 and h0. 4. Message is unchanged if h1 = h0, and integrity check passes else fails. \n\nMessage or data integrity means maintaining and assuring the accuracy and consistency over its entire lifecycle. \n\n1: Run Function Random (Security, Parameter) \n\n2: Key Generator \n\nFunction \n\n5: Key Exchange and Management \n\nFunctions \n\n4: Key Generator \n\nFunction \n\n3: Run Function Random (Security, Parameter) \n\nEncryption Algorithm \n\nApplication/Service \n\n12: Message \n\n13: Status (Error or OK) \n\nS \n\nDevice/Gateway D \n\n11: Decryption \n\nAlgorithm \n\nDecypt ( , ) M K\u00a2 \n\n10: Encrypted Message encrypt (K\u00a2, M) \n\n9: Message M \n\n9: Secret Key K\u00a2 \n\n5: Secret Key K \n\n7: Authentication \n\n8: Authorization \n\n6: Secret Key K\u00a2 \n\nFigure 10.5  Steps during key exchanges and management, authentication and authorisations followed \n\nby secure communication of application/service message to the device/gateway \n\n416 Internet of Things: Architecture and Design Principles \n\n10.5.4 Message Non-Repudiation \n\nNon-repudiation means an assurance that the source of a message once having communicated the data to a sender, cannot deny it later, that the message was not sent from the source and is not the same as sent earlier. It means data is signed and the signature put at the source cannot be denied. Digital signature is a method which ensures non-repudiation. \n\nThe service provides proof of the message\u2019s origin as well as its integrity. A digital certificate asserts the origin using a public key infrastructure. A digital signature is certified by a trusted digital certifying service [trusted third party (TTP) service]. TTP protects the private (secret) key and issues the certificate that a message was sent using this specific private (secret) key of source incase the private key is lost and used by some other source of message. Only the TTP is permitted to be the repository for public key certificates. \n\nExample 10.7 gives the steps for signing, issue of digital certificates to a signed message and verification of a signed message. \n\nExample 10.7 \n\nProblem Show and list the steps for the use of TTP service and steps for signing, issue of digital certificates to a signed message and verification of a signed message. \n\nSolution \n\nFigure 10.6 shows the use of TTP service and steps for signing, issue of digital certificates to a signed message and verification of a signed message. \n\n1: Run Function Random (Secutiry, Parameter) \n\nPublic Key K, Generator Function \n\n6: TTP Service Certificate ( , ) A Kp \n\n7: Authenticate Message as received at of and sign B A A \n\nDigital Certificate for of Message A MA \n\n9: Sign and \n\n(Verified Yes or No) MA 8. Test Algorithm 4: and sign ( , ) M K M A s A Authentication \n\nAlgorithm \n\n3: Message \n\nof MA A \n\n2: Sign Key Ks \n\n5: Kp Authenticate Message as well \n\nas Sign A \n\nFigure 10.6  Use of TTP service and steps for signing, issue of digital certificates to a signed message \n\nand verification of signed message \n\nSteps for designing use cases are: \n\n\u25cf1 and 2: End TTP and A generate keys Kp and Ks \n\n\u25cf3 and 4: Message MA and sign generator function sign (Ks, MA) executes and sent to End B \n\n\u25cf5 and 6: Kp to TTP Service and generation of certificate (A, Kp) \n\nIoT Privacy, Security and Vulnerabilities Solutions 417 \n\n\u25cf7 and 8: Digital certificate and certificate of messages received at End B are verified and result sent to test algorithm. \n\n\u25cf9: Sign and MA verified to be same as received at B, Yes or No. Similarly messages received at End B can be verified. \n\n10.5.5 Message-Availability \n\nMessage-availability affects when Denial-of-Service (DoS) attack occurs. This is because source-end message (of device or network or application/service resource) is unavailable to the intended destination-end on DoS. Examples of DoS attacks are: \n\n\u25cfICMP flooding which repeatedly sends control messages to the destination and thus denies the path to source end \n\n\u25cfAn SYN flood means the attacker sends a flood of TCP/SYN messages (packets) using a forged address, and the destination repeatedly sends TCP/SYN packets assuming the packet is from an actual source. The service to the source message becomes unavailable and the original message becomes unavailable at the destination \n\n\u25cfPeer-peer attack \n\n\u25cfApplication layer messages flooding An attack can be prevented using specific methods for specific type of attacks. Firewall is one method for preventing attacks on messages from untrusted networks. \n\nReconfirm Your Understanding \n\n\u25cfMAC, URI or OID can be used as ID for the things, application or service. An OID includes types of things, class identifier and instance identifier. \n\n\u25cf\u2018ID Management\u2019 is an FC of security FG. \n\n\u25cfAuthentication, authorisation and key exchanges and management are also FCs of security FG. \n\n\u25cfID establishment and authentication are essential elements of access control. A hash function or MD5 gives an irreversible result after many operations on that and the operations are just one way. Hash algorithm calculates hash h0 for authentication code using a secret key. h0 value communicates to the other end. If data store hash value h1 matches with communicated hash h0, then the sender stands authenticated. \n\n\u25cfAn access control server and data communication gateway can be centrally used to control accesses between application/service and IoT devices. Authorisation functions authorise access for messages at one end from the other end. Authorisation models specify coarse-grain access control and fine- grain access control. \n\n\u25cfKey of sender of messages needs to be known to the receiver for accessing the received data. Key of respondent of messages needs to be known to the sender for accessing the responses. The keys, therefore, need to be exchanged before the authentication code, authorisation commands and encrypted messages communicate. \n\n\u25cfA requirement is message-integrity. Sending the hash along with the message enables the message- integrity check. \n\n\n![Image](/src/assets/generated_images/iot2_p444_i0.png)\n\n418 Internet of Things: Architecture and Design Principles \n\n10.6 SECURITY MODELS, PROFILES AND PROTOCOLS FOR IoT \n\nAn IETF recommended draft recommends the following security models for five security profiles. Table 10.1 gives the details. \n\nTable 10.1 Security model for differing security profiles \n\nSecurity Profile Usage Description Security Model \n\nSecProf_0 6LowPAN/CoAP No security No temper resistant (no provision for prevention of tempering) \n\nSecProf_1 Home Usage Operations between things without central device \n\n1. No temper resistant \n\n2. Sharing of keys between layers \n\nDescribe security \n\nmodel, security profiles and security \n\nprotocols for IoT \n\nLO 10.5 \n\n\u25cfNon-repudiation assures that the source of a message once having communicated the data to a sender, cannot deny it later, that the message was not sent from the source and is not the same as sent earlier. Digital sign functions enable signed messages. A TTP service issues a digital certificate for a message, and saves it in its repository. At any time a receiver can verify the signed message from the digital certificate of that message. \n\n\u25cfMessage availability ensures prevention of DoS attacks, which can be due to a number of reasons, for example TCP/SYN flooding. \n\nSelf-Assessment Exercise \n\n1. What are the methods of specifying an ID of an application/service or device \n\napplication? 2. What does key management mean? 3. List steps to authenticate two end-points communicating the messages. 4. What do you mean by coarse-grain and fine-grain authorisations? 5. Why is authentication not sufficient and authorisation needed for \n\ncommunicating messages? 6. List the steps for message integrity check. 7. Why are the ends exchange keys? 8. What is the need of non-repudiation? 9. Write the sources for DoS which affect message availability. 10. List the functions of firewall in ensuring message availability. \n\n\u2605 \n\n\u2605\u2605 \n\n\u2605 \u2605\u2605\u2605 \u2605\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605 \u2605 \u2605\u2605 \n\n\u2605 \n\n(Contd.) \n\nIoT Privacy, Security and Vulnerabilities Solutions 419 \n\nSecProf_2 Managed Home Usage \n\nOperations between things and local device-central device interaction possible \n\n1. No temper resistant \n\n2. Sharing of keys between layers \n\nSecProf_3 Industrial Usage Operations between things enabled and relies on local or back-end device for security \n\n1. Temper resistant 2. Key and process separation \n\nSecProf_4 Advanced Industrial Usage \n\nAd-hoc operations between enabled things and relies on central device or a collection of control devices for security. \n\nDistributed and centralised (local and/or back-end) security architecture \n\n1. (No) temper resistant 2. Sharing of keys between layers/ \n\nkey and process separation sandbox15 \n\n15 \n\nSome applications target powerful devices aimed at more exposed applications and need security parameters such as keying materials, and the certificates must be protected in the things. For example, by using tamper-resistant hardware. \n\nSharing of keys has the following features: \n\n\u25cfNeeded across a networking stack of devices. \n\n\u25cfProvides authenticity and confidentiality in each networking layer, minimise the number of key establishment/agreement handshake, needs less overhead for constrained thing for example, applications with resource constraints (for example, temperature and humidity sensor) Key separation at different networking layers: \n\n\u25cfNeeded in advanced applications \n\n\u25cfMay also possibly use process separation and sandboxing to isolate one application from another. CISCO IoT secure environment framework has four FCs: \n\n1. Authentication 2. Authorisation 3. Network-enforced policy 4. Secure analytics: visibility and control \n\n10.6.1 Security Protocols \n\nOpen Trust Protocol (OTrP) is a protocol that manages security configuration in a Trusted Execution Environment (TEE) and is used for installing, updating and deleting applications and services. \n\n15 https://en.wikipedia.org/wiki/Sandbox_(software_development) [for usages of sandbox for software development] \n\n420 Internet of Things: Architecture and Design Principles \n\nFollowing DTLS and X.509 security protocol details can be referred from Section 3.2.1. \n\n\u25cfDTLS (Datagram Transport Layer Security) protocol is for maintaining the privacy during the datagram which communicate when using the CoAP or L2M2M clients and servers. It enables protection from eavesdropping, tampering or message faking. The basis of DTLS protocol is Transport Layer Security (TLS) protocol for data segment communication using the transport layer. \n\n\u25cfX.509 protocol refers to issue of a digital certificate with a trust based on TTP authorised certification authority. It deploys a Public Key Infrastructure (PKI). The PKI manages the digital certificates and public-key encryption. It is a subunit of TLS protocol used for securing communication with the web. \n\nReconfirm Your Understanding \n\n\u25cfIETF draft recommends five security profiles and the security model for each profile. \n\n\u25cfProfiles 0, 1, and 2 are for 6LowPAN/CoAP use, home usages and managed home usage. \n\n\u25cfProfiles 0, 1, and 2 security profiles use no temper resistant, and sharing of keys based message communication. \n\n\u25cfProfiles 3 and 4 are industrial and advance industrial usages and these use temper-resistant, key and process separation or sandbox. \n\n\u25cfCISCO suggests a security framework based on authentication, authorisation, network enforced policy and secure analytics: visibility and control. \n\nSelf-Assessment Exercise \n\n1. Why does 6LowPAN/CoAP communication need no temper resistance? 2. Why do home usage with no central device or with central device \n\ncommunication need sharing of keys between layers and no provision for prevention of tempering? 3. Why do industrial usage operations between things that enable and rely on \n\nlocal or back-end devices for security need sharing of keys between layers and key and process separation? 4. Why do ad-hoc operations between things that enable and rely on central \n\ndevice or a collection of control devices for security in the advanced industrial usages and using distributed and centralised (local and/or backend) security architecture need no provision for prevention of tempering and sharing of keys between layers/key and process separation sandbox. 5. What are the features of key sharing? 6. What are the four FCs in CISCO IoT secure environment framework? \n\n\u2605 \u2605 \n\n\u2605\u2605\u2605 \n\n\u2605\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605 \n\nIoT Privacy, Security and Vulnerabilities Solutions 421 \n\nKey Concepts \n\n\u25cfAttack surface \n\n\u25cfAuthentication \n\n\u25cfAuthorisation \n\n\u25cfDecryption \n\n\u25cfDigest \n\n\u25cfDigital certificate \n\n\u25cfEncryption \n\n\u25cfHash \n\n\u25cfKey exchanges \n\n\u25cfKey generator \n\n\u25cfLayered attack model \n\n\u25cfLayered attack solution \n\n\u25cfLink level security \n\n\u25cfNon-repudiation \n\n\u25cfPrivacy \n\n\u25cfSecure hash algorithm \n\n\u25cfSecurity \n\n\u25cfSecurity model \n\n\u25cfSecurity tomography \n\n\u25cfSigned message \n\n\u25cfThreat analysis \n\n\u25cfTrust \n\n\u25cfTrusted party certificate \n\n\u25cfVulnerability \n\nLearning Outcomes \n\nLO 10.1 \n\n\u25cfOWASP gives definitions of vulnerabilities and highlights top ten IoT vulnerabilities \n\n\u25cfTrust, security and privacy are required in IoT \n\n\u25cfMessage-privacy need should ensure that messages do not reach unrelated entities and reach from the things to the desired applications/services only. \n\n\u25cfSecurity features incorporate in number of standards for IoT. \n\n\u25cfOWASP specifies the attack surface areas for vulnerabilities. \n\n\u25cfAn IoT reference architecture specifies functional view. A functional view has security function group (FG). Five functional components (FCs) in the FG between the application/service and device are identity management (IDM), authentication, authorisation, key exchange and management, trust and reputation. \n\n\u25cfA threat analysis tool can uncover flaws in any security design. \n\nLO 10.2 \n\n\u25cfUML notation use case diagrams are required for FCs of security FG. \n\n\u25cfUse cases analysis enables requirements analysis. Use cases are a key feature of many models and frameworks for developing the processes. \n\n\u25cfExamples of need of use cases are boot-process protection, secure software and firmware updates, stored data encryption and integrity protection. Data store needs protection from hackers \n\n\u25cfMisuse cases define the required behaviour of components under development which should not happen. This highlights the threats to enable designing new use cases for preventing attacks and find out what should not happen. \n\nLO 10.3 \n\n\u25cfSecurity tomography technique enables fast detection of attack-vulnerable sections/subsections in a complex set of networks such as network of WSNs. \n\n\u25cfSecurity tomography means finding attack-vulnerable sections/subsections by observations for behaviours using a finite number of objects or threats in a complex set of subsystems. \n\n\u25cfData between the things and application/service communicate through six layers and their sublayers. \n\n\u25cfLayered attacker model specifies the vulnerabilities at each layer. \n\n422 Internet of Things: Architecture and Design Principles \n\nLO 10.4 \n\n\u25cfA message communicates using the ID of the device platform/application/service. \n\n\u25cfAn FC, \u2018ID Management\u2019 FC of security FG manages the IDs. \n\n\u25cfAuthentication, authorisation, key exchanges and management are also FCs of the Security FG. \n\n\u25cfID establishment and authentication are essential elements of access control. A hash function or MD5 enables authentication. \n\n\u25cfAccess control server and data-communication gateway can be centrally used to control accesses between application/service and IoT devices. Authorisation functions authorise the access for messages at one end from the other end. Authorisation models specify coarse-grain access control and fine-grain access control. \n\n\u25cfThe messages communicate using keys. Keys need to be exchanged before the authentication- code, authorisation commands and encrypted messages communicate. \n\n\u25cfHash algorithm enables message integrity checks. \n\n\u25cfNon-repudiation assures security when signed messages are used, and a digital certificate issuing TTP is used for digital certificates. \n\n\u25cfMessage-availability ensures prevention of DoS attacks, which can be due to a number of reasons. \n\nLO 10.5 \n\n\u25cfIETF draft recommends five security profiles and a security model for each profile. \n\n\u25cfProfiles 0, 1, and 2 are for 6LowPAN/CoAP use, home usages and managed home usage and Profiles 3 and 4 are industrial and advance industrial usages and these use temper-resistant, key and process separation/sandbox. \n\n\u25cfCISCO also suggests a security framework based on authentication, authorisation, network enforced policy and secure analytics: visibility and control \n\nExercises \n\nObjective Questions \n\nSelect one correct option out of the four in each question. \n\n1. Encryption is a (i) process of generating new data or (ii) new authentication code \n\nusing a secret key known only to a receiver (iii) Sender and receivers need not identify each other and know the keys that will be used by them. (iv) The encryption uses 32- bit, 64 bit, 128 bit, 192 bit or 256-bit key or MAC address for encrypting. (a) (i) (b) (ii) and (iv) \n\n(c) All (d) (i), (ii) and (iii) 2. OWASP has identified top ten vulnerabilities in IoT applications/services \n\nas (i) secure web interface, (ii) insufficient authentication or authorisation, (iii) secure network services, (iv) lack of transport encryption/integrity verification, (v) privacy concerns, (vi) insecure cloud interface, (vii) insecure mobile interface, \n\n\u2605 \n\n\u2605\u2605 \n\nIoT Privacy, Security and Vulnerabilities Solutions 423 \n\n(viii) insufficient security configurability, (ix) insecure software or firmware and (x) poor physical security. (a) All except (i) (b) All except (i) and (iii) \n\n(c) All except (ii) and (iv) (d) (ii) to (ix) 3. Functional Components (FCs) of security are defined in IoT reference architecture \n\nand they are (i) identity management, (ii) authentications, (iii) authorisation, (iv) key exchange and management, (v) trust and reputation, (vi) physical device security, and (vii) security configurability. (a) (ii) to (v) (b) (ii) and (iii) \n\n(c) (i) to (v) (d) (ii) to (vii) 4. OWASP definitions for cloud web interface attack surface area contains the following \n\nattacks: (i) SQL injection, (ii) cross-site scripting, (iii) cross-site request forgery, (iv) account lock out, (v) username enumeration, (v) weak passwords, and (vi) known default credentials, (vii) transport encryption, (viii) encrypted personally identifiable information (PII) sent unencrypted PII, (ix) sent device information leaked and (x) location leaked and (xi) cloud user data disclosure. (a) All (b) All except (vii) to (xi) \n\n(c) (v) to (xi) (d) (i) to (v) 5. Microsoft Threat Analysis Tool 2014 analysis view shows the (i) threats which are \n\nactive and (ii) which are inactive. (iii) \u2018Data Store accessible\u2019 is a threat. The view also shows the (iv) process category, (v) stride category, (vi) \u2018spoofing\u2019 is a stride category, and (vii) \u2018denial of service\u2019 category threat. (a) All except (iii) and (ivi) (b) All except (iii) and (iv) \n\n(c) (ii) to (vii) (d) (i) to (vi) 6. (i) Use cases use UML notation. (ii) Use cases analysis enables requirements analyses. \n\n(iii) Use cases are key feature of many models and frameworks for (iv) processes, and (v) API development. (v) Oracle Unified Method (OUM) and IBM Rational Unified Process (RUM) are examples of software components and module development using use case. (a) All are except (ii) (b) All except (ii) and (v) \n\n(c) All (d) All except (iii) and (v) true 7. An object identifier (OID) in IoT can have the following identifiers: (i) URI, (ii) MAC \n\naddress, (iii) IP address, (iv) types of things, (v) class identifier, and (vi) instance identifier. (a) All except (iv) (b) All except (ii) and (iii) \n\n\u2605 \n\n\u2605\u2605 \n\n\u2605\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605 \n\n424 Internet of Things: Architecture and Design Principles \n\n(c) All except (i) (d) (iv) to (vi) 8. Trusted Third Party (TTP) service (i) certifies a digital signature, (ii) protects the \n\nprivate (secret) key and (iii) issues the certificate that message was sent using this specific private (secret) key of source, (iv) shares key with all and (v) only one permitted to be the repository for public key certificate and keys. (a) All except (ii) and (iv) (b) All except (ii) and (v) \n\n(c) All except (iv) and (v) (d) (i) and (v) 9. Access control allows only authorised (i) device or (ii) application/service access a \n\nresource, such as (iii) web API input, (iv) IoT device, (v) sensor or (vi) actuator data or (vii) URL. (viii) Authorisation model is an essential element of secure access control. (ix) Coarse-grain authorisation means web application access authorisation. (a) All except (i) (b) to (viii) \n\n(c) All except (viii) and (ix) (d) All except (vii) 10. Layer 2 attack solutions are (i) network switches programmed to prevent internal \n\nnode attacks during use of (ii) DHCP, (iii) STP (Spanning Tree Protocol) or (iv) IP. (v) Additional controls may include ARP inspection, (vi) disabling unused ports and (vii) when using LWM2M client device gateway to the Internet, then have provisions for MAS (M2M Authentication Server) for security, (viii) root key data store and (ix) devices and data authentication. (a) All except (iv) (b) All except (iv) and (viii) \n\n(c) All except (v) (d) All except (ii) and (v) true \n\nShort-Answer Questions \n\n1. What are the focuses of OWASP? [LO 10.1] 2. Compare requirements of trust, privacy and security. [LO 10.1] 3. What are the meanings and kinds of functional view, functional group and functional \n\ncomponent in IoT reference architecture? [LO 10.1] 4. What does device management and device data integrity refer to? [LO 10.1] 5. When and why is threat analysis performed? [LO 10.1] 6. Why is management of keys important? [LO 10.2] 7. When is security tomography useful? [LO 10.3] 8. When is SQL injection a potential threat? [LO 10.3] 9. What are the layer 1 attack solutions for wireless devices? [LO 10.3] 10. How is the access of a web API controlled in a web service? [LO 10.4] 11. When do you use authentication and authorisation? [LO 10.4] 12. How does the layer attack model differ from the IETF recommended security model \n\nfor security profile requirements? [LO 10.5] 13. When and why do we need to use OTrP for IoT applications and services? [LO 10.5] 14. Why do we need TEE in IoT? [LO 10.5] \n\n\u2605\u2605 \n\n\u2605\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605 \u2605\u2605 \u2605\u2605\u2605 \n\n\u2605 \u2605\u2605 \u2605\u2605 \u2605\u2605\u2605 \n\n\u2605 \u2605\u2605 \u2605\u2605\u2605 \n\n\u2605 \u2605 \n\n\u2605\u2605\u2605 \n\n\u2605\u2605 \n\nIoT Privacy, Security and Vulnerabilities Solutions 425 \n\n15. When do we use DTLS and when X.509?` [LO 10.5] \n\nReview Questions \n\n1. What are attack surface areas in DWI and CWI defined in OWASP? [LO 10.1] 2. How is the display view during threat analysis for a system when using Microsoft \n\nthreat modelling tool 2014? [LO 10.1] 3. What are the security requirements during message exchanges between devices to \n\napplications/services? [LO 10.1] 4. Why are misuse cases important for security threats? [LO 10.2] 5. How does the Misuse Cases help in secure design? [LO 10.2] 6. Draw a diagram showing possible attacks at the layers. Take OSI modified six-layer \n\nIoT model as reference. [LO 10.3] 7. Describe the steps for verification of message and digital signature for non- \n\nrepudiation. [LO 10.4] 8. Show steps for message integrity check. [LO 10.4] 9. Describe access-authorisation methods. [LO 10.4] 10. What are the security model profiles and protocols for the IoT specified in the IETF \n\ndraft? [LO 10.5] \n\nPractice Exercises \n\n1. Search https://www.owasp.org/index.php/OWASP_Internet_of_Things_Project for \n\nOWASP subprojects and list them. [LO 10.1] 2. Search the reported results of CERT Coordination Centre (CERT/CC) at Carnegie \n\nMellon University initiative for coordination the vulnerabilities in IoT devices. \n\n[LO 10.1] 3. Show use case diagram for streetlight sensors for ambient light, traffic density and \n\nstreetlight working status communication to a gateway. [LO 10.2] 4. Tabulate the attacks in IoT applications/services at each layer. [LO 10.3] 5. Tabulate the layer attack solutions for each layer. [LO 10.3] 6. Draw and show the steps for sending encrypted data after authentication. [LO 10.4] 7. Show the steps by diagrams for identity management. [LO 10.4] 8. Redraw Figure 10.5 and show steps during key exchanges and management, \n\nauthentication and authorisations followed by secure communication of message from to the device/gateway to application/service. [LO 10.4] 9. What do you mean by security model for industrial usages in IoT? [LO 10.5] \n\n\u2605 \n\n\u2605 \u2605\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605 \u2605 \n\n\u2605\u2605\u2605 \n\n\u2605\u2605 \u2605\u2605 \u2605\u2605\u2605 \n\n\u2605 \n\n\u2605\u2605\u2605 \n\n\u2605 \n\n\u2605 \u2605\u2605 \u2605\u2605 \u2605\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605 \n\n",
  "createdAt": "2026-02-17"
}