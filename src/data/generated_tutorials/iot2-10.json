{
  "title": "10",
  "slug": "iot2-10",
  "description": "Module from iot2.pdf: 10",
  "tags": [
    "iot2",
    "Elite"
  ],
  "content": "# 10\n\n\nIoT Privacy, Security and \nVulnerabilities Solutions \n\nLearning Objectives \n\nLO 10.1 \nExplain the requirements of privacy and security, vulnerabilities from threats, and \nneed of threat-analysis in IoT \nLO 10.2 \nFamiliarise with modelling using use cases and misuse cases \nLO 10.3 \nOutline security tomography of large networks and layered attacker model \nLO 10.4 \nExamine functions for source identity-management, identity-establishment, device \nmessages access-control, message-integrity, message non-repudiation and availability \nin IoT applications and services \nLO 10.5 \nDescribe security model, security profiles and security protocols for IoT \n\nRecall from Previous Chapters \n\nChapter 1 introduced IEEE P2413 standard which provisions for reference architecture that builds \nupon a reference model. The reference architecture covers the definition of basic architectural \nbuilding blocks and their integration capability into multitiered systems. The framework \nincludes the provisions for the quality \u2018quadruple\u2019 trust that includes protection, security, \nprivacy and safety. \n\nThe chapter also introduced communication modules for IoT that include a cryptographic \nprotocol TLS or DTLS for secure Internet communication, and DeviceHive for M2M platforms \nand their integration that includes web-based management software which creates security \nrules-based networks and monitors the devices. \n\nIoT Privacy, Security and Vulnerabilities Solutions \n397 \n\nChapter 2 introduced data privacy and security steps. For example, a device data can be encrypted \nat physical (device) layer for security on the network. The devices can opt for link-level as well \nas service-level security, just the service level or unsecured level. Example of service level is use \nof TLSv1.2 public key (RSA and ECC) and PSK cipher suite for providing the transport level \nsecurity end-to-end security protocols. End-to-end means application layer to physical layer. \nThe chapter also introduced usage of Wireless Protected Access (WPA) and Wired Equivalent \nPrivacy (WEP) security sublayer because wireless communication needs security , integrity and \nreliability . \n\nChapter 3 described features of DTLS. The DTLS has provisions for three types of security services, \nviz. integrity , authentication and confidentiality . LWM2M OMA specification for device gateway to \nInternet has provisions for M2M Authentication Server (MAS) for security, root key data store, \nand devices and data authentication. XMPP protocol includes layer Simple Authentication and \nSecurity Layer (SASL) for security. \n\nChapter 4 introduced IPv6 at IP layer which includes headers for managing device mobility, \nsecurity and configuration aspects. IPv6 uses AES-128 security = 21 B header. \n\nChapter 5 introduced data centres provision for data security and protection using advanced tools, \nfull data backups along with data recovery and redundant data communication connections, \nservers and data centres high security standards high degree of security and integrity and \neffective protection of data, files and databases at the organisation. \n\nChapter 6 introduced data security at cloud servers in a multi-tenant environment. Data needs \nhigh trust and low risks, and security from the loss of users\u2019 control. Security provisions as per \nthe developer requirements are the responsibilities of cloud service providers. Nimbits cloud \nservers for the device provisions usage of security tokens and provisions data integrity. \n\nChapter 7 introduced sensor level security and participatory sensing challenges of security, \nprivacy and reputation. Section 7.6 described security challenges in RFID usages. RFID IDs need \nprovisioning for full implementation of privacy and security needs and data processing at the \ntag and reader with access encryption and authentication algorithms. A security issue in an \nRFID network is a vulnerability to external virus attacks. Section 7.6.2 described methods of \nsecuring communication for WSNs, including usages of Berkeley laboratories suggested SPINS \nSymmetric Cryptographic Protocols [Secure Network Encryption Protocol (SNEP), and micro- \nTesla ( m -Tesla)]. \n\nChapter 8 introduced: (i) Arduino using WiShield Library 1 preinstalled with the IDE for \nWi-Fi interface security; (ii) RPi IDE security interfaces; (iii) mBed device platform; and (iv) REST \nAPIs for administration, security, data flow, device, multitenancy, authentication, directory and \nsubscription management. \n\nChapter 9 introduced security of data for embedded device platforms. The chapter described the \nauthentication process and uses of result of the hash algorithmic functions or message digest \noperation. The chapter gave examples of using crypto-library functions in the cryptosuite. 2 \n\nChapter 9 also described encryption process using AES or DES algorithms for encryption. The \nkey length can be 128, 192 or 256 bits. Data encryption can use AES256 (Advanced Encryption \n\n1 http://github.com/asynlabs/WiSield \n2 http://code.google.com/p/cryptosuite \n\n398 \nInternet of Things: Architecture and Design Principles \n\n10.1 \nINTRODUCTION \n\nInternational organisations are making a number of efforts towards ensuring that IoT \ndesign must ensure trust , data security and privacy . \n\nTrust is important. For example, consider the messages and \nvideo clips of the operations from the ATMs to server. A user \nplaces the trust in the bank that sensitive information will not be \ndisclosed which can harm the user. When things communicate \nin an analogous manner, then trust of safe use of data exists. When one tweets on Twitter, \ntrust must exist that no one will harm him/her due to his tweets. Tweets expose ones\u2019 \nbehaviour, thinking about the actions, inactions and policies of government officials and \nfunctionaries. Trust in IoT context means dependability, accuracy, quality of data from \nmultiple sources for the intended applications and services. \n\nAn organisation, Open Trust Alliance 3 established IoT Trustworthy Group (ITWG) \nfor recognising the priority (must in designs for security and privacy) from the onset of \nproduct development and addressing holistically. \n\nAn organization, \u2018I am the Cavalry\u2019 4 has prescribed an Oath for connected medical \ndevices on the lines similar to Hippocratic Oath which is attestation by physicians to \nprovide care in the best interest of patients. The medical devices should have commitments \nto capabilities that preserve patient safety, as well as trust in the process of delivering care \nitself. \n\nSecurity is important. For example, consider the ATM messages. They should communi- \ncate on Internet securely. The security distortions can lead to serious consequences. \n\nA smart city security is also important. The city deploys smart health, public safety, \ntransport, and deploys IoT and smart home applications and services. An organization 5 \n\nhas taken initiative for solving cyber security problems in smart cities. \n\nPrivacy is important. The video clips communicate on the Internet in a smart home \nsecurity application. If the clips reach unrelated entities, it can lead to serious breach of \nhome security. \n\n3 https://www.otalliance.org \n4 https:www.iamthecavalry.org \n5 http://securingsmartcities.org \n\nDesign must ensure \ntrust, data security and \n\nprivacy in IoT \n\nStandard 256-bit encryption key length) or DES (Data Encryption Standard). Arduino AES 256 \nlibrary can be downloaded and used for Arduino boards. Authentication can be by using SHA1/ \nSHA256 secured hash algorithms or MD5 message digest algorithm. Eclipse Californium has \nDTLS security implementations. \n\nPrevious chapters described security protocols and standard implementations at device to \napplication and service levels. Security, privacy, authentication, encryption and protection are \nmust for end-to-end solutions from device level to network and application/service levels. \n\nIoT Privacy, Security and Vulnerabilities Solutions \n399 \n\nIndustrial Internet Consortium 6 (IIC) was formed by Intel, IBM, CISCO, GE and AT&T \n(2014) for coordinating efforts and initiatives to connect and integrate objects. Another \norganisation, AllSeen Alliance 7 established by Linux Foundation is a collaborative project \nof cross-industry consortium which is dedicated for enabling the interoperability of \nbillions of IoT devices and applications/services. \n\nFollowing are the terms, whose meanings must be understood before learning the \ntopics covered in this chapter. \n\nMessage is a string that represents data or client-request or server-response which \ncommunicates between sender and receiver objects. \n\nHash refers to a collection or bundle which gives an irreversible result after many \noperations on data and the operations are just one way. For example, when wheat crop \nis ripe and cut, hashing process separates out the grains which are used for consumption \nand the resultant waste is discarded. When data such as user ID and password needs \nsecret communication for the purpose of authentication, then it is communicated after \na set of standard operations on the usage of an algorithm, called secure hash algorithm. \nThe algorithm generates a fixed size, say, 128, or 256-bit value using a secret key. Only the \nhash value communicates. Receiver-end retrieves the hash value, and compares that with \nstored hash value. If both are equal then the sender message is authenticated. \n\nDigest is a process which gives the irreversible result involving many operations. A \nstandard algorithm called MD5 (Message Digest 5) is also used for digest, similar to the \nhash value. Receiver-end stores the digest value expected to be obtained after the MD5 \noperations, and compares that with received value. If both are equal then the sender \nmessage is authenticated. \n\nEncryption is a process of generating new data using a secret key known only to a \nreceiver. Before sending the encrypted data, the sender and receiver, both identify each \nother and know the key that will be used by them. The encryption uses a 128, 192 or 256- \nbit key for encrypting the data. \n\nDecryption is a process which retrieves the data from the encrypted data. \nUse Case means a list of event steps or actions which define the interactions between two \nends, in which one is playing the role and other is the system. The steps accomplish a task \nor goal or mission. One end is called actor in Unified Modelling Language (UML), while \nother end is the system . Use Case is a software engineering term. For example, an API is \nplaying the role of obtaining inputs (events) and generation of outputs which interact \nwith the system such as a web server or web API or service or web application using a \ncallback() function as per the output (Sections 9.2 and 9.4). Use cases define the required \nbehaviour of software under development. Use cases describe the details of usages of \nsoftware and its normal behaviour. \n\nMisuse Case can be understood as reverse sense of Use case. Misuse case defines the \nbehaviour which is not required from the software under development. A Misuse case \n\n6 https://www.iiconsortium.org \n7 https://www.allseenalliance.org \n\n\n![Image](/src/assets/generated_images/iot2_p426_i0.png)\n400 \nInternet of Things: Architecture and Design Principles \n\ndefines the behaviour which should not happen. This in turn specifies the threats also. \nMisuse case gives information and renders help in identifying the requirement of new \nUse cases for prevention of attack and find out what should not happen. \n\nLayer means a stage during a set of actions at which the action is taken as per the specific \nprotocol or method and then the result passes to the next layer until the set of actions \ncompletes (Figures 2.1 to 2.3). A design using the layers\u2019 model enables representation of a \nset of systematic actions which are followed sequentially for accomplishing a task. \n\nSublayer is a layer consisting of various sublayers in a model to provide set of actions \nsequentially taking place at the layer. \n\nFirewall is a software interface, which interconnects networks with differing trusts, and \nis immune to penetration and provides perimeter defence. It functions as a choke point for \ncontrolling and monitoring. It does auditing and provides controlled accesses. It allows \nonly authorised traffic and imposes restrictions on network services. It can raise alarms \nfor abnormal behaviours. \n\nFollowing sections describe the processes and actions for ensuring security and privacy \nthat are taken at the device, network, transport, application and service levels. Section 10.2 \ndescribes IoT vulnerabilities, security requirements and method of analysis of the threats \nto privacy and security. Section 10.3 describes Use cases and Misuse case methods. Section \n10.4 describes the security tomography uses in large networks, such as RFID networks \nand WSNs. This section also describes layer model of attacks. Section 10.5 describes how \nthings (embedded devices, sensor or actuators) establish their identity before the messages \nare used by them after set of message exchanges on the Internet. This section also describes \npractical aspects of access control, message integrity, non-repudiation and availability. \nSection 10.6 describes security model for IoTs. \n\n10.2  VULNERABILITIES, SECURITY \n\nREQUIREMENTS AND THREAT ANALYSIS \n\n10.2.1 \nPrivacy \n\nMessage privacy means that the message should not reach \ninto the hands of the unrelated entities. When data or \nmessages communicate from the things (device platforms), those are meant only for the \napplications or services and for targeted goals only. \n\nPrivacy also means no interference or disturbance from other. Consider an example of \nmessages from embedded devices in an automobile using the Internet to an automobile \nservice centre (Example 5.2). Privacy means the messages reach only the centre and used \nonly by the services of the centre. Another automobile company on whose hands the data \nfalls may face serious business consequences. \n\nExplain the \nrequirements of \nprivacy and security, \n\nvulnerabilities from \n\nthreats and threat \n\nanalysis in IoT \n\nLO 10.1 \n\nIoT Privacy, Security and Vulnerabilities Solutions \n401 \n\nIoT necessarily need privacy policy. A privacy policy needs to determine that \u2018how \nmuch of the IoT devices data and which data need absolute privacy and which need \nlimited privacy\u2019. Company authorities need the support for accessing the data which may \nbe private for individuals. The authorities also need to respect the individual customer \nneeds of privacy and understand that privacy is a legitimate human need. Privacy policy \nvendors should take privacy seriously. They must respect their customers enough to \nunderstand that the privacy is a legitimate human need. \n\nNational Institute of Standards and Technology (NIST), USA is developing the standards \nfor privacy. A system may be secure but may inadvertently breach the privacy of an \nindividual. A tracking service may track a vehicle while does not want his/her movements \nto be tracked. \n\nSecurity authorities and agencies need support for accessing data which may be private \nfor individuals. The authorities also need to respect the individual\u2019s needs. \n\nPrivacy standards for IoT data are under development. \nA community organisation is \u2018I am The Cavalry\u2019. 8 \u2018Cavalry\u2019 \nmeans a group of soldiers who used horses in earlier centuries \nor formed part of army that used fast armoured vehicles. The \nCavalry focuses on computer security issues where these interact \nwith public safety, such as medical devices, automobiles, public \ninfrastructure and home electronics. The organisation strives to \nensure that these technologies are worthy of the trust. \n\n10.2.2 \nVulnerabilities of IoT \n\nVulnerability means weak without complete protection, weakness to defend oneself or \ncan be easily influenced from surrounding unwanted things from itself. An IoT security \narticle describes that there are many vulnerabilities, due to participation of the number of \nlayers, hardware sublayers and software in applications and services. 9 The nature of IoT \nalso varies. For example, sensors, machines, automobiles, wearables, and so on. Each faces \ndifferent kind of vulnerabilities and has complex security and privacy issues. \n\nIoT network can be vulnerable to eavesdropping. Eavesdropper creates security issues. \nAn eavesdropper, say E , listens to the messages and commands in the network during \ncommunication and obtains confidential messages. A server at E sends fake commands \nwhich a server S for the devices data assumes that are from the devices or applications. \nS issues responses for the device operations in response to requests from E . E listens \nthese responses. A fake device at E can be used to send the device data, such as sensor \ndata, requests and commands from E for disrupting the control system. Use of secret key \nencryption can protect the messages to and from device, server, application or service. \n\n8 https:www.iamthecavalry.org \n9 http://www.networkcomputing.com/internet-things/iot-security-privacy-reducing-vulnerabilities/807681850 \n\nIoT system \nvulnerabilities are \nnumerous, due to \n\nparticipation of a \nnumber of layers, and \nhardware and software \n\ncomponents \n\n402 \nInternet of Things: Architecture and Design Principles \n\nThe key is a device software-generated string which can be cracked by trying large \nnumber of combinations. Device unique ID and authentication issues exist in negligible \nuser interaction scenario. \n\nSecurity features needs to be incorporated in a standard format recommended for IoT. \nFor example, a standard for electronic products architecture is from a developing group, \nEPCglobal. The group is responsible for creation and maintenance of privacy policy \nproducts. \n\nOpen Web Application Security Project 10 (OWASP) has undertaken the associated \nsecurity issues of IoT for the purpose of helping developers, manufacturers and consumers. \nOWASP is open source and has free to use licensing policy. Project is community-model- \nbased software development initiative. A community model is making collective efforts \nand initiative by universities, organisations and institutions in an open source project. \nOWASP has undertaken a number of security related subprojects, such as ones for \ndefining, the \u2018Top Vulnerabilities\u2019, \u2018Attack Surface Areas\u2019 and Testing Guides\u2019. \n\nOWASP has identified top ten vulnerabilities in IoT applications/services as follows: \n\n\u25cf Insecure web interface \n\n\u25cf Insufficient authentication or authorisation \n\n\u25cf Insecure network services \n\n\u25cf Lack of transport encryption/integrity verification \n\n\u25cf Privacy concerns \n\n\u25cf Insecure cloud interface \n\n\u25cf Insecure mobile interface \n\n\u25cf Insufficient security configurability \n\n\u25cf Insecure software or firmware \n\n\u25cf Poor physical security \nReader can refer to the OWASP project definitions of IoT attack surface areas. Attack \nsurface areas mean the areas in software or hardware which are vulnerable to attack \n(Example 10.1). \n\nExample 10.1 \n\nProblem \nWhat are the attack surface areas in Device Web Interface (DWI) and Cloud Web Interface (CWI) defined in \nOWASP? \n\nSolution \n\nFollowing are attack surface areas for DWI: SQL injection, cross-site scripting, cross-site request forgery, \naccount lock out, username enumeration, weak passwords and known default credentials. \nFollowing are attack surface areas for CWI: SQL injection, cross-site scripting, cross-site request forgery, \naccount lock out, username enumeration, weak passwords and known default credentials, same as ones for \nDWIs plus transport encryption, encrypted personally identifiable information (PII) sent, unencrypted PII \nsent, device information leaked and location leaked and cloud user data disclosure, user/device location \ndisclosure and differential privacy. \n\n10 https://www.owasp.org/index.php/OWASP_Internet_of_Things_Project \n\nIoT Privacy, Security and Vulnerabilities Solutions \n403 \n\nCERT Coordination Centre (CERT/CC) at Carnegie Mellon University (CMU) has \ntaken the initiative for coordinating the vulnerabilities in IoT devices. 11 CERT stands for \nComputer Emergency Response Team at CMU Software Engineering Institute. The team \nresearches on software bugs that impact software and Internet security. \n\nRefer to work of Danj K. Klinedinst web hosted in January 2016. 12 The team completed \na survey for vulnerabilities in common home Wi-Fi routers in 2015 and reported a number \nof vulnerabilities database. \n\n10.2.3 Security Requirements \n\nIoT reference architecture means a guide for one or more concrete architects. IoT reference \narchitecture is a set of three architectural views\u2014functional, information, and deployment \nand operational. A functional view is from F. Carrez and co-workers 13 . Security is one \nof the functional groups (FG) of the functional view. FG for security consists of security \nfunctions between the application and device. \n\nSecurity FG contains five sets of functions which are required for ensuring security and \nprivacy. Large number of devices, applications and services communicate in IoT. Five \nfunctional components (FCs) of security are defined in IoT reference architecture. \n\nFollowing are five functional components (FCs): \n1. Identity management (IdM) \n2. Authentications \n3. Authorisation \n4. Key exchange and management \n5. Trust and reputation \n\nFigure 10.1 lists the functions of a security function group in functional view in IoT \nreference architecture. \n\n10.2.4 Threat Analysis \n\nA threat-analysis tool first generates the threats and analyses a system for threat(s). Threat \nanalysis means uncovering the security design flaws after specifying the stride category, \ndata flow diagram, elements between that the interactions occuring during the stride, \nand processes which are activated for analysis. Stride means a regular or steady course, \npace or striding means, passing over or across in one long step (set of statements when \nconsidering a threat to a software component). Stride means taking a long step for dainty \nlittle steps. Example 10.2 shows the case of a threat-analysis tool for analysis during a \nstride. \n\n11 https://insights.sei.cmu.edu/cert/2016/01/coordinating-vulnerabilities-in-iot-devices.html \n12 http://www.kb.cert.org/vuls/ \n13 F. Carrez and co-workers, 2013, as referred in book A Jan Holler and co-workers, \u201c M2M to Internet of Things\u2014Introduction \nto a New Age of Intelligence \u201d, Chapter 8 Academic Press/Elsevier, 2014. \n\n404 \nInternet of Things: Architecture and Design Principles \n\nExample 10.2 \n\nProblem \nHow is the threat analysis for a system performed using Microsoft Threat Modelling Tool 2014? \n\nSolution \n\nA model is designed for threat analysis with definitions of strides and elements. The interacting elements \nare processes, data store, flow, boundary or may be external specified elements in the system. The tool has \nthree components: Getting started guide, Create a model and Open a model. \u2018Create a model\u2019 is used after \n\u2018Getting started guide\u2019. The tool component \u2018open the model\u2019 precedes the threat analysis for each stride. \n\nThe tool also provisions for definitions of new threats using a stride category. A stride category is first \ncreated which generates a list of threats which are active and based on interactions between the elements. \nThe list is as per the definitions in the model open for analysis. \n\nFigure 10.2 shows an example of tool usage for threat analysis during a web service interaction between \nthe application and web. \nExamples of element types are process, data store, flow, boundary and an external specified element. Tool \npredefines a number of threat categories. A new category can also be created. The tool suggests threat \ndefinitions and generates the mitigation solutions automatically. \nThe tool messages on display (analysis view) show the vulnerabilities and the data flow diagram. For \nexample, data flow between the device and application or service. \n\nThe analysis view shows threats which are active and which inactive. An example of threat is \u2018data store \ninaccessible\u2019. The view also shows the category in which it is active and inactive. A stride category example \nis \u2018spoofing\u2019 and threat is \u2018spoofing the web context process\u2019. Another example of threat is \u2018denial of service \ncategory\u2019. \n\n1: \n\n2: \n\n3: \n\n4: \n\n5: \n\n1: Applications \n2: Business \n\nApplications \n\n1: Identify \n\n2: Authentication \n\n3: Authorisation \n4: Key Exchange \n\nand Management \n\nManagement \n\n5: Trust and \n\nReputation \n\nApplication Support \n\nLayer APIs/ SW \nSecurity \nDevice \nNetwork \n\nTags \nActivation \n\nSensing \n\nStorage \n\nData \nProcessing \n\nFigure 10.1 \nSecurity function group components in functional view in IoT reference architecture \n\nIoT Privacy, Security and Vulnerabilities Solutions \n405 \n\nWeb \nContext \n\nLocal Web \nContext Boundary \nApplication \n\nLocal \nProcess and \n\nContext \n\nStore \nSystem \n\nHTTP \nHTTP \n\nInternet \n\nWeb Service \n\nFigure 10.2 An application threat model in Microsoft threat modelling tool display when \u2018diagram\u2019 item \n\nselected \n\nWhen a search item is for the element \u2018process\u2019 then the view displays the processes which are active and \ninactive among the OS process, Thread, Kernel Thread, Native Application or Managed Application, Thick \nClient, Browser Client, Browser, Active-X Plug-ins, Web Server, Web Application and Win32 Server. \n\nReconfirm Your Understanding \n\n\u25cf Message privacy functions ensure that messages do not reach into the hands of unrelated entities \nand reach from the things to the applications or services only. \n\n\u25cf IoT has a large number of vulnerabilities. This is due to participation of the number of layers, \nhardware sublayers, FCs, applications and services. \n\n\u25cf Secuity features must incorporate in a standard format recommended for IoT. \n\n\u25cf OWASP has identified vulnerabilities in detail and listed top ten vulnerabilities in IoT applications/ \nservices. They have also defined the attach surface areas for vulnerabilities. \n\n\u25cf CERT at CMU defined the vulnerabilities in common home WiFi routers and reported a number of \nvulnerabilities and listed them in a database. \n\n\u25cf An IoT reference architecture has three\u2014functional, information, deployment and operational. \n\n\u25cf Five functional components (FCs) in security functional group in-between the application/service \nand device are identity management, authentications, authorisation, key exchange and management, \ntrust and reputation. \n\n\u25cf A threat analysis tool uncovers the security design flaws after specifying the stride category, data \nflow diagram, elements between which the interactions occur during the stride, and specifying the \nprocesses which are activated for analysis. \n\n\n![Image](/src/assets/generated_images/iot2_p432_i0.png)\n406 \nInternet of Things: Architecture and Design Principles \n\n10.3 \nUSE CASES AND MISUSE CASES \n\nUML notation use case diagrams are required for the FCs of \na security FG. A use case analysis enables the requirement \nanalyses. Use cases are key features of many models and \nframeworks for processes development. Oracle Unified \nMethod (OUM) and IBM Rational Unified Process (RUP) are examples of frameworks for \nsoftware development process models and requirements analyses. \n\nFigure 10.3 shows a simple use case diagram for generating and communicating a key. \n\nEncryption Key \n\nSender \nApplication/Service \nEncryption Key Receiver \n\nGenerate \nrandom number \n\nGenerate Key \n\nSend Key \n\nKey \n\nFigure 10.3 \nSimple use case diagram for generating and communicating a key \n\nFamiliarise \nwith modelling \nusing use cases and \n\nmisuse cases \n\nLO 10.2 \n\nS elf-Assessment E xercise \n\n1. How do you define message privacy? \n2. What do you mean by trust? \n3. List the top ten vulnerabilities for attack. \n4. List the focus areas of \u2018I am the Cavalry\u2019 for computer security issues. \n5. List the focus areas of OWASP and importance of each in IoT security. \n6. Write the meaning of SQL injection, cross-site scripting, cross-site request \n\nforgery, account lock out, username enumeration, weak passwords, known \ndefault credentials, transport encryption, encrypted personally identifiable \ninformation (PII). \n7. Write the usage of five functions components in the security group of \n\nfunctions. \n8. List the steps in threat analysis when using Microsoft Threat Analysis Tool \n\n2014. \n\n\u2605 \n\u2605 \n\u2605 \n\u2605\u2605 \n\u2605\u2605 \n\u2605\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605\u2605\u2605 \n\nNote: \n\u2605 Level 1 & Level 2 category \n\n\u2605\u2605 Level 3 & Level 4 category \n\n\u2605\u2605\u2605 Level 5 & Level 6 category \n\nIoT Privacy, Security and Vulnerabilities Solutions \n407 \n\nExample 10.3 gives the use cases for security and privacy in IoT applications and \nservices. \n\nExample 10.3 \n\nProblem \nWhat are the examples of security issues for which use cases are required in IoT? \n\nSolution \n\nUse cases depict the requirements as follows: \n\n\u25cf Boot process protection: Boot process runs initial programs. If it corrupts then the system fails. \n\n\u25cf Secure software and firmware update: When software and firmware update, then secure updates are needed. \n\n\u25cf Stored data encryption and integrity protection: Data storage needs protection from hackers. \n\n\u25cf Platform integrity verification: The device platform integrity needs verification, else fake device platform \ncommunicates and the fake sends the command spoofing as the IoT device platform commands. \n\n\u25cf Key generation , management and exchanges need security as these are prerequisite for authentication, \nauthorisation and messages encryption. \n\n\u25cf Authentication of sender and receiver is must for secure message communication. \n\n\u25cf Secured communication through a network: Required for secure message exchanges between IoT devices \nand applications or services. \n\n\u25cf Lifecycle management: All messages, keys and data have specific life and need to be deleted from the \nsystem. \n\nFirstly, the actors and collaborating actors are identified. Then, misuse cases are \ndeveloped for each of them. Purpose of this is creating specifications for communicating \nthe potential risks and rationale for security-relevant decisions to the device platform, \napplication or service. Example 10.4 elucidates the misuse cases for security and privacy \nin IoT application/services. \n\nExample 10.4 \n\nProblem \nWhat are the examples of security issues for which misuse cases are required in IoT so that the requirements \nof new use cases can be analysed? \n\nSolution \n\nMisuse cases depict the requirements as follows: \n\n\u25cf Identity misuse cases \n\n\u25cf Non-repudiation \n\n\u25cf Crypto offloads: The transfer of cryptographic keys and messages need to be protected from eavesdropper \nor hackers \n\n\u25cf Eavesdropping \n\n\u25cf Fake server \n\n\u25cf Fake device platform \n\n\u25cf Flooding of TCP/SYN \n\n\u25cf Unauthorised access to a data store \n\n\u25cf Audit and accountability: Each transaction needs to be securely stored for future auditing and fixing \naccountabilities. \n\n\n![Image](/src/assets/generated_images/iot2_p434_i0.png)\n408 \nInternet of Things: Architecture and Design Principles \n\n10.4 \nIoT SECURITY TOMOGRAPHY AND \nLAYERED ATTACKER MODEL \n\n10.4.1 Security Tomography \n\nComputational tomography means a computing method of \nproducing a three-dimensional picture of the internal structures \nof an object, by observation and recording of the differences in \neffects on passage of energy waves impinging on those structures. \n\nComputational security in complex set of networks utilises \nthe network tomography procedures of identifying the network \nvulnerabilities. This enables design of efficient attack strategies. \n\nOutline security \n\ntomography of \nlarge networks and \nlayered attacker model \n\nLO 10.3 \n\nComputational security \n\nin complex set of \nnetworks and system \n\nutilises the security \ntomography procedures \n\nof identifying the \n\nvulnerabilities \n\nReconfirm Your Understanding \n\n\u25cf UML notation use-case-diagrams are required for FCs of a security FG. \n\n\u25cf Use cases analysis enables requirements analyses. Use cases are key feature of many models and \nframeworks for processes development. \n\n\u25cf Examples of use cases need are boot process protection, secure software, firmware update, stored \ndata encryption and integrity protection. Data storage need protection from hackers. \n\n\u25cf Misuse cases define the required behaviour of components under development which should not \nhappen. That highlights the threats to enable designing of new use cases for prevention of attack \nand find out what should not happen. \n\n\u25cf Example of misuse cases requirements are identity misuse cases and non-repudiation. \n\nS elf-Assessment E xercise \n\n1. What is the purpose of use cases? \n2. Explain the meaning of actors and collaborating actors in use cases. \n3. What is the purpose of misuse cases? \n4. Write the definition of each of the following terms: communicating the \n\npotential risks, rationale for security-relevant decisions, Misuse cases for key \nmanagement. \n5. Draw a use case diagram for creating authentication code using SHA1 \n\nalgorithm. \n6. Write meanings of misuse cases for identity, non-repudiation, crypto offloads, \n\neavesdropping, fake server and fake device platform. \n\n\u2605 \n\u2605\u2605 \n\n\u2605 \n\u2605\u2605 \n\n\u2605\u2605\u2605 \n\n\u2605\u2605\u2605 \n\nIoT Privacy, Security and Vulnerabilities Solutions \n409 \n\nA complex set of networks may be distributed or collaborative. Network tomography \nrefers to the study of vulnerabilities and security aspects for network monitoring in a \ncomplex system, such as WSNs, RFIDs or IoT networks and allocating resources and \nensuring network reliability and security. \n\nMonitoring of individual nodes is not fast acting and is also impractical. Network \ntomography helps in observing each network section (for example, a WSN nodes network \nbetween two access points) and subsections. The security tomography means finding \nattack vulnerable sections/subsections from the observations for behaviours using a finite \nnumber of objects or threats in a complex set of subsystems. \n\n10.4.2 Layered Attacker Model \n\nFigure 10.4 shows a layered attacker model and possible attacks on the layers. \n\n6: Applications/Services \n\n5: Applications Support \n\n4: Transport \n\n3: Network \n\n2: Data Adaptation \n\n1: Physical cum data-link layer \n\nPacket sniffing and DoS attacks such as Ping floods \nand ICMP attacks \n\nVulnerabilities in application/service can be \nexploited through attacks such as SQL injection, \nwhere the developer has failed to ensure that user \ninput is validated against a defined schema \n\nVulnerable ports \n\nUn-encrypted data store, tempering or sniffing \n\nInsecure in Ptotocols DHCP or STP, LAN node \nattack using MAC flooding or ARP poisoning \nPhysical or service disruption/attacts on wireless \nnetworks \n\nFigure 10.4 Layered attacker model and possible attacks using IETF six-layer modified model for \n\nIoT/M2M \n\nFollowing are the suggested solutions for mitigating the attacks on the layers (OSI \nmodified six layers IoT Architecture). \n\nLayer 1 Attacks Solution \n\nSolution depends on the devices used. For example, link-level provisioning of security \nuses\u2014BT LE link level AES-CCM 128 authenticated encryption algorithm for confidenti- \nality and authentication, and ZigBee at link-level security using AES-CCM-128. \n\n410 \nInternet of Things: Architecture and Design Principles \n\nLayer 2 Attacks Solution \n\nProgramming the network switches to prevent internal node attacks during use of DHCP or \nSpanning Tree Protocol (STP). Additional controls may include ARP inspection, disabling \nunused ports and enforcing effective security on VLAN\u2019s (Virtual LAN) to prevent VLAN \nhopping. VLAN refers to a group of end stations with a common set of requirements, \nindependent of a physical location. 14 VLANs have the same attributes as a physical LAN \nbut allow you to group end stations even if they are not located physically on the same \nLAN segment. \n\nLWM2M OMA specification for device gateway to the Internet has provisions for MAS \nfor security, root key data store, and devices and data authentication. \n\nLayer 3 Attacks Solution \n\nUse of temper resistant router, use of packet filtering and controlling routing messages \nand packets data between layers 3 and 4 through a firewall reduces the risks. \n\nLayer 4 Attacks Solution \n\nPort scanning method is a solution which identifies the vulnerable port. A solution is the \nopening of network ports and configuring effectively the firewall, and locking down ports \nonly to those required. A solution is DTLS between layers 5 and 4. The DTLS has provisions \nfor three types of security services, viz. integrity , authentication and confidentiality . A \nsolution is include SASL (Simple Authentication and Security Layer) for security when \nusing the XMPP protocol. \n\nLayers 5 and 6 Attacks Solution \n\nAbove layer 4, we are looking primarily at application-level attacks which are results of \npoor coding practices. Assume an attacker injects the SQL input to extract data from the \ndatabase (e.g. SELECT * from USERS). When the application fails to validate the injection, \nthe query extracts the data. \n\nWeb applications/services can use HTTPS communication link. The features of S-HTTP \n(Secure HTTP) are as follows: \n\n\u25cf Application-level security (HTTP specific) \n\n\u25cf Content privacy domain header \n\n\u25cf Allows use of digital signatures and encryption, various encryption options \n\n\u25cf Server-client negotiations \n\n\u25cf Cryptographic scheme is a property assigned for the link \n\n\u25cf Specific algorithm is the value assigned \n\n\u25cf Direction specification is done, one-way or two-way security \n\n14 http://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst6500/ios/12 and http://www.cisco.com/c/en/us/td/docs/2SX/ \nconfiguration/guide/book/vlans.html \n\nIoT Privacy, Security and Vulnerabilities Solutions \n411 \n\nCISCO suggested layered framework provisions for following solutions: \n\n\u25cf Layers 1\u20136: Role-based security \n\n\u25cf Layers 1\u20134 Anti-temper and detection-based security \n\n\u25cf Layers 1\u20136: Data protection and confidentiality \n\n\u25cf Layers 1\u20136: IP protection \n\nReconfirm Your Understanding \n\n\u25cf Monitoring of individual nodes is not fast acting and is also impractical. Network tomography helps \nin observing each network section (for example, a WSN nodes network between two access points) \nand subsections. \n\n\u25cf Security tomography enables finding the attack vulnerable sections/subsections on observations for \nbehaviours using a finite number of objects or threats in a complex set of subsystems. \n\n\u25cf Data between the things and application/service communicate through six layers and their sublayers. \nLayered attacker model shows the vulnerabilities at each layer, so that necessary solutions can be \ngiven for each layer attack. For example, using a temper resistant router, packet filtering and \ncontrolling routing messages and packets data between layers 3 and 4 through a Firewall reduce the \nrisks. \n\n\u25cf S-HTTP (Secure HTTP) enables secure communication between the client and server sockets. \n\nS elf-Assessment E xercise \n\n1. Why does security tomography enable fast detection in case of complex set of \n\nsubsystems or networks? \n2. List the physical cum data-link layer attacks in layered attack model. \n3. What are transport layer attacks in layered attack model? \n4. How do the port scanning and DTLS features enable mitigation of the attacks \n\nat layer 4. \n5. List and explain the features of HTTPS. \n6. What are the meanings of ARP inspection and disabling unused ports and \n\nhow are they used for layer 2 attack mitigation? \n\n\u2605 \n\n\u2605 \n\u2605 \n\u2605\u2605\u2605 \n\n\u2605\u2605 \n\u2605\u2605\u2605 \n\n\n![Image](/src/assets/generated_images/iot2_p438_i0.png)\n412 \nInternet of Things: Architecture and Design Principles \n\n10.5  IDENTITY MANAGEMENT, AND \n\nESTABLISHMENT, ACCESS CONTROL \nAND SECURE MESSAGE \nCOMMUNICATION \n\nSource of message needs to specify an identity (ID) when \nsending the messages. The receiver can thus know that from \nwhere the messages have been received. Number of ways \nexist for specifying identity (ID). The messages can be from \nseveral sensors, actuators and platforms and those may be \nfor several applications and services. Id management and \nestablishment for IoT are therefore basic requirements. \n\nA MAC address can specify identity of a computing device platform. However, the \nplatform may connect several sensors and actuators. An application layer may consist of \nnumber of applications and services. An URI (Universal Resource Identifier) can be used \non the Internet. Many devices however do not use the URI. An Object Identifier (OID) in \nIoT can have the following identifiers: \n\n\u25cf Types of things (for example, streetlight, vehicle, ATM, WSN, RFID) \n\n\u25cf Class identifier, since it refers to a class (or type, or category) of things; for example, \nmake and model \n\n\u25cf Instance identifier; for example, VIN (Vehicle identity number) for vehicles \nSubsection 10.5.1 describes identity management and identity establishment \nmechanisms. Subsection 10.5.2 describes access control mechanisms. Message integrity, \nnon-repudiation and availability are important requirements for security and privacy. \nSubsections 10.5.3 to 10.5.5 describe these. \n\n10.5.1 \nIdentity Management and Establishment \n\nIdentity Management (IDM) for the devices, applications and services is an FC of security \nFG. IdM means managing different identities, pseudo-names, hierarchies of group IDs \nas well as IDs for message senders and receivers. The FC anonymously manages the IDs. \nExample 10.5 gives four examples of uses of IDM functions. \n\nExample 10.5 \n\nProblem \nGive examples of usages identity management for establishing identities of device and application/services. \n\nSolution \n\nIETF transport layer does the device IDM and identity registry functions. \n\nOracle\u2019s IoT architecture (Figure 1.5) provisions for device IDM functions at the manage sublayer between \nstream and acquire layers. \n\nExamine functions \nfor source identity- \nmanagement, identity- \n\nestablishment, device \n\nmessages access- \n\ncontrol, message- \nintegrity, messages \nnon-repudiation and \n\navailability in IoT \n\napplications and \n\nservices \n\nLO 10.4 \n\nIoT Privacy, Security and Vulnerabilities Solutions \n413 \n\nOMA-DM model suggests use of a DM server. One of the functions of a DM server is assigning the device ID \nor address, and activating, configuring (managing device parameters and settings), subscribing to device \nservices, opting out of the device services, and configuring the device modes (Section 2.4.2). \nReader uses an RFID identity manager when reading from the RFIDs. EPCglobal architecture framework is \nused for assignment of a unique identity for business processes, applications and services, and uniquely \nidentify the physical objects, loads, locations, assets and other entities. ONS performs the lookup functions \nbased upon the DNS. DNS name enables web server Internet connectivity using HTTP, REST, WebSockets and \nInternet protocols (Section 7.6.2). \nNIST suggests the specifications for cyber-physical systems and for the asset identification specifications, \nand common platform enumeration specifications for naming, name matching, dictionary and applicability \nlanguage. \nITU-T X.660 suggests the procedures for the operation of object identifier registration authorities: General \nprocedures and top arcs of the international object identifier tree. ITU-T X.672 suggests an OID (object \nidentifier) resolution system. ITU-T OID Flyer suggests object identifiers and their registration authorities: \nyour solution to identification. \n\nCommunication between the device and application/services is after each one \nestablishes the identity of the other securely, using authentication and authorisation and \nother functions. \n\n10.5.2 Access Control \n\nThree FCs in a security FG for ensuring security and privacy are: \n\n\u25cf Authentications \n\n\u25cf Authorisation \n\n\u25cf Key exchange and management \n\nAuthentication \n\nID establishment and authentication are essential elements of access control. A hash \nfunction or MD5 gives the irreversible result after many operations on that and the \noperations are just one way. The algorithm generates a fixed size, say, 128 or 256-bit hash \nor digest value using authentication data and secret key. Only the hash or digest value \ncommunicates. The receiver-end receives the value, and compares that with a stored \nvalue. If both are equal then the sender is authenticated. \n\nHash function characteristic features are pre-image resistance, hash function should \nnot alter, before or after communication and should be as per the previous image (original \nmessage), second pre-image resistance: hash function should not be altered by an in- \nbetween entity (called eavesdropper), should remain the same as one for the previous \nimage (original message) should be collision-resistance and should not be the same for \nany form of altered message. \n\nAuthorisation \n\nAccess control allows only an authorised device or application/service access to a resource, \nsuch as web API input, IoT device, sensor or actuator data or URL. Authorisation model \n\n414 \nInternet of Things: Architecture and Design Principles \n\nis an essential element of secure access control. The standard authorisation models are as \nfollows: \n\n\u25cf Access Control List (ACL) for coarse-grain access control \n\n\u25cf Role-Based Access Control (RBAC) for fine-grain access control \n\n\u25cf Attribute-Based Access Control (ABAC) or other capability-based fine grain access \ncontrol \nAn access control server and data communication gateway can be centrally used to control \naccesses between application/service and IoT devices. The server central control can be on \na cloud server. Each device can access the server and communicate data to another server. \n\nAlternatively, a distributed architecture enables: \n\n\u25cf Each device to request access to the server and the server grants application/service \naccess token \n\n\u25cf Each application/service to request access to the server and the server grants device \naccess token for the device. \n\nKey Exchange and Management \n\nKey of sender messages needs to be known to receiver for accessing the received data. \nKey of respondent of messages needs to be known to sender for accessing the responses. \nThe keys, therefore, need to be exchanged before the communication of authentication \ncode, authorisation commands and encrypted messages. Since each application/service \ncomponent and device data application or service may need unique and distinct keys, an \nFC provisions for the functions of key management and exchanges. Example 10.6 gives \nthe steps for key exchanges and encryption and decryption. \n\nExample 10.6 \n\nProblem \nShow and list the steps for the key generation and exchange for authentication and authorisations followed \nby secure communication of an application/service message to the device/gateway. \n\nSolution \n\nFigure 10.5 shows the steps of using FCs. The steps are for key exchanges and management, authentication \nand authorisations. The steps follow secure communication of an application or service message to the \ngateway and device. \nSteps for designing use case for key exchanges and encrypting and decrypting the messages are: \n\n1. 1 and 2: Device/gateway D generates secret key K \n2. 3 and 4: Application/service A generates secret key K \n3. 5 and 6: D exchanges key K and K\u2019 \n4. 7 and 8: Authentication and authorisation of D and A , \n5. 9: Message given to encryption algorithm \n6. 10: Encrypted message using K\u2019 to D \n7. 11: Decryption algorithm decrypts encrypted message using K\u2019 for D \n8. 12: Message M retrieves at D \n\nIoT Privacy, Security and Vulnerabilities Solutions \n415 \n\n9. 13: Status code sends \u2018Error\u2019 or \u2018OK\u2019. As per the status of data exchanges for authentication, \n\nauthorisations and message communication. \n\nSimilarly, message encrypts at D using K and decrypts at A using K . \n\n10.5.3 Message-Integrity \n\nAn important aspect of system design is message integrity (data integrity), which means \nthe message remains unaltered. A message should not be altered during its communication. \nThe encrypted data after decrypting should be identical to one before encryption. \n\nMessage integrity check involves the following steps: \n\n\u25cf Hash function or digest algorithm calculates 128 or 192 or 256 Hash value h 0 , taking \nthe message M 0 and K as inputs \n\n\u25cf Appends the h 0 along with the message \n\n\u25cf Communicate or store h 0 \n\nIntegrity Check \n\nIntegrity check steps are as follows: \n\n1. Retrieve M any time later. Assume that retrieved message is M 1 . \n2. Calculate 128 or 192 or 256 Hash value h 1 , taking the message M 1 and K as inputs. \n3. Compare h 1 and h 0 . \n4. Message is unchanged if h 1 = h 0 , and integrity check passes else fails. \n\nMessage or data integrity means maintaining and assuring the accuracy and consistency \nover its entire lifecycle. \n\n1: Run \nFunction \nRandom \n(Security, \nParameter) \n\n2: Key \nGenerator \n\nFunction \n\n5: Key Exchange \nand Management \n\nFunctions \n\n4: Key \nGenerator \n\nFunction \n\n3: Run \nFunction \nRandom \n(Security, \nParameter) \n\nEncryption \nAlgorithm \n\nApplication/Service \n\n12: Message \n\n13: Status \n(Error or OK) \n\nS \n\nDevice/Gateway D \n\n11: Decryption \n\nAlgorithm \n\nDecypt \n( \n, \n) \nM K \u00a2 \n\n10: Encrypted Message encrypt ( K \u00a2 , M ) \n\n9: Message M \n\n9: Secret \nKey K \u00a2 \n\n5: Secret Key K \n\n7: Authentication \n\n8: Authorization \n\n6: Secret Key K \u00a2 \n\nFigure 10.5 Steps during key exchanges and management, authentication and authorisations followed \n\nby secure communication of application/service message to the device/gateway \n\n416 \nInternet of Things: Architecture and Design Principles \n\n10.5.4 Message Non-Repudiation \n\nNon-repudiation means an assurance that the source of a message once having \ncommunicated the data to a sender, cannot deny it later, that the message was not sent \nfrom the source and is not the same as sent earlier. It means data is signed and the \nsignature put at the source cannot be denied. Digital signature is a method which ensures \nnon-repudiation. \n\nThe service provides proof of the message\u2019s origin as well as its integrity. A digital \ncertificate asserts the origin using a public key infrastructure. A digital signature is certified \nby a trusted digital certifying service [trusted third party (TTP) service]. TTP protects the \nprivate (secret) key and issues the certificate that a message was sent using this specific \nprivate (secret) key of source incase the private key is lost and used by some other source \nof message. Only the TTP is permitted to be the repository for public key certificates. \n\nExample 10.7 gives the steps for signing, issue of digital certificates to a signed message \nand verification of a signed message. \n\nExample 10.7 \n\nProblem \nShow and list the steps for the use of TTP service and steps for signing, issue of digital certificates to a \nsigned message and verification of a signed message. \n\nSolution \n\nFigure 10.6 shows the use of TTP service and steps for signing, issue of digital certificates to a signed \nmessage and verification of a signed message. \n\n1: Run \nFunction \nRandom \n(Secutiry, \nParameter) \n\nPublic \nKey K, \nGenerator \nFunction \n\n6: TTP Service \nCertificate ( , \n) \nA K p \n\n7: Authenticate Message as \nreceived at \nof \nand sign \nB \nA \nA \n\nDigital \nCertificate for \nof \nMessage \nA \nM A \n\n9: Sign and \n\n(Verified \nYes or No) \nM A \n8. Test \nAlgorithm \n4: \nand sign ( \n, \n) \nM \nK \nM \nA \ns \nA \nAuthentication \n\nAlgorithm \n\n3: Message \n\nof \nM A \nA \n\n2: Sign Key K s \n\n5: Kp \nAuthenticate \nMessage as well \n\nas Sign \nA \n\nFigure 10.6 Use of TTP service and steps for signing, issue of digital certificates to a signed message \n\nand verification of signed message \n\nSteps for designing use cases are: \n\n\u25cf 1 and 2: End TTP and A generate keys K p and K s \n\n\u25cf 3 and 4: Message M A and sign generator function sign ( K s , M A ) executes and sent to End B \n\n\u25cf 5 and 6: K p to TTP Service and generation of certificate ( A , K p ) \n\nIoT Privacy, Security and Vulnerabilities Solutions \n417 \n\n\u25cf 7 and 8: Digital certificate and certificate of messages received at End B are verified and result sent to \ntest algorithm. \n\n\u25cf 9: Sign and M A verified to be same as received at B , Yes or No. \nSimilarly messages received at End B can be verified. \n\n10.5.5 Message-Availability \n\nMessage-availability affects when Denial-of-Service (DoS) attack occurs. This is because \nsource-end message (of device or network or application/service resource) is unavailable \nto the intended destination-end on DoS. Examples of DoS attacks are: \n\n\u25cf ICMP flooding which repeatedly sends control messages to the destination and thus \ndenies the path to source end \n\n\u25cf An SYN flood means the attacker sends a flood of TCP/SYN messages (packets) using \na forged address, and the destination repeatedly sends TCP/SYN packets assuming \nthe packet is from an actual source. The service to the source message becomes \nunavailable and the original message becomes unavailable at the destination \n\n\u25cf Peer-peer attack \n\n\u25cf Application layer messages flooding \nAn attack can be prevented using specific methods for specific type of attacks. Firewall is \none method for preventing attacks on messages from untrusted networks. \n\nReconfirm Your Understanding \n\n\u25cf MAC, URI or OID can be used as ID for the things, application or service. An OID includes types of \nthings, class identifier and instance identifier. \n\n\u25cf \u2018ID Management\u2019 is an FC of security FG. \n\n\u25cf Authentication, authorisation and key exchanges and management are also FCs of security FG. \n\n\u25cf ID establishment and authentication are essential elements of access control. A hash function or \nMD5 gives an irreversible result after many operations on that and the operations are just one way. \nHash algorithm calculates hash h 0 for authentication code using a secret key. h 0 value communicates \nto the other end. If data store hash value h 1 matches with communicated hash h 0 , then the sender \nstands authenticated. \n\n\u25cf An access control server and data communication gateway can be centrally used to control accesses \nbetween application/service and IoT devices. Authorisation functions authorise access for messages \nat one end from the other end. Authorisation models specify coarse-grain access control and fine- \ngrain access control. \n\n\u25cf Key of sender of messages needs to be known to the receiver for accessing the received data. \nKey of respondent of messages needs to be known to the sender for accessing the responses. The \nkeys, therefore, need to be exchanged before the authentication code, authorisation commands and \nencrypted messages communicate. \n\n\u25cf A requirement is message-integrity. Sending the hash along with the message enables the message- \nintegrity check. \n\n\n![Image](/src/assets/generated_images/iot2_p444_i0.png)\n418 \nInternet of Things: Architecture and Design Principles \n\n10.6 \nSECURITY MODELS, PROFILES AND \nPROTOCOLS FOR IoT \n\nAn IETF recommended draft recommends the following \nsecurity models for five security profiles. Table 10.1 gives the \ndetails. \n\nTable 10.1 \nSecurity model for differing security profiles \n\nSecurity Profile \nUsage \nDescription \nSecurity Model \n\nSecProf_0 \n6LowPAN/CoAP \nNo security \nNo temper resistant (no provision \nfor prevention of tempering) \n\nSecProf_1 \nHome Usage \nOperations between things \nwithout central device \n\n1. No temper resistant \n\n2. Sharing of keys between layers \n\nDescribe security \n\nmodel, security \nprofiles and security \n\nprotocols for IoT \n\nLO 10.5 \n\n\u25cf Non-repudiation assures that the source of a message once having communicated the data to a \nsender, cannot deny it later, that the message was not sent from the source and is not the same as \nsent earlier. Digital sign functions enable signed messages. A TTP service issues a digital certificate \nfor a message, and saves it in its repository. At any time a receiver can verify the signed message \nfrom the digital certificate of that message. \n\n\u25cf Message availability ensures prevention of DoS attacks, which can be due to a number of reasons, \nfor example TCP/SYN flooding. \n\nS elf-Assessment E xercise \n\n1. What are the methods of specifying an ID of an application/service or device \n\napplication? \n2. What does key management mean? \n3. List steps to authenticate two end-points communicating the messages. \n4. What do you mean by coarse-grain and fine-grain authorisations? \n5. Why is authentication not sufficient and authorisation needed for \n\ncommunicating messages? \n6. List the steps for message integrity check. \n7. Why are the ends exchange keys? \n8. What is the need of non-repudiation? \n9. Write the sources for DoS which affect message availability. \n10. List the functions of firewall in ensuring message availability. \n\n\u2605 \n\n\u2605\u2605 \n\n\u2605 \n\u2605\u2605\u2605 \n\u2605\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605 \n\u2605 \n\u2605\u2605 \n\n\u2605 \n\n( Contd. ) \n\nIoT Privacy, Security and Vulnerabilities Solutions \n419 \n\nSecProf_2 \nManaged Home \nUsage \n\nOperations between things \nand \nlocal \ndevice-central \ndevice interaction possible \n\n1. No temper resistant \n\n2. Sharing of keys between layers \n\nSecProf_3 \nIndustrial Usage \nOperations between things \nenabled and relies on local or \nback-end device for security \n\n1. Temper resistant \n2. Key and process separation \n\nSecProf_4 \nAdvanced \nIndustrial Usage \n\nAd-hoc operations between \nenabled things and relies on \ncentral device or a collection \nof control devices for \nsecurity. \n\nDistributed and centralised \n(local and/or back-end) \nsecurity architecture \n\n1. (No) temper resistant \n2. Sharing of keys between layers/ \n\nkey and process separation \nsandbox 15 \n\n15 \n\nSome applications target powerful devices aimed at more exposed applications and \nneed security parameters such as keying materials, and the certificates must be protected \nin the things. For example, by using tamper-resistant hardware. \n\nSharing of keys has the following features: \n\n\u25cf Needed across a networking stack of devices. \n\n\u25cf Provides authenticity and confidentiality in each networking layer, minimise \nthe number of key establishment/agreement handshake, needs less overhead for \nconstrained thing for example, applications with resource constraints (for example, \ntemperature and humidity sensor) \nKey separation at different networking layers: \n\n\u25cf Needed in advanced applications \n\n\u25cf May also possibly use process separation and sandboxing to isolate one application \nfrom another. \nCISCO IoT secure environment framework has four FCs: \n\n1. Authentication \n2. Authorisation \n3. Network-enforced policy \n4. Secure analytics: visibility and control \n\n10.6.1 Security Protocols \n\nOpen Trust Protocol (OTrP) is a protocol that manages security configuration in a \nTrusted Execution Environment (TEE) and is used for installing, updating and deleting \napplications and services. \n\n15 https://en.wikipedia.org/wiki/Sandbox_(software_development) [for usages of sandbox for software development] \n\n420 \nInternet of Things: Architecture and Design Principles \n\nFollowing DTLS and X.509 security protocol details can be referred from Section 3.2.1. \n\n\u25cf DTLS (Datagram Transport Layer Security) protocol is for maintaining the privacy \nduring the datagram which communicate when using the CoAP or L2M2M clients \nand servers. It enables protection from eavesdropping, tampering or message faking. \nThe basis of DTLS protocol is Transport Layer Security (TLS) protocol for data segment \ncommunication using the transport layer. \n\n\u25cf X.509 protocol refers to issue of a digital certificate with a trust based on TTP authorised \ncertification authority. It deploys a Public Key Infrastructure (PKI). The PKI manages \nthe digital certificates and public-key encryption. It is a subunit of TLS protocol used \nfor securing communication with the web. \n\nReconfirm Your Understanding \n\n\u25cf IETF draft recommends five security profiles and the security model for each profile. \n\n\u25cf Profiles 0, 1, and 2 are for 6LowPAN/CoAP use, home usages and managed home usage. \n\n\u25cf Profiles 0, 1, and 2 security profiles use no temper resistant, and sharing of keys based message \ncommunication. \n\n\u25cf Profiles 3 and 4 are industrial and advance industrial usages and these use temper-resistant, key and \nprocess separation or sandbox. \n\n\u25cf CISCO suggests a security framework based on authentication, authorisation, network enforced \npolicy and secure analytics: visibility and control. \n\nS elf-Assessment E xercise \n\n1. Why does 6LowPAN/CoAP communication need no temper resistance? \n2. Why do home usage with no central device or with central device \n\ncommunication need sharing of keys between layers and no provision for \nprevention of tempering? \n3. Why do industrial usage operations between things that enable and rely on \n\nlocal or back-end devices for security need sharing of keys between layers and \nkey and process separation? \n4. Why do ad-hoc operations between things that enable and rely on central \n\ndevice or a collection of control devices for security in the advanced industrial \nusages and using distributed and centralised (local and/or backend) security \narchitecture need no provision for prevention of tempering and sharing of \nkeys between layers/key and process separation sandbox. \n5. What are the features of key sharing? \n6. What are the four FCs in CISCO IoT secure environment framework? \n\n\u2605 \n\u2605 \n\n\u2605\u2605\u2605 \n\n\u2605\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605 \n\nIoT Privacy, Security and Vulnerabilities Solutions \n421 \n\nKey Concepts \n\n\u25cf Attack surface \n\n\u25cf Authentication \n\n\u25cf Authorisation \n\n\u25cf Decryption \n\n\u25cf Digest \n\n\u25cf Digital certificate \n\n\u25cf Encryption \n\n\u25cf Hash \n\n\u25cf Key exchanges \n\n\u25cf Key generator \n\n\u25cf Layered attack model \n\n\u25cf Layered attack solution \n\n\u25cf Link level security \n\n\u25cf Non-repudiation \n\n\u25cf Privacy \n\n\u25cf Secure hash algorithm \n\n\u25cf Security \n\n\u25cf Security model \n\n\u25cf Security tomography \n\n\u25cf Signed message \n\n\u25cf Threat analysis \n\n\u25cf Trust \n\n\u25cf Trusted party certificate \n\n\u25cf Vulnerability \n\nLearning Outcomes \n\nLO 10.1 \n\n\u25cf OWASP gives definitions of vulnerabilities and highlights top ten IoT vulnerabilities \n\n\u25cf Trust, security and privacy are required in IoT \n\n\u25cf Message-privacy need should ensure that messages do not reach unrelated entities and reach \nfrom the things to the desired applications/services only. \n\n\u25cf Security features incorporate in number of standards for IoT. \n\n\u25cf OWASP specifies the attack surface areas for vulnerabilities. \n\n\u25cf An IoT reference architecture specifies functional view. A functional view has security function \ngroup (FG). Five functional components (FCs) in the FG between the application/service and \ndevice are identity management (IDM), authentication, authorisation, key exchange and \nmanagement, trust and reputation. \n\n\u25cf A threat analysis tool can uncover flaws in any security design. \n\nLO 10.2 \n\n\u25cf UML notation use case diagrams are required for FCs of security FG. \n\n\u25cf Use cases analysis enables requirements analysis. Use cases are a key feature of many models \nand frameworks for developing the processes. \n\n\u25cf Examples of need of use cases are boot-process protection, secure software and firmware \nupdates, stored data encryption and integrity protection. Data store needs protection from \nhackers \n\n\u25cf Misuse cases define the required behaviour of components under development which should \nnot happen. This highlights the threats to enable designing new use cases for preventing \nattacks and find out what should not happen. \n\nLO 10.3 \n\n\u25cf Security tomography technique enables fast detection of attack-vulnerable sections/subsections \nin a complex set of networks such as network of WSNs. \n\n\u25cf Security tomography means finding attack-vulnerable sections/subsections by observations \nfor behaviours using a finite number of objects or threats in a complex set of subsystems. \n\n\u25cf Data between the things and application/service communicate through six layers and their \nsublayers. \n\n\u25cf Layered attacker model specifies the vulnerabilities at each layer. \n\n422 \nInternet of Things: Architecture and Design Principles \n\nLO 10.4 \n\n\u25cf A message communicates using the ID of the device platform/application/service. \n\n\u25cf An FC, \u2018ID Management\u2019 FC of security FG manages the IDs. \n\n\u25cf Authentication, authorisation, key exchanges and management are also FCs of the Security FG. \n\n\u25cf ID establishment and authentication are essential elements of access control. A hash function \nor MD5 enables authentication. \n\n\u25cf Access control server and data-communication gateway can be centrally used to control \naccesses between application/service and IoT devices. Authorisation functions authorise the \naccess for messages at one end from the other end. Authorisation models specify coarse-grain \naccess control and fine-grain access control. \n\n\u25cf The messages communicate using keys. Keys need to be exchanged before the authentication- \ncode, authorisation commands and encrypted messages communicate. \n\n\u25cf Hash algorithm enables message integrity checks. \n\n\u25cf Non-repudiation assures security when signed messages are used, and a digital certificate \nissuing TTP is used for digital certificates. \n\n\u25cf Message-availability ensures prevention of DoS attacks, which can be due to a number of \nreasons. \n\nLO 10.5 \n\n\u25cf IETF draft recommends five security profiles and a security model for each profile. \n\n\u25cf Profiles 0, 1, and 2 are for 6LowPAN/CoAP use, home usages and managed home usage and \nProfiles 3 and 4 are industrial and advance industrial usages and these use temper-resistant, \nkey and process separation/sandbox. \n\n\u25cf CISCO also suggests a security framework based on authentication, authorisation, network \nenforced policy and secure analytics: visibility and control \n\nExercises \n\nObjective Questions \n\nSelect one correct option out of the four in each question. \n\n1. Encryption is a (i) process of generating new data or (ii) new authentication code \n\nusing a secret key known only to a receiver (iii) Sender and receivers need not identify \neach other and know the keys that will be used by them. (iv) The encryption uses 32- \nbit, 64 bit, 128 bit, 192 bit or 256-bit key or MAC address for encrypting. \n(a) (i) \n(b) (ii) and (iv) \n\n(c) All \n(d) (i), (ii) and (iii) \n2. OWASP has identified top ten vulnerabilities in IoT applications/services \n\nas (i) secure web interface, (ii) insufficient authentication or authorisation, \n(iii) secure network services, (iv) lack of transport encryption/integrity verification, \n(v) privacy concerns, (vi) insecure cloud interface, (vii) insecure mobile interface, \n\n\u2605 \n\n\u2605\u2605 \n\nIoT Privacy, Security and Vulnerabilities Solutions \n423 \n\n(viii) insufficient security configurability, (ix) insecure software or firmware and \n(x) poor physical security. \n(a) All except (i) \n(b) All except (i) and (iii) \n\n(c) All except (ii) and (iv) \n(d) (ii) to (ix) \n3. Functional Components (FCs) of security are defined in IoT reference architecture \n\nand they are (i) identity management, (ii) authentications, (iii) authorisation, (iv) key \nexchange and management, (v) trust and reputation, (vi) physical device security, \nand (vii) security configurability. \n(a) (ii) to (v) \n(b) (ii) and (iii) \n\n(c) (i) to (v) \n(d) (ii) to (vii) \n4. OWASP definitions for cloud web interface attack surface area contains the following \n\nattacks: (i) SQL injection, (ii) cross-site scripting, (iii) cross-site request forgery, \n(iv) account lock out, (v) username enumeration, (v) weak passwords, and (vi) known \ndefault credentials, (vii) transport encryption, (viii) encrypted personally identifiable \ninformation (PII) sent unencrypted PII, (ix) sent device information leaked and \n(x) location leaked and (xi) cloud user data disclosure. \n(a) All \n(b) All except (vii) to (xi) \n\n(c) (v) to (xi) \n(d) (i) to (v) \n5. Microsoft Threat Analysis Tool 2014 analysis view shows the (i) threats which are \n\nactive and (ii) which are inactive. (iii) \u2018Data Store accessible\u2019 is a threat. The view also \nshows the (iv) process category, (v) stride category, (vi) \u2018spoofing\u2019 is a stride category, \nand (vii) \u2018denial of service\u2019 category threat. \n(a) All except (iii) and (ivi) \n(b) All except (iii) and (iv) \n\n(c) (ii) to (vii) \n(d) (i) to (vi) \n6. (i) Use cases use UML notation. (ii) Use cases analysis enables requirements analyses. \n\n(iii) Use cases are key feature of many models and frameworks for (iv) processes, and \n(v) API development. (v) Oracle Unified Method (OUM) and IBM Rational Unified \nProcess (RUM) are examples of software components and module development \nusing use case. \n(a) All are except (ii) \n(b) All except (ii) and (v) \n\n(c) All \n(d) All except (iii) and (v) true \n7. An object identifier (OID) in IoT can have the following identifiers: (i) URI, (ii) MAC \n\naddress, (iii) IP address, (iv) types of things, (v) class identifier, and (vi) instance \nidentifier. \n(a) All except (iv) \n(b) All except (ii) and (iii) \n\n\u2605 \n\n\u2605\u2605 \n\n\u2605\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605 \n\n424 \nInternet of Things: Architecture and Design Principles \n\n(c) All except (i) \n(d) (iv) to (vi) \n8. Trusted Third Party (TTP) service (i) certifies a digital signature, (ii) protects the \n\nprivate (secret) key and (iii) issues the certificate that message was sent using this \nspecific private (secret) key of source, (iv) shares key with all and (v) only one \npermitted to be the repository for public key certificate and keys. \n(a) All except (ii) and (iv) \n(b) All except (ii) and (v) \n\n(c) All except (iv) and (v) \n(d) (i) and (v) \n9. Access control allows only authorised (i) device or (ii) application/service access a \n\nresource, such as (iii) web API input, (iv) IoT device, (v) sensor or (vi) actuator data or \n(vii) URL. (viii) Authorisation model is an essential element of secure access control. \n(ix) Coarse-grain authorisation means web application access authorisation. \n(a) All except (i) \n(b) to (viii) \n\n(c) All except (viii) and (ix) \n(d) All except (vii) \n10. Layer 2 attack solutions are (i) network switches programmed to prevent internal \n\nnode attacks during use of (ii) DHCP, (iii) STP (Spanning Tree Protocol) or (iv) IP. \n(v) Additional controls may include ARP inspection, (vi) disabling unused ports and \n(vii) when using LWM2M client device gateway to the Internet, then have provisions \nfor MAS (M2M Authentication Server) for security, (viii) root key data store and \n(ix) devices and data authentication. \n(a) All except (iv) \n(b) All except (iv) and (viii) \n\n(c) All except (v) \n(d) All except (ii) and (v) true \n\nShort-Answer Questions \n\n1. What are the focuses of OWASP? \n[LO 10.1] \n2. Compare requirements of trust, privacy and security. \n[LO 10.1] \n3. What are the meanings and kinds of functional view, functional group and functional \n\ncomponent in IoT reference architecture? \n[LO 10.1] \n4. What does device management and device data integrity refer to? \n[LO 10.1] \n5. When and why is threat analysis performed? \n[LO 10.1] \n6. Why is management of keys important? \n[LO 10.2] \n7. When is security tomography useful? \n[LO 10.3] \n8. When is SQL injection a potential threat? \n[LO 10.3] \n9. What are the layer 1 attack solutions for wireless devices? \n[LO 10.3] \n10. How is the access of a web API controlled in a web service? \n[LO 10.4] \n11. When do you use authentication and authorisation? \n[LO 10.4] \n12. How does the layer attack model differ from the IETF recommended security model \n\nfor security profile requirements? \n[LO 10.5] \n13. When and why do we need to use OTrP for IoT applications and services? [LO 10.5] \n14. Why do we need TEE in IoT? \n[LO 10.5] \n\n\u2605\u2605 \n\n\u2605\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605 \n\u2605\u2605 \n\u2605\u2605\u2605 \n\n\u2605 \n\u2605\u2605 \n\u2605\u2605 \n\u2605\u2605\u2605 \n\n\u2605 \n\u2605\u2605 \n\u2605\u2605\u2605 \n\n\u2605 \n\u2605 \n\n\u2605\u2605\u2605 \n\n\u2605\u2605 \n\nIoT Privacy, Security and Vulnerabilities Solutions \n425 \n\n15. When do we use DTLS and when X.509?` \n[LO 10.5] \n\nReview Questions \n\n1. What are attack surface areas in DWI and CWI defined in OWASP? \n[ LO 10.1 ] \n2. How is the display view during threat analysis for a system when using Microsoft \n\nthreat modelling tool 2014? \n[ LO 10.1 ] \n3. What are the security requirements during message exchanges between devices to \n\napplications/services? \n[ LO 10.1 ] \n4. Why are misuse cases important for security threats? \n[ LO 10.2 ] \n5. How does the Misuse Cases help in secure design? \n[ LO 10.2 ] \n6. Draw a diagram showing possible attacks at the layers. Take OSI modified six-layer \n\nIoT model as reference. \n[LO 10.3] \n7. Describe the steps for verification of message and digital signature for non- \n\nrepudiation. \n[ LO 10.4 ] \n8. Show steps for message integrity check. \n[ LO 10.4 ] \n9. Describe access-authorisation methods. \n[ LO 10.4 ] \n10. What are the security model profiles and protocols for the IoT specified in the IETF \n\ndraft? \n[ LO 10.5 ] \n\nPractice Exercises \n\n1. Search https://www.owasp.org/index.php/OWASP_Internet_of_Things_Project for \n\nOWASP subprojects and list them. \n[LO 10.1] \n2. Search the reported results of CERT Coordination Centre (CERT/CC) at Carnegie \n\nMellon University initiative for coordination the vulnerabilities in IoT devices. \n\n[LO 10.1] \n3. Show use case diagram for streetlight sensors for ambient light, traffic density and \n\nstreetlight working status communication to a gateway. \n[LO 10.2] \n4. Tabulate the attacks in IoT applications/services at each layer. \n[LO 10.3] \n5. Tabulate the layer attack solutions for each layer. \n[LO 10.3] \n6. Draw and show the steps for sending encrypted data after authentication. [LO 10.4] \n7. Show the steps by diagrams for identity management. \n[LO 10.4] \n8. Redraw Figure 10.5 and show steps during key exchanges and management, \n\nauthentication and authorisations followed by secure communication of message \nfrom to the device/gateway to application/service. \n[LO 10.4] \n9. What do you mean by security model for industrial usages in IoT? \n[LO 10.5] \n\n\u2605 \n\n\u2605 \n\u2605\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605 \n\u2605 \n\n\u2605\u2605\u2605 \n\n\u2605\u2605 \n\u2605\u2605 \n\u2605\u2605\u2605 \n\n\u2605 \n\n\u2605\u2605\u2605 \n\n\u2605 \n\n\u2605 \n\u2605\u2605 \n\u2605\u2605 \n\u2605\u2605\u2605 \n\n\u2605\u2605 \n\n\u2605 \n\n",
  "createdAt": "2026-02-17"
}